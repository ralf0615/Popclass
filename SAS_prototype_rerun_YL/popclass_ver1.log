1                                        The WPS System   12:31 Wednesday, October 24, 2018     

NOTE: (c) Copyright World Programming Limited 2002-2018.  All rights reserved.
NOTE: World Programming System 4.00 (04.00.01.00.006515)
      Licensed to Truven Health Analytics, DR Licence for L13147
NOTE: This session is executing on the AIX platform and is running in 64 bit mode

NOTE: AUTOEXEC processing beginning; file is /opt/WPS/wps-4.0.1/autoexec.sas
NOTE: Library arch1990 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1990/

NOTE: Library arch1991 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1991/

NOTE: Library arch1992 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1992/

NOTE: Library arch1993 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1993/

NOTE: Library arch1994 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1994/

NOTE: Library arch1995 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1995/

NOTE: Library arch1996 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1996/

NOTE: Library arch1997 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1997/

NOTE: Library arch1998 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1998/

NOTE: Library arch1999 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1999/

NOTE: Library arch2000 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2000/

NOTE: Library arch2001 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2001/
2                                        The WPS System   12:31 Wednesday, October 24, 2018     


NOTE: Library arch2002 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2002/

NOTE: Library arch2003 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2003/

NOTE: Library arch2004 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2004/

NOTE: Library arch2005 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2005/

NOTE: Library arch2006 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2006/

NOTE: Library arch2007 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2007/

NOTE: Library arch2008 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2008/

NOTE: Library arch2009 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2009/

NOTE: Library arch2010 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2010/

NOTE: Library arch2011 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2011/

NOTE: Library arch2012 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2012/

NOTE: Library arch2013 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2013/

NOTE: Library arch2014 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2014/

3                                        The WPS System   12:31 Wednesday, October 24, 2018     

NOTE: Library arch2015 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2015/

NOTE: Library arch2016 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2016/

NOTE: Library arch2017 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2017/

NOTE: Library meg1996 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1996/meg/

NOTE: Library meg1997 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1997/meg/

NOTE: Library meg1998 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1998/meg/

NOTE: Library meg1999 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1999/meg/

NOTE: Library meg2000 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2000/meg/

NOTE: Library meg2001 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2001/meg/

NOTE: Library meg2002 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2002/meg/

NOTE: Library meg2003 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2003/meg/

NOTE: Library meg2004 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2004/meg/

NOTE: Library meg2005 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2005/meg/

NOTE: Library meg2006 assigned as follows:
4                                        The WPS System   12:31 Wednesday, October 24, 2018     

      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2006/meg/

NOTE: Library meg2007 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2007/meg/

NOTE: Library meg2008 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2008/meg/

NOTE: Library meg2009 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2009/meg/

NOTE: Library meg2010 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2010/meg/

NOTE: Library meg2011 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2011/meg/

NOTE: Library meg2012 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2012/meg/

NOTE: Library meg2013 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2013/meg/

NOTE: Library meg2014 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2014/meg/

NOTE: Library meg2015 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2015/meg/

NOTE: Library meg2016 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2016/meg/

NOTE: Library meg2017 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2017/meg/

NOTE: Library mdcd1999 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/1999/

NOTE: Library mdcd2000 assigned as follows:
      Engine:        SAS7BDAT
5                                        The WPS System   12:31 Wednesday, October 24, 2018     

      Physical Name: /mscan/data/medicaid/2000/

NOTE: Library mdcd2001 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2001/

NOTE: Library mdcd2002 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2002/

NOTE: Library mdcd2003 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2003/

NOTE: Library mdcd2004 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2004/

NOTE: Library mdcd2005 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2005/

NOTE: Library mdcd2006 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2006/

NOTE: Library mdcd2007 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2007/

NOTE: Library mdcd2008 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2008/

NOTE: Library mdcd2009 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2009/

NOTE: Library mdcd2010 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2010/

NOTE: Library mdcd2011 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2011/

NOTE: Library mdcd2012 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2012/

NOTE: Library mdcd2013 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2013/
6                                        The WPS System   12:31 Wednesday, October 24, 2018     


NOTE: Library mdcd2014 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2014/

NOTE: Library mdcd2015 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2015/

NOTE: Library mdcd2016 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2016/

NOTE: Library mdcd2017 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2017/

NOTE: Library eview assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/earlyview/

NOTE: Library eviewmon assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/earlyview_monthly/

NOTE: Library mslab assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/lab/

ERROR: An error occurred accessing location /msn1/data/marketscan_one/ : Access to file denied:
       /msn1/data/marketscan_one/
NOTE: Library msprov assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/marketscan_provider/

NOTE: Library redbook assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/redbook/

NOTE: Library bpd assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/bpd/

NOTE: Library loincdb assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/loincdb/

NOTE: Library library assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /hic/data/formats/

NOTE: Library mdcdfmt assigned as follows:
      Engine:        WPD
7                                        The WPS System   12:31 Wednesday, October 24, 2018     

      Physical Name: /mscan/data/medicaid/formats

NOTE: Library mdcdproc assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/procedures

NOTE: Library arch2014 assigned as follows:
      Engine:        WPD
      Physical Name: /mscan4/data/archive/2014/

NOTE: Library arch2015 assigned as follows:
      Engine:        WPD
      Physical Name: /mscan4/data/archive/2015/

NOTE: Library arch2016 assigned as follows:
      Engine:        WPD
      Physical Name: /mscan4/data/archive/2016/

NOTE: Library arch2017 assigned as follows:
      Engine:        WPD
      Physical Name: /mscan4/data/archive/2017/

NOTE: Library meg2014 assigned as follows:
      Engine:        WPD
      Physical Name: /mscan4/data/archive/2014/meg/

NOTE: Library meg2015 assigned as follows:
      Engine:        WPD
      Physical Name: /mscan4/data/archive/2015/meg/

NOTE: Library meg2016 assigned as follows:
      Engine:        WPD
      Physical Name: /mscan4/data/archive/2016/meg/

NOTE: Library meg2017 assigned as follows:
      Engine:        WPD
      Physical Name: /mscan4/data/archive/2017/meg/

NOTE: Library library assigned as follows:
      Engine:        WPD
      Physical Name: /hic/data/formats/wps

NOTE: AUTOEXEC processing completed

1         /*** connect to the nike server - trvlapp1465.tsh.thomson.com ***
2         rsubmit;
3         */
4         
5         %include '/opt/SAS94/SASFoundation/9.4/autoexec.sas';
NOTE: Library arch1990 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1990/

8                                        The WPS System   12:31 Wednesday, October 24, 2018     

NOTE: Library arch1991 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1991/

NOTE: Library arch1992 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1992/

NOTE: Library arch1993 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1993/

NOTE: Library arch1994 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1994/

NOTE: Library arch1995 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1995/

NOTE: Library arch1996 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1996/

NOTE: Library arch1997 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1997/

NOTE: Library arch1998 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1998/

NOTE: Library arch1999 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1999/

NOTE: Library arch2000 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2000/

NOTE: Library arch2001 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2001/

NOTE: Library arch2002 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2002/

NOTE: Library arch2003 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2003/

NOTE: Library arch2004 assigned as follows:
9                                        The WPS System   12:31 Wednesday, October 24, 2018     

      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2004/

NOTE: Library arch2005 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2005/

NOTE: Library arch2006 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2006/

NOTE: Library arch2007 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2007/

NOTE: Library arch2008 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2008/

NOTE: Library arch2009 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2009/

NOTE: Library arch2010 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2010/

NOTE: Library arch2011 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2011/

NOTE: Library arch2012 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2012/

NOTE: Library arch2013 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2013/

NOTE: Library arch2014 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2014/

NOTE: Library arch2015 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2015/

NOTE: Library arch2016 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2016/

NOTE: Library arch2017 assigned as follows:
      Engine:        SAS7BDAT
10                                       The WPS System   12:31 Wednesday, October 24, 2018     

      Physical Name: /mscan2/data/archive/2017/

NOTE: Library meg1996 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1996/meg/

NOTE: Library meg1997 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1997/meg/

NOTE: Library meg1998 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1998/meg/

NOTE: Library meg1999 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/1999/meg/

NOTE: Library meg2000 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2000/meg/

NOTE: Library meg2001 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2001/meg/

NOTE: Library meg2002 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2002/meg/

NOTE: Library meg2003 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2003/meg/

NOTE: Library meg2004 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2004/meg/

NOTE: Library meg2005 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2005/meg/

NOTE: Library meg2006 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2006/meg/

NOTE: Library meg2007 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2007/meg/

NOTE: Library meg2008 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2008/meg/
11                                       The WPS System   12:31 Wednesday, October 24, 2018     


NOTE: Library meg2009 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2009/meg/

NOTE: Library meg2010 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2010/meg/

NOTE: Library meg2011 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2011/meg/

NOTE: Library meg2012 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/2012/meg/

NOTE: Library meg2013 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2013/meg/

NOTE: Library meg2014 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2014/meg/

NOTE: Library meg2015 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2015/meg/

NOTE: Library meg2016 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2016/meg/

NOTE: Library meg2017 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/archive/2017/meg/

NOTE: Library mdcd1999 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/1999/

NOTE: Library mdcd2000 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2000/

NOTE: Library mdcd2001 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2001/

NOTE: Library mdcd2002 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2002/

12                                       The WPS System   12:31 Wednesday, October 24, 2018     

NOTE: Library mdcd2003 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2003/

NOTE: Library mdcd2004 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2004/

NOTE: Library mdcd2005 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2005/

NOTE: Library mdcd2006 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2006/

NOTE: Library mdcd2007 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2007/

NOTE: Library mdcd2008 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2008/

NOTE: Library mdcd2009 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2009/

NOTE: Library mdcd2010 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2010/

NOTE: Library mdcd2011 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2011/

NOTE: Library mdcd2012 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2012/

NOTE: Library mdcd2013 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2013/

NOTE: Library mdcd2014 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2014/

NOTE: Library mdcd2015 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2015/

NOTE: Library mdcd2016 assigned as follows:
13                                       The WPS System   12:31 Wednesday, October 24, 2018     

      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2016/

NOTE: Library mdcd2017 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/2017/

NOTE: Library eview assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/earlyview/

NOTE: Library eviewmon assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan2/data/earlyview_monthly/

NOTE: Library mslab assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/lab/

ERROR: An error occurred accessing location /msn1/data/marketscan_one/ : Access to file denied:
       /msn1/data/marketscan_one/
NOTE: Library msprov assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/marketscan_provider/

NOTE: Library redbook assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/redbook/

NOTE: Library bpd assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/archive/bpd/

NOTE: Library loincdb assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/loincdb/

NOTE: Library library assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /hic/data/formats/

NOTE: Library mdcdfmt assigned as follows:
      Engine:        WPD
      Physical Name: /mscan/data/medicaid/formats

NOTE: Library mdcdproc assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /mscan/data/medicaid/procedures

391       
392       Options obs=max mprint;
393       
394       *** Modified ;
14                                       The WPS System   12:31 Wednesday, October 24, 2018     

395       %Let StartDate='31DEC2015'd; /* always choose the end of month */
396       
397       *** Modified ;
398       %let version=31DEC2015MarketScanSample;
399       
400       *** Modified ;
401       %Let AEoutpath=/rpscan/u071366/POPSTRATIFICATION/AEout/&version.;
402       %Let outpath=/rpscan/u071366/POPSTRATIFICATION/output/&version.;
403       %Let username=u071366;
404       
405       *** Modified ;
406       x "mkdir -p /rpscan/u071366/POPSTRATIFICATION/temp/&version.";
407       x "mkdir -p /rpscan/u071366/POPSTRATIFICATION/AEout/&version.";
408       x "mkdir -p /rpscan/u071366/POPSTRATIFICATION/output/&version.";
409       
410       *** Modified ;
NOTE: Directory contains files of mixed engine types
411       libname temp "/rpscan/u071366/POPSTRATIFICATION/temp/&version.";
NOTE: Library temp assigned as follows:
      Engine:        WPD
      Physical Name: /rpscan/u071366/POPSTRATIFICATION/temp/31DEC2015MarketScanSample

412       
413       *** Modified ;
414       PROC IMPORT
415       	DATAFILE="/rpscan/u071366/enrolids_2000.csv"
416       	OUT= enrolids
417       	DBMS=CSV
418       	REPLACE;
419       GETNAMES=YES;
420       GUESSINGROWS=MAX;
421       RUN;
NOTE: Procedure IMPORT step took :
      real time : 0.076
      cpu time  : 0.002


422       data  enrolids;
423         infile '/rpscan/u071366/enrolids_2000.csv' delimiter=',' MISSOVER DSD firstobs=2 LRE
423     ! CL=32760;
424         informat 'ENROLID'n BEST32.;
425         format 'ENROLID'n BEST12.;
426         label 'ENROLID'n = 'ENROLID';
427         input    'ENROLID'n
428         ;
429         run;

NOTE: The file '/rpscan/u071366/enrolids_2000.csv' is:
      File Name=/rpscan/u071366/enrolids_2000.csv,
      Access Permissions=-rw-r-----, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=23011, Last Modified=08:19:13 Oct 18 2018,
      Created=08:19:13 Oct 18 2018, Lrecl=32760, Recfm=V
15                                       The WPS System   12:31 Wednesday, October 24, 2018     


NOTE: 2000 records were read from file '/rpscan/u071366/enrolids_2000.csv'
      The minimum record length was 8
      The maximum record length was 10
NOTE: Data set "WORK.enrolids" has 2000 observation(s) and 1 variable(s)
NOTE: The data step took :
      real time : 0.052
      cpu time  : 0.005


430       FILENAME ##IMPORT CLEAR;
431       
432       *** Modified ;
433       data  ccaea;
434           infile '/rpscan/u071366/fedex_data_2015/ccaea.csv' delimiter=',' MISSOVER DSD firs
434     ! tobs=2 LRECL=32760;
435       
436           informat 'ENROLID'n BEST32.;
437       	informat 'AGE'n BEST32.;
438       	informat 'SEX'n $1.;
439       	informat 'MSA'n BEST32.;
440       	informat 'RX'n $1.;
441       	informat 'ENRIND1'n BEST32.;
442       	informat 'ENRIND2'n BEST32.;
443       	informat 'ENRIND3'n BEST32.;
444       	informat 'ENRIND4'n BEST32.;
445       	informat 'ENRIND5'n BEST32.;
446       	informat 'ENRIND6'n BEST32.;
447       	informat 'ENRIND7'n BEST32.;
448       	informat 'ENRIND8'n BEST32.;
449       	informat 'ENRIND9'n BEST32.;
450       	informat 'ENRIND10'n BEST32.;
451       	informat 'ENRIND11'n BEST32.;
452       	informat 'ENRIND12'n BEST32.;
453       	informat 'PLNTYP1'n BEST32.;
454       	informat 'PLNTYP2'n BEST32.;
455       	informat 'PLNTYP3'n BEST32.;
456       	informat 'PLNTYP4'n BEST32.;
457       	informat 'PLNTYP5'n BEST32.;
458       	informat 'PLNTYP6'n BEST32.;
459       	informat 'PLNTYP7'n BEST32.;
460       	informat 'PLNTYP8'n BEST32.;
461       	informat 'PLNTYP9'n BEST32.;
462       	informat 'PLNTYP10'n BEST32.;
463       	informat 'PLNTYP11'n BEST32.;
464       	informat 'PLNTYP12'n BEST32.;
465       	format 'ENROLID'n BEST12.;
466       	format 'AGE'n BEST12.;
467       	format 'SEX'n $1.;
468       	format 'MSA'n BEST12.;
469       	format 'RX'n $1.;
470       	format 'ENRIND1'n BEST12.;
471       	format 'ENRIND2'n BEST12.;
16                                       The WPS System   12:31 Wednesday, October 24, 2018     

472       	format 'ENRIND3'n BEST12.;
473       	format 'ENRIND4'n BEST12.;
474       	format 'ENRIND5'n BEST12.;
475       	format 'ENRIND6'n BEST12.;
476       	format 'ENRIND7'n BEST12.;
477       	format 'ENRIND8'n BEST12.;
478       	format 'ENRIND9'n BEST12.;
479       	format 'ENRIND10'n BEST12.;
480       	format 'ENRIND11'n BEST12.;
481       	format 'ENRIND12'n BEST12.;
482       	format 'PLNTYP1'n BEST12.;
483       	format 'PLNTYP2'n BEST12.;
484       	format 'PLNTYP3'n BEST12.;
485       	format 'PLNTYP4'n BEST12.;
486       	format 'PLNTYP5'n BEST12.;
487       	format 'PLNTYP6'n BEST12.;
488       	format 'PLNTYP7'n BEST12.;
489       	format 'PLNTYP8'n BEST12.;
490       	format 'PLNTYP9'n BEST12.;
491       	format 'PLNTYP10'n BEST12.;
492       	format 'PLNTYP11'n BEST12.;
493       	format 'PLNTYP12'n BEST12.;
494       	label 'ENROLID'n = 'ENROLID';
495       	label 'AGE'n = 'AGE';
496       	label 'SEX'n = 'SEX';
497       	label 'MSA'n = 'MSA';
498       	label 'RX'n = 'RX';
499       	label 'ENRIND1'n = 'ENRIND1';
500       	label 'ENRIND2'n = 'ENRIND2';
501       	label 'ENRIND3'n = 'ENRIND3';
502       	label 'ENRIND4'n = 'ENRIND4';
503       	label 'ENRIND5'n = 'ENRIND5';
504       	label 'ENRIND6'n = 'ENRIND6';
505       	label 'ENRIND7'n = 'ENRIND7';
506       	label 'ENRIND8'n = 'ENRIND8';
507       	label 'ENRIND9'n = 'ENRIND9';
508       	label 'ENRIND10'n = 'ENRIND10';
509       	label 'ENRIND11'n = 'ENRIND11';
510       	label 'ENRIND12'n = 'ENRIND12';
511       	label 'PLNTYP1'n = 'PLNTYP1';
512       	label 'PLNTYP2'n = 'PLNTYP2';
513       	label 'PLNTYP3'n = 'PLNTYP3';
514       	label 'PLNTYP4'n = 'PLNTYP4';
515       	label 'PLNTYP5'n = 'PLNTYP5';
516       	label 'PLNTYP6'n = 'PLNTYP6';
517       	label 'PLNTYP7'n = 'PLNTYP7';
518       	label 'PLNTYP8'n = 'PLNTYP8';
519       	label 'PLNTYP9'n = 'PLNTYP9';
520       	label 'PLNTYP10'n = 'PLNTYP10';
521       	label 'PLNTYP11'n = 'PLNTYP11';
522       	label 'PLNTYP12'n = 'PLNTYP12';
523       	input    'ENROLID'n
524       		'AGE'n
17                                       The WPS System   12:31 Wednesday, October 24, 2018     

525       		'SEX'n $
526       		'MSA'n
527       		'RX'n $
528       		'ENRIND1'n
529       		'ENRIND2'n
530       		'ENRIND3'n
531       		'ENRIND4'n
532       		'ENRIND5'n
533       		'ENRIND6'n
534       		'ENRIND7'n
535       		'ENRIND8'n
536       		'ENRIND9'n
537       		'ENRIND10'n
538       		'ENRIND11'n
539       		'ENRIND12'n
540       		'PLNTYP1'n
541       		'PLNTYP2'n
542       		'PLNTYP3'n
543       		'PLNTYP4'n
544       		'PLNTYP5'n
545       		'PLNTYP6'n
546       		'PLNTYP7'n
547       		'PLNTYP8'n
548       		'PLNTYP9'n
549       		'PLNTYP10'n
550       		'PLNTYP11'n
551       		'PLNTYP12'n
552       		;
553       
554       run;

NOTE: The file '/rpscan/u071366/fedex_data_2015/ccaea.csv' is:
      File Name=/rpscan/u071366/fedex_data_2015/ccaea.csv,
      Access Permissions=-rwxr-xr--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=7035526, Last Modified=12:54:53 Oct 18 2018,
      Created=15:45:34 Oct 23 2018, Lrecl=32760, Recfm=V

NOTE: 100403 records were read from file '/rpscan/u071366/fedex_data_2015/ccaea.csv'
      The minimum record length was 54
      The maximum record length was 71
NOTE: Data set "WORK.ccaea" has 100403 observation(s) and 29 variable(s)
NOTE: The data step took :
      real time : 1.308
      cpu time  : 0.696


555       
556       *** Modified ;
557       data  ccaei;
558           infile '/rpscan/u071366/fedex_data_2015/ccaei.csv' delimiter=',' MISSOVER DSD firs
558     ! tobs=2 LRECL=32760;
559       
18                                       The WPS System   12:31 Wednesday, October 24, 2018     

560           informat 'ENROLID'n BEST32.;
561           informat 'PDXCAT'n $5.;
562           informat 'ADMDATE'n MMDDYY10.;
563           informat 'DISDATE'n MMDDYY10.;
564           informat 'DRG'n BEST32.;
565           informat 'ADMTYP'n $1.;
566           informat 'TOTPAY'n BEST32.;
567           informat 'DSTATUS'n $2.;
568           format 'ENROLID'n BEST12.;
569           format 'PDXCAT'n $5.;
570           format 'ADMDATE'n MMDDYY10.;
571           format 'DISDATE'n MMDDYY10.;
572           format 'DRG'n BEST12.;
573           format 'ADMTYP'n $1.;
574           format 'TOTPAY'n BEST12.;
575           format 'DSTATUS'n $2.;
576           label 'ENROLID'n = 'ENROLID';
577           label 'PDXCAT'n = 'PDXCAT';
578           label 'ADMDATE'n = 'ADMDATE';
579           label 'DISDATE'n = 'DISDATE';
580           label 'DRG'n = 'DRG';
581           label 'ADMTYP'n = 'ADMTYP';
582           label 'TOTPAY'n = 'TOTPAY';
583           label 'DSTATUS'n = 'DSTATUS';
584           input    'ENROLID'n
585               'PDXCAT'n $
586               'ADMDATE'n
587               'DISDATE'n
588               'DRG'n
589               'ADMTYP'n $
590               'TOTPAY'n
591               'DSTATUS'n $
592               ;
593       run;

NOTE: The file '/rpscan/u071366/fedex_data_2015/ccaei.csv' is:
      File Name=/rpscan/u071366/fedex_data_2015/ccaei.csv,
      Access Permissions=-rwxr-xr--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=228947, Last Modified=12:54:20 Oct 18 2018,
      Created=15:45:33 Oct 23 2018, Lrecl=32760, Recfm=V

NOTE: 4114 records were read from file '/rpscan/u071366/fedex_data_2015/ccaei.csv'
      The minimum record length was 48
      The maximum record length was 60
NOTE: Data set "WORK.ccaei" has 4114 observation(s) and 8 variable(s)
NOTE: The data step took :
      real time : 0.081
      cpu time  : 0.014


594       
595       *** Modified ;
19                                       The WPS System   12:31 Wednesday, October 24, 2018     

596       data  ccaed;
597           infile '/rpscan/u071366/fedex_data_2015/ccaed.csv' delimiter=',' MISSOVER DSD firs
597     ! tobs=2 LRECL=32760;
598       	informat 'ENROLID'n BEST32.;
599       	informat 'SVCDATE'n MMDDYY10.;
600       	informat 'DAYSUPP'n BEST32.;
601       	informat 'NDCNUM'n $11.;
602       	informat 'GENERID'n BEST32.;
603       	informat 'THERCLS'n BEST32.;
604       	informat 'PAY'n BEST32.;
605       	format 'ENROLID'n BEST12.;
606       	format 'SVCDATE'n MMDDYY10.;
607       	format 'DAYSUPP'n BEST12.;
608       	format 'NDCNUM'n $11.;
609       	format 'GENERID'n BEST12.;
610       	format 'THERCLS'n BEST12.;
611       	format 'PAY'n BEST12.;
612       	label 'ENROLID'n = 'ENROLID';
613       	label 'SVCDATE'n = 'SVCDATE';
614       	label 'DAYSUPP'n = 'DAYSUPP';
615       	label 'NDCNUM'n = 'NDCNUM';
616       	label 'GENERID'n = 'GENERID';
617       	label 'THERCLS'n = 'THERCLS';
618       	label 'PAY'n = 'PAY';
619       	input    'ENROLID'n
620       	'SVCDATE'n
621       	'DAYSUPP'n
622       	'NDCNUM'n $
623       	'GENERID'n
624       	'THERCLS'n
625       	'PAY'n
626       	;
627       run;

NOTE: The file '/rpscan/u071366/fedex_data_2015/ccaed.csv' is:
      File Name=/rpscan/u071366/fedex_data_2015/ccaed.csv,
      Access Permissions=-rwxr-xr--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=51849924, Last Modified=12:54:48 Oct 18 2018,
      Created=15:45:34 Oct 23 2018, Lrecl=32760, Recfm=V

NOTE: 883084 records were read from file '/rpscan/u071366/fedex_data_2015/ccaed.csv'
      The minimum record length was 38
      The maximum record length was 61
NOTE: Data set "WORK.ccaed" has 883084 observation(s) and 7 variable(s)
NOTE: The data step took :
      real time : 5.142
      cpu time  : 2.646


628       
629       *** Modified ;
630       data  ccaes;
20                                       The WPS System   12:31 Wednesday, October 24, 2018     

631           infile '/rpscan/u071366/fedex_data_2015/ccaes.csv' delimiter=',' MISSOVER DSD firs
631     ! tobs=2 LRECL=32760;
632       	informat 'ENROLID'n BEST32.;
633       	informat 'SEQNUM'n BEST32.;
634       	informat 'AGE'n BEST32.;
635       	informat 'SEX'n $1.;
636       	informat 'PROC1'n $7.;
637       	informat 'DXVER'n $1.;
638       	informat 'DX1'n $7.;
639       	informat 'DX2'n $7.;
640       	informat 'DX3'n $7.;
641       	informat 'DX4'n $7.;
642       	informat 'ADMTYP'n $1.;
643       	informat 'SVCSCAT'n $5.;
644       	informat 'SVCDATE'n MMDDYY10.;
645       	format 'ENROLID'n BEST12.;
646       	format 'SEQNUM'n BEST12.;
647       	format 'AGE'n BEST12.;
648       	format 'SEX'n $1.;
649       	format 'PROC1'n $7.;
650       	format 'DXVER'n $1.;
651       	format 'DX1'n $7.;
652       	format 'DX2'n $7.;
653       	format 'DX3'n $7.;
654       	format 'DX4'n $7.;
655       	format 'ADMTYP'n $1.;
656       	format 'SVCSCAT'n $5.;
657       	format 'SVCDATE'n MMDDYY10.;
658       	label 'ENROLID'n = 'ENROLID';
659       	label 'SEQNUM'n = 'SEQNUM';
660       	label 'AGE'n = 'AGE';
661       	label 'SEX'n = 'SEX';
662       	label 'PROC1'n = 'PROC1';
663       	label 'DXVER'n = 'DXVER';
664       	label 'DX1'n = 'DX1';
665       	label 'DX2'n = 'DX2';
666       	label 'DX3'n = 'DX3';
667       	label 'DX4'n = 'DX4';
668       	label 'ADMTYP'n = $1.;
669       	label 'SVCSCAT'n = $5.;
670       	label 'SVCDATE'n = 'SVCDATE';
671       	input    'ENROLID'n
672       		'SEQNUM'n
673       		'AGE'n
674       		'SEX'n $
675       		'PROC1'n $
676       		'DXVER'n
677       		'DX1'n $
678       		'DX2'n $
679       		'DX3'n $
680       		'DX4'n $
681       		'ADMTYP'n $
682       		'SVCSCAT'n $
21                                       The WPS System   12:31 Wednesday, October 24, 2018     

683       		'SVCDATE'n
684       		;
685       run;

NOTE: The file '/rpscan/u071366/fedex_data_2015/ccaes.csv' is:
      File Name=/rpscan/u071366/fedex_data_2015/ccaes.csv,
      Access Permissions=-rwxr-xr--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=8426115, Last Modified=12:54:49 Oct 18 2018,
      Created=15:45:33 Oct 23 2018, Lrecl=32760, Recfm=V

NOTE: 130767 records were read from file '/rpscan/u071366/fedex_data_2015/ccaes.csv'
      The minimum record length was 50
      The maximum record length was 82
NOTE: Data set "WORK.ccaes" has 130767 observation(s) and 13 variable(s)
NOTE: The data step took :
      real time : 1.002
      cpu time  : 0.446


686       
687       *** Modified ;
688       data  ccaeo;
689           infile '/rpscan/u071366/fedex_data_2015/ccaeo.csv' delimiter=',' MISSOVER DSD firs
689     ! tobs=2 LRECL=32760;
690       	informat 'ENROLID'n BEST32.;
691       	informat 'FACPROF'n $1.;
692       	informat 'SEQNUM'n BEST32.;
693       	informat 'AGE'n BEST32.;
694       	informat 'SEX'n $1.;
695       	informat 'PROC1'n $7.;
696       	informat 'DX1'n $7.;
697       	informat 'DX2'n $7.;
698       	informat 'DX3'n $7.;
699       	informat 'DX4'n $7.;
700       	informat 'DXVER'n $1.;
701       	informat 'SVCSCAT'n $5.;
702       	informat 'SVCDATE'n MMDDYY10.;
703       	informat 'MSCLMID'n BEST32.;
704       	informat 'FACHDID'n BEST32.;
705       	informat 'PROCGRP'n BEST32.;
706       	informat 'DXCAT'n $5.;
707       	informat 'STDPROV'n BEST32.;
708       	informat 'PAY'n BEST32.;
709       	format 'ENROLID'n BEST12.;
710       	format 'FACPROF'n $1.;
711       	format 'SEQNUM'n BEST12.;
712       	format 'AGE'n BEST12.;
713       	format 'SEX'n $1.;
714       	format 'PROC1'n $7.;
715       	format 'DX1'n $7.;
716       	format 'DX2'n $7.;
717       	format 'DX3'n $7.;
22                                       The WPS System   12:31 Wednesday, October 24, 2018     

718       	format 'DX4'n $7.;
719       	format 'DXVER'n $1.;
720       	format 'SVCSCAT'n $5.;
721       	format 'SVCDATE'n MMDDYY10.;
722       	format 'MSCLMID'n BEST12.;
723       	format 'FACHDID'n BEST12.;
724       	format 'PROCGRP'n BEST12.;
725       	format 'DXCAT'n $5.;
726       	format 'STDPROV'n BEST12.;
727       	format 'PAY'n BEST12.;
728       	label 'ENROLID'n = 'ENROLID';
729       	label 'FACPROF'n = 'FACPROF';
730       	label 'SEQNUM'n = 'SEQNUM';
731       	label 'AGE'n = 'AGE';
732       	label 'SEX'n = 'SEX';
733       	label 'PROC1'n = 'PROC1';
734       	label 'DX1'n = 'DX1';
735       	label 'DX2'n = 'DX2';
736       	label 'DX3'n = 'DX3';
737       	label 'DX4'n = 'DX4';
738       	label 'DXVER'n = 'DXVER';
739       	label 'SVCSCAT'n = 'SVCSCAT';
740       	label 'SVCDATE'n = 'SVCDATE';
741       	label 'MSCLMID'n = 'MSCLMID';
742       	label 'FACHDID'n = 'FACHDID';
743       	label 'PROCGRP'n = 'PROCGRP';
744       	label 'DXCAT'n = 'DXCAT';
745       	label 'STDPROV'n = 'STDPROV';
746       	label 'PAY'n = 'PAY';
747       	input    'ENROLID'n
748       		'FACPROF'n $
749       		'SEQNUM'n
750       		'AGE'n
751       		'SEX'n $
752       		'PROC1'n $
753       		'DX1'n $
754       		'DX2'n $
755       		'DX3'n $
756       		'DX4'n $
757       		'DXVER'n $
758       		'SVCSCAT'n $
759       		'SVCDATE'n
760       		'MSCLMID'n
761       		'FACHDID'n
762       		'PROCGRP'n
763       		'DXCAT'n $
764       		'STDPROV'n
765       		'PAY'n
766       		;
767       run;

NOTE: The file '/rpscan/u071366/fedex_data_2015/ccaeo.csv' is:
      File Name=/rpscan/u071366/fedex_data_2015/ccaeo.csv,
23                                       The WPS System   12:31 Wednesday, October 24, 2018     

      Access Permissions=-rwxr-xr--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=180895404, Last Modified=12:54:42 Oct 18 2018,
      Created=15:45:33 Oct 23 2018, Lrecl=32760, Recfm=V

NOTE: 1837017 records were read from file '/rpscan/u071366/fedex_data_2015/ccaeo.csv'
      The minimum record length was 71
      The maximum record length was 126
NOTE: Data set "WORK.ccaeo" has 1837017 observation(s) and 19 variable(s)
NOTE: The data step took :
      real time : 19.072
      cpu time  : 9.565


768       
769       *** Modified ;
770       data  ccaef;
771           infile '/rpscan/u071366/fedex_data_2015/ccaef.csv' delimiter=',' MISSOVER DSD firs
771     ! tobs=2 LRECL=32760;
772       	informat 'ENROLID'n BEST32.;
773       	informat 'SVCDATE'n MMDDYY10.;
774       	informat 'TSVCDAT'n MMDDYY10.;
775       	informat 'DAYS'n BEST32.;
776       	informat 'FACHDID'n BEST32.;
777       	informat 'CASEID'n BEST32.;
778       	format 'ENROLID'n BEST12.;
779       	format 'SVCDATE'n MMDDYY10.;
780       	format 'TSVCDAT'n MMDDYY10.;
781       	format 'DAYS'n BEST12.;
782       	format 'FACHDID'n BEST12.;
783       	format 'CASEID'n BEST12.;
784       	label 'ENROLID'n = 'ENROLID';
785       	label 'SVCDATE'n = 'SVCDATE';
786       	label 'TSVCDAT'n = 'TSVCDAT';
787       	label 'DAYS'n = 'DAYS';
788       	label 'FACHDID'n = 'FACHDID';
789       	label 'CASEID'n = 'CASEID';
790       	input    'ENROLID'n
791       	'SVCDATE'n
792       	'TSVCDAT'n
793       	'DAYS'n
794       	'FACHDID'n
795       	'CASEID'n
796       	;
797       run;

NOTE: The file '/rpscan/u071366/fedex_data_2015/ccaef.csv' is:
      File Name=/rpscan/u071366/fedex_data_2015/ccaef.csv,
      Access Permissions=-rwxr-xr--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=20565531, Last Modified=12:54:51 Oct 18 2018,
      Created=15:45:33 Oct 23 2018, Lrecl=32760, Recfm=V

24                                       The WPS System   12:31 Wednesday, October 24, 2018     

NOTE: 463695 records were read from file '/rpscan/u071366/fedex_data_2015/ccaef.csv'
      The minimum record length was 41
      The maximum record length was 53
NOTE: Data set "WORK.ccaef" has 463695 observation(s) and 6 variable(s)
NOTE: The data step took :
      real time : 2.277
      cpu time  : 1.002


798       
799       
800       
801       *** Modified ;
802       %Let lastmonth=%sysfunc(month(&StartDate.),2.);
803       proc sql;
804       Create Table temp.SamplewClassification as select a.enrolid,
805       	' ' as AssignmentFinal
806       from ccaea a
807       inner join enrolids e  On e.enrolid = a.enrolid
808       where a.enrind&lastmonth.=1;
NOTE: Data set "TEMP.SamplewClassification" has 1798 observation(s) and 2 variable(s)
809       quit;
NOTE: Procedure sql step took :
      real time : 0.038
      cpu time  : 0.016


810       
811       
812       *** exclusions for what not is considered to be a specialist (Anne);
813       %Let SpecExclusionList=200,202,204,206,240,245,320,400;
814       *** exclusions for what counts as a visit based on SvcCat and Procedure (Amy);
815       %Let SvcCatExclusionList="30","32","37","38","51","52","53","54","55","56","59","61","
815     ! 62","63","64","65","66","67","68","69";
816       %Let ProcExclusionList="36415","G0001","36400","36405","36406","36410","36416";
817       *** CPT codes for Oxygen;
818       %let OxygenCPTList="E0431","E0434","E0439","E0441","E0442","E0443","E0444","E1390","E1
818     ! 392","K0738";
819       *** Therapeutic Intermediate Classes for Opiates;
820       %let OpiatesTCLS=60,61;
821       %let OpiatesGNID=108156,118478,124984,124986,124988,128184,128947,129199,129311,129314
821     ! ,129315,130023,131028,131029,131146,131486;
822       %let SvcCatMHSA='PSY02','PSY03','PSY80';
823       %let SvcCatGYN='GYN01','GYN02','GYN03','GYN06','GYN09','GYN10','GYN12','GYN27','GYN29'
823     ! ,'GYN30';
824       *** Rebalance;
825       %let ConditionDxCat='CVS11','CVS10';
826       %let ConditionDxCatStage=3;
827       %let ConditionDxCatER='PSY';
828       %let ConditionDRG='280','281','282','283','284','285','239','241','474','475','476','6
828     ! 16','617','618','619','620','621','003','004','011','012','013','240';
829       %let ConditionAdminType='4';
830       
25                                       The WPS System   12:31 Wednesday, October 24, 2018     

831       *** Modified ;
832       *** %let ConditionProcGRP='0090','0095','2370','1045','4580','4585';
833       %let ConditionProcGRP=0090,0095,2370,1045,4580,4585; /* converted it to numeric */
834       
835       *** NeoNates;
836       %let NeonatesDRGList=790,791,792,793,794,795;
837       
838       *** importing the MetaData;
839       %macro ImportMeta(inputdata,sasoutput);
840       PROC IMPORT
841       	datafile="/rpscan/u0086308/POPSTRATIFICATION/data/&inputdata."
842       	out=temp.&sasoutput.
843       	replace;
844       getnames=YES;
845       guessingrows=MAX;
846       run;
847       %mend ImportMeta;
848       
849       
850       
851       *** Modified ;
852       *** sample of 100 patients with classification;
853       *** %ImportMeta(AllClientSample&version..csv,SamplewClassification); /* skip this if w
853     ! e create directly the sample file in SAS */
854       
855       *** Crossmap from HCPC codes to Procedure Groups --- not used anymore;
856       %ImportMeta(HCPCcrossmapPROCGRP16r2.csv,HcpcXwalkGRP);*/
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/HCPCcrossmapPROCGRP16r2.c
                     sv" out=temp.HcpcXwalkGRP replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.223
      cpu time  : 0.101


MPRINT(IMPORTMETA):  data temp.HcpcXwalkGRP;
857       data temp.HcpcXwalkGRP;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/HCPCcrossmapPROCGRP16r2.csv'
                     delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
858         infile '/rpscan/u0086308/POPSTRATIFICATION/data/HCPCcrossmapPROCGRP16r2.csv' delimit
858     ! er=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'HCPC'n $5.;
859         informat 'HCPC'n $5.;
MPRINT(IMPORTMETA):  informat 'ProcGRP'n BEST32.;
860         informat 'ProcGRP'n BEST32.;
MPRINT(IMPORTMETA):  informat 'csc'n $15.;
861         informat 'csc'n $15.;
MPRINT(IMPORTMETA):  informat 'atg'n $14.;
862         informat 'atg'n $14.;
26                                       The WPS System   12:31 Wednesday, October 24, 2018     

MPRINT(IMPORTMETA):  informat 'atg_priority'n BEST32.;
863         informat 'atg_priority'n BEST32.;
MPRINT(IMPORTMETA):  informat 'procgrp_intensity'n BEST32.;
864         informat 'procgrp_intensity'n BEST32.;
MPRINT(IMPORTMETA):  informat 'hcpcs_intensity'n BEST32.;
865         informat 'hcpcs_intensity'n BEST32.;
MPRINT(IMPORTMETA):  informat 'imputed_rel_wgt'n BEST32.;
866         informat 'imputed_rel_wgt'n BEST32.;
MPRINT(IMPORTMETA):  informat 'status_ind'n $3.;
867         informat 'status_ind'n $3.;
MPRINT(IMPORTMETA):  informat 'procgrp_ver'n BEST32.;
868         informat 'procgrp_ver'n BEST32.;
MPRINT(IMPORTMETA):  informat 'release'n BEST32.;
869         informat 'release'n BEST32.;
MPRINT(IMPORTMETA):  format 'HCPC'n $5.;
870         format 'HCPC'n $5.;
MPRINT(IMPORTMETA):  format 'ProcGRP'n BEST12.;
871         format 'ProcGRP'n BEST12.;
MPRINT(IMPORTMETA):  format 'csc'n $15.;
872         format 'csc'n $15.;
MPRINT(IMPORTMETA):  format 'atg'n $14.;
873         format 'atg'n $14.;
MPRINT(IMPORTMETA):  format 'atg_priority'n BEST12.;
874         format 'atg_priority'n BEST12.;
MPRINT(IMPORTMETA):  format 'procgrp_intensity'n BEST12.;
875         format 'procgrp_intensity'n BEST12.;
MPRINT(IMPORTMETA):  format 'hcpcs_intensity'n BEST12.;
876         format 'hcpcs_intensity'n BEST12.;
MPRINT(IMPORTMETA):  format 'imputed_rel_wgt'n BEST12.;
877         format 'imputed_rel_wgt'n BEST12.;
MPRINT(IMPORTMETA):  format 'status_ind'n $3.;
878         format 'status_ind'n $3.;
MPRINT(IMPORTMETA):  format 'procgrp_ver'n BEST12.;
879         format 'procgrp_ver'n BEST12.;
MPRINT(IMPORTMETA):  format 'release'n BEST12.;
880         format 'release'n BEST12.;
MPRINT(IMPORTMETA):  label 'HCPC'n = 'HCPC';
881         label 'HCPC'n = 'HCPC';
MPRINT(IMPORTMETA):  label 'ProcGRP'n = 'ProcGRP';
882         label 'ProcGRP'n = 'ProcGRP';
MPRINT(IMPORTMETA):  label 'csc'n = 'csc';
883         label 'csc'n = 'csc';
MPRINT(IMPORTMETA):  label 'atg'n = 'atg';
884         label 'atg'n = 'atg';
MPRINT(IMPORTMETA):  label 'atg_priority'n = 'atg_priority';
885         label 'atg_priority'n = 'atg_priority';
MPRINT(IMPORTMETA):  label 'procgrp_intensity'n = 'procgrp_intensity';
886         label 'procgrp_intensity'n = 'procgrp_intensity';
MPRINT(IMPORTMETA):  label 'hcpcs_intensity'n = 'hcpcs_intensity';
887         label 'hcpcs_intensity'n = 'hcpcs_intensity';
MPRINT(IMPORTMETA):  label 'imputed_rel_wgt'n = 'imputed_rel_wgt';
888         label 'imputed_rel_wgt'n = 'imputed_rel_wgt';
MPRINT(IMPORTMETA):  label 'status_ind'n = 'status_ind';
27                                       The WPS System   12:31 Wednesday, October 24, 2018     

889         label 'status_ind'n = 'status_ind';
MPRINT(IMPORTMETA):  label 'procgrp_ver'n = 'procgrp_ver';
890         label 'procgrp_ver'n = 'procgrp_ver';
MPRINT(IMPORTMETA):  label 'release'n = 'release';
891         label 'release'n = 'release';
892         input    'HCPC'n $
893           'ProcGRP'n
894           'csc'n $
895           'atg'n $
896           'atg_priority'n
897           'procgrp_intensity'n
898           'hcpcs_intensity'n
899           'imputed_rel_wgt'n
900           'status_ind'n $
MPRINT(IMPORTMETA):  input 'HCPC'n $   'ProcGRP'n  'csc'n $   'atg'n $   'atg_priority'n 
                     'procgrp_intensity'n  'hcpcs_intensity'n  'imputed_rel_wgt'n  'status_ind'n
                     $   'procgrp_ver'n  'release'n  ;
901           'procgrp_ver'n
902           'release'n
MPRINT(IMPORTMETA):  run;
903         ;
904         run;

NOTE: The file '/rpscan/u0086308/POPSTRATIFICATION/data/HCPCcrossmapPROCGRP16r2.csv' is:
      File Name=/rpscan/u0086308/POPSTRATIFICATION/data/HCPCcrossmapPROCGRP16r2.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=1310814, Last Modified=16:51:49 Mar 20 2017,
      Created=16:26:11 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 19423 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/HCPCcrossmapPROCGRP16r2.csv'
      The minimum record length was 42
      The maximum record length was 82
NOTE: Data set "TEMP.HcpcXwalkGRP" has 19423 observation(s) and 11 variable(s)
NOTE: The data step took :
      real time : 0.128
      cpu time  : 0.071


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
905       FILENAME ##IMPORT CLEAR;
906       *** List of DxCat and HCPC that define cancer treamtent;
907       %ImportMeta(JanetMetadata_CancerTreatment.csv,CancerTreatment);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_CancerTreat
                     ment.csv" out=temp.CancerTreatment replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.081
      cpu time  : 0.000
28                                       The WPS System   12:31 Wednesday, October 24, 2018     



MPRINT(IMPORTMETA):  data temp.CancerTreatment;
908       data temp.CancerTreatment;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_CancerTreatment.csv'
                     delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
909         infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_CancerTreatment.csv' d
909     ! elimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'DxCAT'n $5.;
910         informat 'DxCAT'n $5.;
MPRINT(IMPORTMETA):  informat 'Type'n $10.;
911         informat 'Type'n $10.;
MPRINT(IMPORTMETA):  informat 'Procedure'n $6.;
912         informat 'Procedure'n $6.;
MPRINT(IMPORTMETA):  informat 'GroupDescription'n $46.;
913         informat 'GroupDescription'n $46.;
MPRINT(IMPORTMETA):  format 'DxCAT'n $5.;
914         format 'DxCAT'n $5.;
MPRINT(IMPORTMETA):  format 'Type'n $10.;
915         format 'Type'n $10.;
MPRINT(IMPORTMETA):  format 'Procedure'n $6.;
916         format 'Procedure'n $6.;
MPRINT(IMPORTMETA):  format 'GroupDescription'n $46.;
917         format 'GroupDescription'n $46.;
MPRINT(IMPORTMETA):  label 'DxCAT'n = 'DxCAT';
918         label 'DxCAT'n = 'DxCAT';
MPRINT(IMPORTMETA):  label 'Type'n = 'Type';
919         label 'Type'n = 'Type';
MPRINT(IMPORTMETA):  label 'Procedure'n = 'Procedure';
920         label 'Procedure'n = 'Procedure';
MPRINT(IMPORTMETA):  label 'GroupDescription'n = 'GroupDescription';
921         label 'GroupDescription'n = 'GroupDescription';
922         input    'DxCAT'n $
923           'Type'n $
924           'Procedure'n $
MPRINT(IMPORTMETA):  input 'DxCAT'n $   'Type'n $   'Procedure'n $   'GroupDescription'n $   ;
925           'GroupDescription'n $
MPRINT(IMPORTMETA):  run;
926         ;
927         run;

NOTE: The file '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_CancerTreatment.csv' is:
      File Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_CancerTreatment.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=7464, Last Modified=16:16:19 Sep 26 2016,
      Created=16:26:12 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 138 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_CancerTreatment.csv'
      The minimum record length was 33
      The maximum record length was 62
29                                       The WPS System   12:31 Wednesday, October 24, 2018     

NOTE: Data set "TEMP.CancerTreatment" has 138 observation(s) and 4 variable(s)
NOTE: The data step took :
      real time : 0.012
      cpu time  : 0.002


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
928       FILENAME ##IMPORT CLEAR;
929       *** DxCat mapping into chronic or acute;
930       %ImportMeta(JanetMetadata_GeneralAssignments.csv,GeneralAssignments);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_GeneralAssi
                     gnments.csv" out=temp.GeneralAssignments replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.065
      cpu time  : 0.001


MPRINT(IMPORTMETA):  data temp.GeneralAssignments;
931       data temp.GeneralAssignments;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_GeneralAssignments.c
                     sv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
932         infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_GeneralAssignments.csv
932     ! ' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'DxCat'n $5.;
933         informat 'DxCat'n $5.;
MPRINT(IMPORTMETA):  informat 'Description'n $77.;
934         informat 'Description'n $77.;
MPRINT(IMPORTMETA):  informat 'Category'n $7.;
935         informat 'Category'n $7.;
MPRINT(IMPORTMETA):  format 'DxCat'n $5.;
936         format 'DxCat'n $5.;
MPRINT(IMPORTMETA):  format 'Description'n $77.;
937         format 'Description'n $77.;
MPRINT(IMPORTMETA):  format 'Category'n $7.;
938         format 'Category'n $7.;
MPRINT(IMPORTMETA):  label 'DxCat'n = 'DxCat';
939         label 'DxCat'n = 'DxCat';
MPRINT(IMPORTMETA):  label 'Description'n = 'Description';
940         label 'Description'n = 'Description';
MPRINT(IMPORTMETA):  label 'Category'n = 'Category';
941         label 'Category'n = 'Category';
942         input    'DxCat'n $
943           'Description'n $
MPRINT(IMPORTMETA):  input 'DxCat'n $   'Description'n $   'Category'n $   ;
944           'Category'n $
MPRINT(IMPORTMETA):  run;
945         ;
946         run;
30                                       The WPS System   12:31 Wednesday, October 24, 2018     


NOTE: The file '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_GeneralAssignments.csv'
      is:
      File Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_GeneralAssignments.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=24670, Last Modified=12:05:39 Dec 19 2016,
      Created=16:26:12 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 565 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_GeneralAssignments.csv'
      The minimum record length was 17
      The maximum record length was 76
NOTE: Data set "TEMP.GeneralAssignments" has 565 observation(s) and 3 variable(s)
NOTE: The data step took :
      real time : 0.015
      cpu time  : 0.003


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
947       FILENAME ##IMPORT CLEAR;
948       *** Import the Mapping of Procedure Group (OPEG) to ATG;
949       %ImportMeta(FromOPEG_ProcedureGroup_lookup_v2015_2.csv,OPEGLookup);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/FromOPEG_ProcedureGroup_l
                     ookup_v2015_2.csv" out=temp.OPEGLookup replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.218
      cpu time  : 0.086


MPRINT(IMPORTMETA):  data temp.OPEGLookup;
950       data temp.OPEGLookup;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/FromOPEG_ProcedureGroup_lookup_v20
                     15_2.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
951         infile '/rpscan/u0086308/POPSTRATIFICATION/data/FromOPEG_ProcedureGroup_lookup_v2015
951     ! _2.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'ProcedureName'n $51.;
952         informat 'ProcedureName'n $51.;
MPRINT(IMPORTMETA):  informat 'ProcedureGroup'n BEST32.;
953         informat 'ProcedureGroup'n BEST32.;
MPRINT(IMPORTMETA):  informat 'atg'n $12.;
954         informat 'atg'n $12.;
MPRINT(IMPORTMETA):  informat 'acg'n $15.;
955         informat 'acg'n $15.;
MPRINT(IMPORTMETA):  informat 'hcpcs'n $5.;
956         informat 'hcpcs'n $5.;
MPRINT(IMPORTMETA):  informat 'cpttitle'n $128.;
957         informat 'cpttitle'n $128.;
31                                       The WPS System   12:31 Wednesday, October 24, 2018     

MPRINT(IMPORTMETA):  format 'ProcedureName'n $51.;
958         format 'ProcedureName'n $51.;
MPRINT(IMPORTMETA):  format 'ProcedureGroup'n BEST12.;
959         format 'ProcedureGroup'n BEST12.;
MPRINT(IMPORTMETA):  format 'atg'n $12.;
960         format 'atg'n $12.;
MPRINT(IMPORTMETA):  format 'acg'n $15.;
961         format 'acg'n $15.;
MPRINT(IMPORTMETA):  format 'hcpcs'n $5.;
962         format 'hcpcs'n $5.;
MPRINT(IMPORTMETA):  format 'cpttitle'n $128.;
963         format 'cpttitle'n $128.;
MPRINT(IMPORTMETA):  label 'ProcedureName'n = 'ProcedureName';
964         label 'ProcedureName'n = 'ProcedureName';
MPRINT(IMPORTMETA):  label 'ProcedureGroup'n = 'ProcedureGroup';
965         label 'ProcedureGroup'n = 'ProcedureGroup';
MPRINT(IMPORTMETA):  label 'atg'n = 'atg';
966         label 'atg'n = 'atg';
MPRINT(IMPORTMETA):  label 'acg'n = 'acg';
967         label 'acg'n = 'acg';
MPRINT(IMPORTMETA):  label 'hcpcs'n = 'hcpcs';
968         label 'hcpcs'n = 'hcpcs';
MPRINT(IMPORTMETA):  label 'cpttitle'n = 'cpttitle';
969         label 'cpttitle'n = 'cpttitle';
970         input    'ProcedureName'n $
971           'ProcedureGroup'n
972           'atg'n $
973           'acg'n $
974           'hcpcs'n $
MPRINT(IMPORTMETA):  input 'ProcedureName'n $   'ProcedureGroup'n  'atg'n $   'acg'n $  
                     'hcpcs'n $   'cpttitle'n $   ;
975           'cpttitle'n $
MPRINT(IMPORTMETA):  run;
976         ;
977         run;

NOTE: The file
      '/rpscan/u0086308/POPSTRATIFICATION/data/FromOPEG_ProcedureGroup_lookup_v2015_2.csv' is:
      File
      Name=/rpscan/u0086308/POPSTRATIFICATION/data/FromOPEG_ProcedureGroup_lookup_v2015_2.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=1972727, Last Modified=16:52:31 Dec 19 2016,
      Created=16:26:11 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 18957 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/FromOPEG_ProcedureGroup_lookup_v2015_2.csv'
      The minimum record length was 50
      The maximum record length was 178
NOTE: Data set "TEMP.OPEGLookup" has 18957 observation(s) and 6 variable(s)
NOTE: The data step took :
      real time : 0.107
      cpu time  : 0.051
32                                       The WPS System   12:31 Wednesday, October 24, 2018     



MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
978       FILENAME ##IMPORT CLEAR;
979       *** Import the Mapping from DxCat to Significant Conditions;
980       %ImportMeta(JanetMetadata_SignificantConditions.csv,SignificantConditions);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_Significant
                     Conditions.csv" out=temp.SignificantConditions replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.015
      cpu time  : 0.000


MPRINT(IMPORTMETA):  data temp.SignificantConditions;
981       data temp.SignificantConditions;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SignificantCondition
                     s.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
982         infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SignificantConditions.
982     ! csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'DxCat'n $5.;
983         informat 'DxCat'n $5.;
MPRINT(IMPORTMETA):  informat 'Description'n $77.;
984         informat 'Description'n $77.;
MPRINT(IMPORTMETA):  informat 'Significance'n $4.;
985         informat 'Significance'n $4.;
MPRINT(IMPORTMETA):  format 'DxCat'n $5.;
986         format 'DxCat'n $5.;
MPRINT(IMPORTMETA):  format 'Description'n $77.;
987         format 'Description'n $77.;
MPRINT(IMPORTMETA):  format 'Significance'n $4.;
988         format 'Significance'n $4.;
MPRINT(IMPORTMETA):  label 'DxCat'n = 'DxCat';
989         label 'DxCat'n = 'DxCat';
MPRINT(IMPORTMETA):  label 'Description'n = 'Description';
990         label 'Description'n = 'Description';
MPRINT(IMPORTMETA):  label 'Significance'n = 'Significance';
991         label 'Significance'n = 'Significance';
992         input    'DxCat'n $
993           'Description'n $
MPRINT(IMPORTMETA):  input 'DxCat'n $   'Description'n $   'Significance'n $   ;
994           'Significance'n $
MPRINT(IMPORTMETA):  run;
995         ;
996         run;

NOTE: The file '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SignificantConditions.csv'
      is:
      File Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SignificantConditions.csv,
33                                       The WPS System   12:31 Wednesday, October 24, 2018     

      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=12700, Last Modified=17:09:25 Dec 19 2016,
      Created=16:26:12 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 296 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SignificantConditions.csv'
      The minimum record length was 15
      The maximum record length was 73
NOTE: Data set "TEMP.SignificantConditions" has 296 observation(s) and 3 variable(s)
NOTE: The data step took :
      real time : 0.015
      cpu time  : 0.002


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
997       FILENAME ##IMPORT CLEAR;
998       *** Import the Maintenance Drugs List;
999       %ImportMeta(JanetMetadata_MaintenanceDrugs.csv,ChronicRx);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_Maintenance
                     Drugs.csv" out=temp.ChronicRx replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.302
      cpu time  : 0.156


MPRINT(IMPORTMETA):  data temp.ChronicRx;
1000      data temp.ChronicRx;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_MaintenanceDrugs.csv
                     ' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
1001        infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_MaintenanceDrugs.csv' 
1001    ! delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'NDCNUM'n BEST32.;
1002        informat 'NDCNUM'n BEST32.;
MPRINT(IMPORTMETA):  informat 'GENERID'n BEST32.;
1003        informat 'GENERID'n BEST32.;
MPRINT(IMPORTMETA):  informat 'Prodname'n $64.;
1004        informat 'Prodname'n $64.;
MPRINT(IMPORTMETA):  informat 'Category'n $11.;
1005        informat 'Category'n $11.;
MPRINT(IMPORTMETA):  format 'NDCNUM'n BEST12.;
1006        format 'NDCNUM'n BEST12.;
MPRINT(IMPORTMETA):  format 'GENERID'n BEST12.;
1007        format 'GENERID'n BEST12.;
MPRINT(IMPORTMETA):  format 'Prodname'n $64.;
1008        format 'Prodname'n $64.;
MPRINT(IMPORTMETA):  format 'Category'n $11.;
1009        format 'Category'n $11.;
34                                       The WPS System   12:31 Wednesday, October 24, 2018     

MPRINT(IMPORTMETA):  label 'NDCNUM'n = 'NDCNUM';
1010        label 'NDCNUM'n = 'NDCNUM';
MPRINT(IMPORTMETA):  label 'GENERID'n = 'GENERID';
1011        label 'GENERID'n = 'GENERID';
MPRINT(IMPORTMETA):  label 'Prodname'n = 'Prodname';
1012        label 'Prodname'n = 'Prodname';
MPRINT(IMPORTMETA):  label 'Category'n = 'Category';
1013        label 'Category'n = 'Category';
1014        input    'NDCNUM'n
1015          'GENERID'n
1016          'Prodname'n $
MPRINT(IMPORTMETA):  input 'NDCNUM'n  'GENERID'n  'Prodname'n $   'Category'n $   ;
1017          'Category'n $
MPRINT(IMPORTMETA):  run;
1018        ;
1019        run;

NOTE: The file '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_MaintenanceDrugs.csv' is:
      File Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_MaintenanceDrugs.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=2737869, Last Modified=16:38:20 Jan 10 2017,
      Created=16:26:12 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 58539 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_MaintenanceDrugs.csv'
      The minimum record length was 33
      The maximum record length was 81
NOTE: Data set "TEMP.ChronicRx" has 58539 observation(s) and 4 variable(s)
NOTE: The data step took :
      real time : 0.233
      cpu time  : 0.119


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
1020      FILENAME ##IMPORT CLEAR;
1021      *** Import the mapping to Body Systems List;
1022      %ImportMeta(JanetMetadata_BodySystem.csv,BodySystem);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_BodySystem.
                     csv" out=temp.BodySystem replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.044
      cpu time  : 0.001


MPRINT(IMPORTMETA):  data temp.BodySystem;
1023      data temp.BodySystem;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_BodySystem.csv'
35                                       The WPS System   12:31 Wednesday, October 24, 2018     

                     delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
1024        infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_BodySystem.csv' delimi
1024    ! ter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'DxCat'n $5.;
1025        informat 'DxCat'n $5.;
MPRINT(IMPORTMETA):  informat 'Description'n $77.;
1026        informat 'Description'n $77.;
MPRINT(IMPORTMETA):  informat 'Body'n BEST32.;
1027        informat 'Body'n BEST32.;
MPRINT(IMPORTMETA):  informat 'BodyDescription'n $40.;
1028        informat 'BodyDescription'n $40.;
MPRINT(IMPORTMETA):  format 'DxCat'n $5.;
1029        format 'DxCat'n $5.;
MPRINT(IMPORTMETA):  format 'Description'n $77.;
1030        format 'Description'n $77.;
MPRINT(IMPORTMETA):  format 'Body'n BEST12.;
1031        format 'Body'n BEST12.;
MPRINT(IMPORTMETA):  format 'BodyDescription'n $40.;
1032        format 'BodyDescription'n $40.;
MPRINT(IMPORTMETA):  label 'DxCat'n = 'DxCat';
1033        label 'DxCat'n = 'DxCat';
MPRINT(IMPORTMETA):  label 'Description'n = 'Description';
1034        label 'Description'n = 'Description';
MPRINT(IMPORTMETA):  label 'Body'n = 'Body';
1035        label 'Body'n = 'Body';
MPRINT(IMPORTMETA):  label 'BodyDescription'n = 'BodyDescription';
1036        label 'BodyDescription'n = 'BodyDescription';
1037        input    'DxCat'n $
1038          'Description'n $
1039          'Body'n
MPRINT(IMPORTMETA):  input 'DxCat'n $   'Description'n $   'Body'n  'BodyDescription'n $   ;
1040          'BodyDescription'n $
MPRINT(IMPORTMETA):  run;
1041        ;
1042        run;

NOTE: The file '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_BodySystem.csv' is:
      File Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_BodySystem.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=28046, Last Modified=22:02:47 Jan 21 2017,
      Created=16:26:12 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 565 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_BodySystem.csv'
      The minimum record length was 18
      The maximum record length was 89
NOTE: Data set "TEMP.BodySystem" has 565 observation(s) and 4 variable(s)
NOTE: The data step took :
      real time : 0.029
      cpu time  : 0.004


36                                       The WPS System   12:31 Wednesday, October 24, 2018     

MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
1043      FILENAME ##IMPORT CLEAR;
1044      *** Import the list of conditions for Treatment Navigation logic;
1045      %ImportMeta(JanetMetadata_TreatmentNavigation.csv,TreatmentNavigation);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_TreatmentNa
                     vigation.csv" out=temp.TreatmentNavigation replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.065
      cpu time  : 0.000


MPRINT(IMPORTMETA):  data temp.TreatmentNavigation;
1046      data temp.TreatmentNavigation;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_TreatmentNavigation.
                     csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
1047        infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_TreatmentNavigation.cs
1047    ! v' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'Condition'n $36.;
1048        informat 'Condition'n $36.;
MPRINT(IMPORTMETA):  informat 'DxCat'n $5.;
1049        informat 'DxCat'n $5.;
MPRINT(IMPORTMETA):  informat 'Stage'n BEST32.;
1050        informat 'Stage'n BEST32.;
MPRINT(IMPORTMETA):  format 'Condition'n $36.;
1051        format 'Condition'n $36.;
MPRINT(IMPORTMETA):  format 'DxCat'n $5.;
1052        format 'DxCat'n $5.;
MPRINT(IMPORTMETA):  format 'Stage'n BEST12.;
1053        format 'Stage'n BEST12.;
MPRINT(IMPORTMETA):  label 'Condition'n = 'Condition';
1054        label 'Condition'n = 'Condition';
MPRINT(IMPORTMETA):  label 'DxCat'n = 'DxCat';
1055        label 'DxCat'n = 'DxCat';
MPRINT(IMPORTMETA):  label 'Stage'n = 'Stage';
1056        label 'Stage'n = 'Stage';
1057        input    'Condition'n $
MPRINT(IMPORTMETA):  input 'Condition'n $   'DxCat'n $   'Stage'n  ;
1058          'DxCat'n $
1059          'Stage'n
MPRINT(IMPORTMETA):  run;
1060        ;
1061        run;

NOTE: The file '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_TreatmentNavigation.csv'
      is:
      File Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_TreatmentNavigation.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
37                                       The WPS System   12:31 Wednesday, October 24, 2018     

      File Size=981, Last Modified=16:39:57 Feb 27 2017,
      Created=16:26:13 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 31 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_TreatmentNavigation.csv'
      The minimum record length was 14
      The maximum record length was 39
NOTE: Data set "TEMP.TreatmentNavigation" has 31 observation(s) and 3 variable(s)
NOTE: The data step took :
      real time : 0.017
      cpu time  : 0.002


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
1062      FILENAME ##IMPORT CLEAR;
1063      *** Import the list of DxCats for general active cancer for Surveillance logic;
1064      %ImportMeta(JanetMetadata_SurveillanceGeneralActiveCancerDxCat.csv,SurvGeneralActiveCa
1064    ! ncerDxCat);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_Surveillanc
                     eGeneralActiveCancerDxCat.csv" out=temp.SurvGeneralActiveCancerDxCat
                     replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.004
      cpu time  : 0.000


MPRINT(IMPORTMETA):  data temp.SurvGeneralActiveCancerDxCat;
1065      data temp.SurvGeneralActiveCancerDxCat;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceGeneralA
                     ctiveCancerDxCat.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
1066        infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceGeneralAct
1066    ! iveCancerDxCat.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'Type'n $2.;
1067        informat 'Type'n $2.;
MPRINT(IMPORTMETA):  informat 'DxCat'n $5.;
1068        informat 'DxCat'n $5.;
MPRINT(IMPORTMETA):  informat 'Description'n $74.;
1069        informat 'Description'n $74.;
MPRINT(IMPORTMETA):  format 'Type'n $2.;
1070        format 'Type'n $2.;
MPRINT(IMPORTMETA):  format 'DxCat'n $5.;
1071        format 'DxCat'n $5.;
MPRINT(IMPORTMETA):  format 'Description'n $74.;
1072        format 'Description'n $74.;
MPRINT(IMPORTMETA):  label 'Type'n = 'Type';
1073        label 'Type'n = 'Type';
MPRINT(IMPORTMETA):  label 'DxCat'n = 'DxCat';
1074        label 'DxCat'n = 'DxCat';
38                                       The WPS System   12:31 Wednesday, October 24, 2018     

MPRINT(IMPORTMETA):  label 'Description'n = 'Description';
1075        label 'Description'n = 'Description';
1076        input    'Type'n $
1077          'DxCat'n $
MPRINT(IMPORTMETA):  input 'Type'n $   'DxCat'n $   'Description'n $   ;
1078          'Description'n $
MPRINT(IMPORTMETA):  run;
1079        ;
1080        run;

NOTE: The file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceGeneralActiveCancerDxCa
      t.csv' is:
      File
      Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceGeneralActiveCancer
      DxCat.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=4152, Last Modified=22:29:44 Mar 21 2017,
      Created=16:26:12 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 77 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceGeneralActiveCancerDxCa
      t.csv'
      The minimum record length was 27
      The maximum record length was 71
NOTE: Data set "TEMP.SurvGeneralActiveCancerDxCat" has 77 observation(s) and 3 variable(s)
NOTE: The data step took :
      real time : 0.012
      cpu time  : 0.002


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
1081      FILENAME ##IMPORT CLEAR;
1082      *** Import the list of PROCGRP for general active cancer for Surveillance logic;
1083      %ImportMeta(JanetMetadata_SurveillanceGeneralActiveCancerPROCGRP.csv,SurvGeneralActive
1083    ! CancerPROCGRP);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_Surveillanc
                     eGeneralActiveCancerPROCGRP.csv" out=temp.SurvGeneralActiveCancerPROCGRP
                     replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.001
      cpu time  : 0.000


MPRINT(IMPORTMETA):  data temp.SurvGeneralActiveCancerPROCGRP;
1084      data temp.SurvGeneralActiveCancerPROCGRP;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceGeneralA
39                                       The WPS System   12:31 Wednesday, October 24, 2018     

                     ctiveCancerPROCGRP.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
1085        infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceGeneralAct
1085    ! iveCancerPROCGRP.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'PROCGRP'n BEST32.;
1086        informat 'PROCGRP'n BEST32.;
MPRINT(IMPORTMETA):  informat 'Description'n $46.;
1087        informat 'Description'n $46.;
MPRINT(IMPORTMETA):  format 'PROCGRP'n BEST12.;
1088        format 'PROCGRP'n BEST12.;
MPRINT(IMPORTMETA):  format 'Description'n $46.;
1089        format 'Description'n $46.;
MPRINT(IMPORTMETA):  label 'PROCGRP'n = 'PROCGRP';
1090        label 'PROCGRP'n = 'PROCGRP';
MPRINT(IMPORTMETA):  label 'Description'n = 'Description';
1091        label 'Description'n = 'Description';
1092        input    'PROCGRP'n
MPRINT(IMPORTMETA):  input 'PROCGRP'n  'Description'n $   ;
1093          'Description'n $
MPRINT(IMPORTMETA):  run;
1094        ;
1095        run;

NOTE: The file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceGeneralActiveCancerPROC
      GRP.csv' is:
      File
      Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceGeneralActiveCancer
      PROCGRP.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=952, Last Modified=16:22:56 Mar 20 2017,
      Created=16:26:13 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 25 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceGeneralActiveCancerPROC
      GRP.csv'
      The minimum record length was 19
      The maximum record length was 45
NOTE: Data set "TEMP.SurvGeneralActiveCancerPROCGRP" has 25 observation(s) and 2 variable(s)
NOTE: The data step took :
      real time : 0.013
      cpu time  : 0.001


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
1096      FILENAME ##IMPORT CLEAR;
1097      
1098      
1099      *** Modified ;
1100      *** Import the list of PROCGRP for specific active cancer for Surveillance logic;
1101      *** %ImportMeta(JanetMetadata_SurveillanceSpecificActiveCancer.csv,SurvSpecificActiveC
1101    ! ancer);
1102      *** line 144 - Q2043;
40                                       The WPS System   12:31 Wednesday, October 24, 2018     

1103      data  temp.SurvSpecificActiveCancer;
1104          infile '/rpscan/u071366/JanetMetadata_SurveillanceSpecificActiveCancer.csv' delimi
1104    ! ter=',' MISSOVER DSD firstobs=2 LRECL=32760;
1105      
1106      	informat 'DxCat'n $5.;
1107      	informat 'DxCatDesc'n $75.;
1108      	informat 'PROCGRP'n BEST32.;
1109      	informat 'Procedure_group'n $51.;
1110      	informat 'stage'n BEST32.;
1111      	format 'DxCat'n $5.;
1112      	format 'DxCatDesc'n $75.;
1113      	format 'PROCGRP'n BEST12.;
1114      	format 'Procedure_group'n $51.;
1115      	format 'stage'n BEST12.;
1116      	label 'DxCat'n = 'DxCat';
1117      	label 'DxCatDesc'n = 'DxCatDesc';
1118      	label 'PROCGRP'n = 'PROCGRP';
1119      	label 'Procedure_group'n = 'Procedure group';
1120      	label 'stage'n = 'stage';
1121      	input    'DxCat'n $
1122      		'DxCatDesc'n $
1123      		'PROCGRP'n
1124      		'Procedure_group'n $
1125      		'stage'n
1126      		;
1127      run;

NOTE: The file '/rpscan/u071366/JanetMetadata_SurveillanceSpecificActiveCancer.csv' is:
      File Name=/rpscan/u071366/JanetMetadata_SurveillanceSpecificActiveCancer.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=12684, Last Modified=16:51:32 Oct 22 2018,
      Created=16:51:32 Oct 22 2018, Lrecl=32760, Recfm=V

NOTE: 157 records were read from file
      '/rpscan/u071366/JanetMetadata_SurveillanceSpecificActiveCancer.csv'
      The minimum record length was 35
      The maximum record length was 100
NOTE: Data set "TEMP.SurvSpecificActiveCancer" has 157 observation(s) and 5 variable(s)
NOTE: The data step took :
      real time : 0.078
      cpu time  : 0.002


1128      
1129      
1130      *** Import the list of PROCGRP for miscellaneous for Surveillance logic;
1131      %ImportMeta(JanetMetadata_SurveillanceMiscellaneous.csv,SurvMiscellaneous);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_Surveillanc
                     eMiscellaneous.csv" out=temp.SurvMiscellaneous replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
41                                       The WPS System   12:31 Wednesday, October 24, 2018     

MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.038
      cpu time  : 0.000


MPRINT(IMPORTMETA):  data temp.SurvMiscellaneous;
1132      data temp.SurvMiscellaneous;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceMiscella
                     neous.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
1133        infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceMiscellane
1133    ! ous.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'CodeType'n $3.;
1134        informat 'CodeType'n $3.;
MPRINT(IMPORTMETA):  informat 'Code'n BEST32.;
1135        informat 'Code'n BEST32.;
MPRINT(IMPORTMETA):  informat 'Description'n $48.;
1136        informat 'Description'n $48.;
MPRINT(IMPORTMETA):  format 'CodeType'n $3.;
1137        format 'CodeType'n $3.;
MPRINT(IMPORTMETA):  format 'Code'n BEST12.;
1138        format 'Code'n BEST12.;
MPRINT(IMPORTMETA):  format 'Description'n $48.;
1139        format 'Description'n $48.;
MPRINT(IMPORTMETA):  label 'CodeType'n = 'CodeType';
1140        label 'CodeType'n = 'CodeType';
MPRINT(IMPORTMETA):  label 'Code'n = 'Code';
1141        label 'Code'n = 'Code';
MPRINT(IMPORTMETA):  label 'Description'n = 'Description';
1142        label 'Description'n = 'Description';
1143        input    'CodeType'n $
1144          'Code'n
MPRINT(IMPORTMETA):  input 'CodeType'n $   'Code'n  'Description'n $   ;
1145          'Description'n $
MPRINT(IMPORTMETA):  run;
1146        ;
1147        run;

NOTE: The file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceMiscellaneous.csv' is:
      File
      Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceMiscellaneous.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=480, Last Modified=14:05:02 Mar 30 2017,
      Created=16:26:13 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 13 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceMiscellaneous.csv'
      The minimum record length was 21
      The maximum record length was 48
NOTE: Data set "TEMP.SurvMiscellaneous" has 13 observation(s) and 3 variable(s)
42                                       The WPS System   12:31 Wednesday, October 24, 2018     

NOTE: The data step took :
      real time : 0.014
      cpu time  : 0.002


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
1148      FILENAME ##IMPORT CLEAR;
1149      *** Import the list of PROCGRP for Chemo Active for Surveillance;
1150      %ImportMeta(JanetMetadata_SurveillanceChemoActive.csv,SurvChemoActive);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_Surveillanc
                     eChemoActive.csv" out=temp.SurvChemoActive replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.048
      cpu time  : 0.001


MPRINT(IMPORTMETA):  data temp.SurvChemoActive;
1151      data temp.SurvChemoActive;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceChemoAct
                     ive.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
1152        infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceChemoActiv
1152    ! e.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'ndc'n BEST32.;
1153        informat 'ndc'n BEST32.;
MPRINT(IMPORTMETA):  informat 'therClassCode'n BEST32.;
1154        informat 'therClassCode'n BEST32.;
MPRINT(IMPORTMETA):  informat 'Inttherclass'n BEST32.;
1155        informat 'Inttherclass'n BEST32.;
MPRINT(IMPORTMETA):  informat 'therDesc'n $25.;
1156        informat 'therDesc'n $25.;
MPRINT(IMPORTMETA):  informat 'gcrTitles'n $36.;
1157        informat 'gcrTitles'n $36.;
MPRINT(IMPORTMETA):  informat 'genindDesc'n $32.;
1158        informat 'genindDesc'n $32.;
MPRINT(IMPORTMETA):  informat 'roa'n $2.;
1159        informat 'roa'n $2.;
MPRINT(IMPORTMETA):  informat 'cyle'n $5.;
1160        informat 'cyle'n $5.;
MPRINT(IMPORTMETA):  informat 'Active'n $6.;
1161        informat 'Active'n $6.;
MPRINT(IMPORTMETA):  format 'ndc'n BEST12.;
1162        format 'ndc'n BEST12.;
MPRINT(IMPORTMETA):  format 'therClassCode'n BEST12.;
1163        format 'therClassCode'n BEST12.;
MPRINT(IMPORTMETA):  format 'Inttherclass'n BEST12.;
1164        format 'Inttherclass'n BEST12.;
MPRINT(IMPORTMETA):  format 'therDesc'n $25.;
1165        format 'therDesc'n $25.;
43                                       The WPS System   12:31 Wednesday, October 24, 2018     

MPRINT(IMPORTMETA):  format 'gcrTitles'n $36.;
1166        format 'gcrTitles'n $36.;
MPRINT(IMPORTMETA):  format 'genindDesc'n $32.;
1167        format 'genindDesc'n $32.;
MPRINT(IMPORTMETA):  format 'roa'n $2.;
1168        format 'roa'n $2.;
MPRINT(IMPORTMETA):  format 'cyle'n $5.;
1169        format 'cyle'n $5.;
MPRINT(IMPORTMETA):  format 'Active'n $6.;
1170        format 'Active'n $6.;
MPRINT(IMPORTMETA):  label 'ndc'n = 'ndc';
1171        label 'ndc'n = 'ndc';
MPRINT(IMPORTMETA):  label 'therClassCode'n = 'therClassCode';
1172        label 'therClassCode'n = 'therClassCode';
MPRINT(IMPORTMETA):  label 'Inttherclass'n = 'Inttherclass';
1173        label 'Inttherclass'n = 'Inttherclass';
MPRINT(IMPORTMETA):  label 'therDesc'n = 'therDesc';
1174        label 'therDesc'n = 'therDesc';
MPRINT(IMPORTMETA):  label 'gcrTitles'n = 'gcrTitles';
1175        label 'gcrTitles'n = 'gcrTitles';
MPRINT(IMPORTMETA):  label 'genindDesc'n = 'genindDesc';
1176        label 'genindDesc'n = 'genindDesc';
MPRINT(IMPORTMETA):  label 'roa'n = 'roa';
1177        label 'roa'n = 'roa';
MPRINT(IMPORTMETA):  label 'cyle'n = 'cyle';
1178        label 'cyle'n = 'cyle';
MPRINT(IMPORTMETA):  label 'Active'n = 'Active';
1179        label 'Active'n = 'Active';
1180        input    'ndc'n
1181          'therClassCode'n
1182          'Inttherclass'n
1183          'therDesc'n $
1184          'gcrTitles'n $
1185          'genindDesc'n $
1186          'roa'n $
1187          'cyle'n $
MPRINT(IMPORTMETA):  input 'ndc'n  'therClassCode'n  'Inttherclass'n  'therDesc'n $  
                     'gcrTitles'n $   'genindDesc'n $   'roa'n $   'cyle'n $   'Active'n $   ;
1188          'Active'n $
MPRINT(IMPORTMETA):  run;
1189        ;
1190        run;

NOTE: The file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceChemoActive.csv' is:
      File
      Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceChemoActive.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=30227, Last Modified=17:09:52 Mar 20 2017,
      Created=16:26:12 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 308 records were read from file
44                                       The WPS System   12:31 Wednesday, October 24, 2018     

      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceChemoActive.csv'
      The minimum record length was 82
      The maximum record length was 108
NOTE: Data set "TEMP.SurvChemoActive" has 308 observation(s) and 9 variable(s)
NOTE: The data step took :
      real time : 0.017
      cpu time  : 0.003


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
1191      FILENAME ##IMPORT CLEAR;
1192      *** Import the list of PROCGRP for Chemo Chronic for Surveillance;
1193      %ImportMeta(JanetMetadata_SurveillanceChemoChronic.csv,SurvChemoChronic);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_Surveillanc
                     eChemoChronic.csv" out=temp.SurvChemoChronic replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.029
      cpu time  : 0.002


MPRINT(IMPORTMETA):  data temp.SurvChemoChronic;
1194      data temp.SurvChemoChronic;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceChemoChr
                     onic.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
1195        infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceChemoChron
1195    ! ic.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'ndc'n BEST32.;
1196        informat 'ndc'n BEST32.;
MPRINT(IMPORTMETA):  informat 'therClassCode'n BEST32.;
1197        informat 'therClassCode'n BEST32.;
MPRINT(IMPORTMETA):  informat 'Inttherclass'n BEST32.;
1198        informat 'Inttherclass'n BEST32.;
MPRINT(IMPORTMETA):  informat 'therDesc'n $25.;
1199        informat 'therDesc'n $25.;
MPRINT(IMPORTMETA):  informat 'gcrTitles'n $49.;
1200        informat 'gcrTitles'n $49.;
MPRINT(IMPORTMETA):  informat 'genindDesc'n $29.;
1201        informat 'genindDesc'n $29.;
MPRINT(IMPORTMETA):  informat 'roa'n $2.;
1202        informat 'roa'n $2.;
MPRINT(IMPORTMETA):  informat 'cyle'n $1.;
1203        informat 'cyle'n $1.;
MPRINT(IMPORTMETA):  informat 'Active'n $1.;
1204        informat 'Active'n $1.;
MPRINT(IMPORTMETA):  format 'ndc'n BEST12.;
1205        format 'ndc'n BEST12.;
MPRINT(IMPORTMETA):  format 'therClassCode'n BEST12.;
1206        format 'therClassCode'n BEST12.;
45                                       The WPS System   12:31 Wednesday, October 24, 2018     

MPRINT(IMPORTMETA):  format 'Inttherclass'n BEST12.;
1207        format 'Inttherclass'n BEST12.;
MPRINT(IMPORTMETA):  format 'therDesc'n $25.;
1208        format 'therDesc'n $25.;
MPRINT(IMPORTMETA):  format 'gcrTitles'n $49.;
1209        format 'gcrTitles'n $49.;
MPRINT(IMPORTMETA):  format 'genindDesc'n $29.;
1210        format 'genindDesc'n $29.;
MPRINT(IMPORTMETA):  format 'roa'n $2.;
1211        format 'roa'n $2.;
MPRINT(IMPORTMETA):  format 'cyle'n $1.;
1212        format 'cyle'n $1.;
MPRINT(IMPORTMETA):  format 'Active'n $1.;
1213        format 'Active'n $1.;
MPRINT(IMPORTMETA):  label 'ndc'n = 'ndc';
1214        label 'ndc'n = 'ndc';
MPRINT(IMPORTMETA):  label 'therClassCode'n = 'therClassCode';
1215        label 'therClassCode'n = 'therClassCode';
MPRINT(IMPORTMETA):  label 'Inttherclass'n = 'Inttherclass';
1216        label 'Inttherclass'n = 'Inttherclass';
MPRINT(IMPORTMETA):  label 'therDesc'n = 'therDesc';
1217        label 'therDesc'n = 'therDesc';
MPRINT(IMPORTMETA):  label 'gcrTitles'n = 'gcrTitles';
1218        label 'gcrTitles'n = 'gcrTitles';
MPRINT(IMPORTMETA):  label 'genindDesc'n = 'genindDesc';
1219        label 'genindDesc'n = 'genindDesc';
MPRINT(IMPORTMETA):  label 'roa'n = 'roa';
1220        label 'roa'n = 'roa';
MPRINT(IMPORTMETA):  label 'cyle'n = 'cyle';
1221        label 'cyle'n = 'cyle';
MPRINT(IMPORTMETA):  label 'Active'n = 'Active';
1222        label 'Active'n = 'Active';
1223        input    'ndc'n
1224          'therClassCode'n
1225          'Inttherclass'n
1226          'therDesc'n $
1227          'gcrTitles'n $
1228          'genindDesc'n $
1229          'roa'n $
1230          'cyle'n $
MPRINT(IMPORTMETA):  input 'ndc'n  'therClassCode'n  'Inttherclass'n  'therDesc'n $  
                     'gcrTitles'n $   'genindDesc'n $   'roa'n $   'cyle'n $   'Active'n $   ;
1231          'Active'n $
MPRINT(IMPORTMETA):  run;
1232        ;
1233        run;

NOTE: The file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceChemoChronic.csv' is:
      File
      Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceChemoChronic.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
46                                       The WPS System   12:31 Wednesday, October 24, 2018     

      File Size=46172, Last Modified=17:11:04 Mar 20 2017,
      Created=16:26:12 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 546 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_SurveillanceChemoChronic.csv'
      The minimum record length was 71
      The maximum record length was 106
NOTE: Data set "TEMP.SurvChemoChronic" has 546 observation(s) and 9 variable(s)
NOTE: The data step took :
      real time : 0.120
      cpu time  : 0.003


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
1234      FILENAME ##IMPORT CLEAR;
1235      *** Import the list of DxCat for Rebalance, new conditions;
1236      %ImportMeta(JanetMetadata_RebalanceNewDxCat.csv,RebalanceNewDxCat);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNe
                     wDxCat.csv" out=temp.RebalanceNewDxCat replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.007
      cpu time  : 0.000


MPRINT(IMPORTMETA):  data temp.RebalanceNewDxCat;
1237      data temp.RebalanceNewDxCat;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDxCat.cs
                     v' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
1238        infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDxCat.csv'
1238    !  delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'DxCat'n $5.;
1239        informat 'DxCat'n $5.;
MPRINT(IMPORTMETA):  informat 'Stage'n BEST32.;
1240        informat 'Stage'n BEST32.;
MPRINT(IMPORTMETA):  informat 'StageHistory'n BEST32.;
1241        informat 'StageHistory'n BEST32.;
MPRINT(IMPORTMETA):  format 'DxCat'n $5.;
1242        format 'DxCat'n $5.;
MPRINT(IMPORTMETA):  format 'Stage'n BEST12.;
1243        format 'Stage'n BEST12.;
MPRINT(IMPORTMETA):  format 'StageHistory'n BEST12.;
1244        format 'StageHistory'n BEST12.;
MPRINT(IMPORTMETA):  label 'DxCat'n = 'DxCat';
1245        label 'DxCat'n = 'DxCat';
MPRINT(IMPORTMETA):  label 'Stage'n = 'Stage';
1246        label 'Stage'n = 'Stage';
MPRINT(IMPORTMETA):  label 'StageHistory'n = 'StageHistory';
1247        label 'StageHistory'n = 'StageHistory';
47                                       The WPS System   12:31 Wednesday, October 24, 2018     

1248        input    'DxCat'n $
MPRINT(IMPORTMETA):  input 'DxCat'n $   'Stage'n  'StageHistory'n  ;
1249          'Stage'n
1250          'StageHistory'n
MPRINT(IMPORTMETA):  run;
1251        ;
1252        run;

NOTE: The file '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDxCat.csv'
      is:
      File Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDxCat.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=1061, Last Modified=16:52:33 Apr 10 2017,
      Created=16:26:12 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 93 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDxCat.csv'
      The minimum record length was 9
      The maximum record length was 15
NOTE: Data set "TEMP.RebalanceNewDxCat" has 93 observation(s) and 3 variable(s)
NOTE: The data step took :
      real time : 0.037
      cpu time  : 0.001


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
1253      FILENAME ##IMPORT CLEAR;
1254      *** Import the list of DxCat for Rebalance, new conditions wo drugs in the prior 90 da
1254    ! ys;
1255      %ImportMeta(JanetMetadata_RebalanceNewDxCatwoRx.csv,RebalanceNewDxCatwoRx);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNe
                     wDxCatwoRx.csv" out=temp.RebalanceNewDxCatwoRx replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.010
      cpu time  : 0.000


MPRINT(IMPORTMETA):  data temp.RebalanceNewDxCatwoRx;
1256      data temp.RebalanceNewDxCatwoRx;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDxCatwoR
                     x.csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
1257        infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDxCatwoRx.
1257    ! csv' delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'DxCat'n $5.;
1258        informat 'DxCat'n $5.;
MPRINT(IMPORTMETA):  informat 'TherCls'n BEST32.;
1259        informat 'TherCls'n BEST32.;
48                                       The WPS System   12:31 Wednesday, October 24, 2018     

MPRINT(IMPORTMETA):  format 'DxCat'n $5.;
1260        format 'DxCat'n $5.;
MPRINT(IMPORTMETA):  format 'TherCls'n BEST12.;
1261        format 'TherCls'n BEST12.;
MPRINT(IMPORTMETA):  label 'DxCat'n = 'DxCat';
1262        label 'DxCat'n = 'DxCat';
MPRINT(IMPORTMETA):  label 'TherCls'n = 'TherCls';
1263        label 'TherCls'n = 'TherCls';
MPRINT(IMPORTMETA):  input 'DxCat'n $   'TherCls'n  ;
1264        input    'DxCat'n $
1265          'TherCls'n
MPRINT(IMPORTMETA):  run;
1266        ;
1267        run;

NOTE: The file '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDxCatwoRx.csv'
      is:
      File Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDxCatwoRx.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=154, Last Modified=11:58:20 Apr 10 2017,
      Created=16:26:12 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 13 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDxCatwoRx.csv'
      The minimum record length was 8
      The maximum record length was 9
NOTE: Data set "TEMP.RebalanceNewDxCatwoRx" has 13 observation(s) and 2 variable(s)
NOTE: The data step took :
      real time : 0.029
      cpu time  : 0.001


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
1268      FILENAME ##IMPORT CLEAR;
1269      
1270      *** Modified ;
1271      *** Import the list of DxCat for Rebalance, new ICD9;
1272      *** %ImportMeta(JanetMetadata_RebalanceNewDx.csv,RebalanceNewDx);
1273      data  temp.RebalanceNewDx;
1274          infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDx.csv' 
1274    ! delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
1275      
1276      	informat 'ICD'n $4.;
1277      	informat 'Description'n $13.;
1278      	format 'ICD'n $4.;
1279      	format 'Description'n $13.;
1280      	label 'ICD'n = 'ICD';
1281      	label 'Description'n = 'Description';
1282      	input    'ICD'n $
1283      		'Description'n $
1284      		;
1285      run;
49                                       The WPS System   12:31 Wednesday, October 24, 2018     


NOTE: The file '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDx.csv' is:
      File Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDx.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=449, Last Modified=16:28:16 Mar 31 2017,
      Created=16:26:12 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 18 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDx.csv'
      The minimum record length was 22
      The maximum record length was 22
NOTE: Data set "TEMP.RebalanceNewDx" has 18 observation(s) and 2 variable(s)
NOTE: The data step took :
      real time : 0.038
      cpu time  : 0.001


1286      
1287      
1288      *** Import the list of DxCat for Rebalance, new DRG;
1289      %ImportMeta(JanetMetadata_RebalanceNewDRG.csv,RebalanceNewDRG);
MPRINT(IMPORTMETA):  PROC IMPORT
                     datafile="/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNe
                     wDRG.csv" out=temp.RebalanceNewDRG replace;
MPRINT(IMPORTMETA):  getnames=YES;
MPRINT(IMPORTMETA):  guessingrows=MAX;
MPRINT(IMPORTMETA):  run;
NOTE: Procedure IMPORT step took :
      real time : 0.025
      cpu time  : 0.000


MPRINT(IMPORTMETA):  data temp.RebalanceNewDRG;
1290      data temp.RebalanceNewDRG;
MPRINT(IMPORTMETA):  infile
                     '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDRG.csv'
                     delimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
1291        infile '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDRG.csv' d
1291    ! elimiter=',' MISSOVER DSD firstobs=2 LRECL=32760;
MPRINT(IMPORTMETA):  informat 'DRG'n BEST32.;
1292        informat 'DRG'n BEST32.;
MPRINT(IMPORTMETA):  informat 'Description'n $24.;
1293        informat 'Description'n $24.;
MPRINT(IMPORTMETA):  format 'DRG'n BEST12.;
1294        format 'DRG'n BEST12.;
MPRINT(IMPORTMETA):  format 'Description'n $24.;
1295        format 'Description'n $24.;
MPRINT(IMPORTMETA):  label 'DRG'n = 'DRG';
1296        label 'DRG'n = 'DRG';
MPRINT(IMPORTMETA):  label 'Description'n = 'Description';
1297        label 'Description'n = 'Description';
1298        input    'DRG'n
50                                       The WPS System   12:31 Wednesday, October 24, 2018     

MPRINT(IMPORTMETA):  input 'DRG'n  'Description'n $   ;
1299          'Description'n $
MPRINT(IMPORTMETA):  run;
1300        ;
1301        run;

NOTE: The file '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDRG.csv' is:
      File Name=/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDRG.csv,
      Access Permissions=-rwxr-xr-x, Number of Links=1,
      Owner Name=u0086308, Group Name=devl,
      File Size=213, Last Modified=15:52:21 Mar 31 2017,
      Created=16:26:12 Oct 15 2018, Lrecl=32760, Recfm=V

NOTE: 9 records were read from file
      '/rpscan/u0086308/POPSTRATIFICATION/data/JanetMetadata_RebalanceNewDRG.csv'
      The minimum record length was 14
      The maximum record length was 32
NOTE: Data set "TEMP.RebalanceNewDRG" has 9 observation(s) and 2 variable(s)
NOTE: The data step took :
      real time : 0.049
      cpu time  : 0.001


MPRINT(IMPORTMETA):  FILENAME ##IMPORT CLEAR;
1302      FILENAME ##IMPORT CLEAR;
1303      
1304      *** labels for all categories, the ranking is important!!!;
1305      proc format;
1306      value categories
1307      	10='Crisis Management'
1308      	9='Surveillance'
1309      	8='Rebalancing'
1310      	7='Recovery Guidance'
1311      	6='Monitoring'
1312      	5='Coordination'
1313      	4='Treatment Navigation'
1314      	3='Support'
1315      	2='Prevention'
1316      	1='Engagement'
1317      ;
NOTE: Format categories output
1318      
1319      value RuleConfidence
1320      1= 0.933
1321      2= 0.6
1322      3= 0.667
1323      4= 0.865
1324      5= 0.667
1325      6= 0.667
1326      7= 0.851
1327      8= 0.727
1328      9= 0.75
1329      10= 0.765
51                                       The WPS System   12:31 Wednesday, October 24, 2018     

1330      11= 0.667
1331      12= 0.909
1332      13= 0.667
1333      ;
NOTE: Format RuleConfidence output
1334      
1335      
1336      *** sort the sample by ENROLID, it is needed for the last merge at the end;
NOTE: Procedure format step took :
      real time : 0.072
      cpu time  : 0.001


1337      proc sort data=temp.SamplewClassification;
1338      by enrolid;
1339      run;
NOTE: 1798 observations were read from "TEMP.SamplewClassification"
NOTE: Data set "TEMP.SamplewClassification" has 1798 observation(s) and 2 variable(s)
NOTE: Procedure sort step took :
      real time : 0.459
      cpu time  : 0.007


1340      
1341      *** convert NDCNUM to character;
1342      data temp.ChronicRx(drop=ndcnum_old);
1343      set temp.ChronicRx(rename=(ndcnum=ndcnum_old));
1344      NDCNUM=put(ndcnum_old,z11.);
1345      run;

NOTE: 58539 observations were read from "TEMP.ChronicRx"
NOTE: Data set "TEMP.ChronicRx" has 58539 observation(s) and 4 variable(s)
NOTE: The data step took :
      real time : 0.094
      cpu time  : 0.038


1346      
1347      *** creating a format for Acute/Chronic;
1348      data trash(keep=start label fmtname);
1349      set temp.GeneralAssignments;
1350      start=DxCat;
1351      label=Category;
1352      fmtname='$DxCatAssign';
1353      run;

NOTE: 565 observations were read from "TEMP.GeneralAssignments"
NOTE: Data set "WORK.trash" has 565 observation(s) and 3 variable(s)
NOTE: The data step took :
      real time : 0.026
      cpu time  : 0.001


52                                       The WPS System   12:31 Wednesday, October 24, 2018     

1354      proc format cntlin=trash; run;
NOTE: Format $DxCatAssign output
NOTE: 565 observations were read from "WORK.trash"
NOTE: Procedure format step took :
      real time : 0.043
      cpu time  : 0.002


1355      
1356      *** creating a format for Significant DxCat;
1357      data trash(keep=start label fmtname);
1358      set temp.SignificantConditions;
1359      start=DxCat;
1360      label=Significance;
1361      fmtname='$DxCatHigh';
1362      run;

NOTE: 296 observations were read from "TEMP.SignificantConditions"
NOTE: Data set "WORK.trash" has 296 observation(s) and 3 variable(s)
NOTE: The data step took :
      real time : 0.023
      cpu time  : 0.001


1363      proc format cntlin=trash; run;
NOTE: Format $DxCatHigh output
NOTE: 296 observations were read from "WORK.trash"
NOTE: Procedure format step took :
      real time : 0.019
      cpu time  : 0.001


1364      
1365      *** creating a format for Body Systems;
1366      data trash(keep=start label fmtname hlo);
1367      set temp.BodySystem end=end;
1368      start=DxCat;
1369      label=Body;
1370      fmtname='$DxCatBody';
1371      if end then do;
1372      	hlo='O';							/* for DxCats that are not in the map from Janet, just map them to '99
1372    ! '-Other */
1373      	label='99';
1374      end;
1375      run;

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      1373:8   
NOTE: 565 observations were read from "TEMP.BodySystem"
NOTE: Data set "WORK.trash" has 565 observation(s) and 4 variable(s)
NOTE: The data step took :
      real time : 0.020
53                                       The WPS System   12:31 Wednesday, October 24, 2018     

      cpu time  : 0.001


1376      proc format cntlin=trash; run;
NOTE: Format $DxCatBody output
NOTE: 565 observations were read from "WORK.trash"
NOTE: Procedure format step took :
      real time : 0.020
      cpu time  : 0.002


1377      
1378      *** creating a format for list of DxCat (based on Dx conditions) for Surveillance - Ac
1378    ! tive Cancer definition;
1379      data trash(keep=start label fmtname);
1380      set temp.SurvGeneralActiveCancerDxCat end=end;
1381      where Type='Dx';
1382      start=DxCat;
1383      label='Y';
1384      fmtname='$SurvActiveCancerDxcat';
1385      run;

NOTE: 76 observations were read from "TEMP.SurvGeneralActiveCancerDxCat"
NOTE: Data set "WORK.trash" has 76 observation(s) and 3 variable(s)
NOTE: The data step took :
      real time : 0.009
      cpu time  : 0.001


1386      proc format cntlin=trash; run;
NOTE: Format $SurvActiveCancerDxcat output
NOTE: 76 observations were read from "WORK.trash"
NOTE: Procedure format step took :
      real time : 0.005
      cpu time  : 0.000


1387      
1388      *** creating a format for list of DxCat (based on Px conditions) for Surveillance - Ac
1388    ! tive Cancer definition;
1389      data trash(keep=start label fmtname);
1390      set temp.SurvGeneralActiveCancerDxCat end=end;
1391      where Type='Px';
1392      start=DxCat;
1393      label='Y';
1394      fmtname='$SurvActiveCancerPxDxcat';
1395      run;

NOTE: 1 observations were read from "TEMP.SurvGeneralActiveCancerDxCat"
NOTE: Data set "WORK.trash" has 1 observation(s) and 3 variable(s)
NOTE: The data step took :
      real time : 0.025
      cpu time  : 0.001
54                                       The WPS System   12:31 Wednesday, October 24, 2018     



1396      proc format cntlin=trash; run;
NOTE: Format $SurvActiveCancerPxDxcat output
NOTE: 1 observations were read from "WORK.trash"
NOTE: Procedure format step took :
      real time : 0.018
      cpu time  : 0.000


1397      
1398      *** Modified ;
1399      *** creating a format for list of ProcGRP (based on Px conditions) for Surveillance - 
1399    ! Active Cancer definition;
1400      data trash(keep=start label fmtname);
1401      set temp.SurvGeneralActiveCancerPROCGRP end=end;
1402      start=PROCGRP;
1403      label='Y';
1404      *** fmtname='$SurvActiveCancerPROCGRP';
1405      fmtname='SurvActiveCancerPROCGRP';
1406      run;

NOTE: 25 observations were read from "TEMP.SurvGeneralActiveCancerPROCGRP"
NOTE: Data set "WORK.trash" has 25 observation(s) and 3 variable(s)
NOTE: The data step took :
      real time : 0.018
      cpu time  : 0.001


1407      proc format cntlin=trash; run;
NOTE: Format SurvActiveCancerPROCGRP output
NOTE: 25 observations were read from "WORK.trash"
NOTE: Procedure format step took :
      real time : 0.021
      cpu time  : 0.000


1408      
1409      
1410      *** summarize the inpatient data ***;
1411      ************************************;
1412      
1413      *** Modified ;
1414      *** get all the inpatient data from the matched IDs;
1415      PROC SQL;
1416      Create Table trash201 as select
1417      	a.enrolid,
1418      	a.pdxcat,
1419      	a.admdate,
1420      	a.disdate,
1421      	a.drg,
1422      	a.admtyp,
1423      	a.totpay,
55                                       The WPS System   12:31 Wednesday, October 24, 2018     

1424      	a.dstatus
1425      From
1426      	ccaei as a,
1427      	temp.SamplewClassification	as b
1428      Where
1429      	a.enrolid=b.enrolid
1430      Order by
1431      	a.enrolid,
1432      	a.admdate;
NOTE: Data set "WORK.trash201" has 60 observation(s) and 8 variable(s)
1433      
1434      *** bring in the chronic/acute info based on principal PDx;
1435      Create Table temp.SampleInp1 as select
1436      	a.*,
1437      	b.category
1438      From
1439      	trash201					as a
1440      Left Join
1441      	temp.GeneralAssignments		as b
1442      On
1443      	a.pdxcat=b.dxcat
1444      Order by
1445      	a.enrolid,
1446      	a.admdate;
NOTE: Data set "TEMP.SampleInp1" has 60 observation(s) and 9 variable(s)
1447      ;
1448      Quit;
NOTE: Procedure SQL step took :
      real time : 0.231
      cpu time  : 0.027


1449      
1450      
1451      /*** check some counts of patients/admissions in the data selected above;
1452      PROC SQL;
1453      select count (distinct enrolid) as count_ids from temp.SampleInp1;
1454      select mean(count_admits) as average_admits from (select enrolid format=15.0, count(di
1454    ! stinct admdate) as count_admits from temp.SampleInp1 group by enrolid);*/
1455      
1456      PROC SQL;
1457      *** count the unique(ENROLID+admdate) admits in the past 3 months;
1458      Create table work.trash202 as
1459      		Select
1460      			enrolid,
1461      			count(distinct admdate) as CountAdm3mAll
1462      		From
1463      			temp.SampleInp1
1464      		Where
1465      			admdate > &StartDate. - 90
1466      		Group By
1467      			enrolid;
NOTE: Data set "WORK.trash202" has 19 observation(s) and 2 variable(s)
56                                       The WPS System   12:31 Wednesday, October 24, 2018     

1468      
1469      *** count the unique(ENROLID+admdate) Chronic admits based on the principal PDx in the
1469    !  past 3 months;
1470      Create table work.trash203 as
1471      		Select
1472      			enrolid,
1473      			count(distinct admdate) as CountAdm3mChronic
1474      		From
1475      			temp.SampleInp1
1476      		Where
1477      			admdate > &StartDate. - 90 and
1478      			category='Chronic'
1479      		Group By
1480      			enrolid;
NOTE: Data set "WORK.trash203" has 8 observation(s) and 2 variable(s)
1481      
1482      *** count the uniqu(ENROLID+admdate) admits in the past 6 months;
1483      Create table work.trash204 as
1484      		Select
1485      			enrolid,
1486      			count(distinct admdate) as CountAdm6mAll
1487      		From
1488      			temp.SampleInp1
1489      		Where
1490      			admdate > &StartDate. - 180
1491      		Group By
1492      			enrolid;
NOTE: Data set "WORK.trash204" has 33 observation(s) and 2 variable(s)
1493      
1494      *** count the unique(ENROLID+admdate) Chronic admits based on the principal PDx in the
1494    !  past 6 months;
1495      Create table work.trash205 as
1496      		Select
1497      			enrolid,
1498      			count(distinct admdate) as CountAdm6mChronic
1499      		From
1500      			temp.SampleInp1
1501      		Where
1502      			admdate > &StartDate. - 180 and
1503      			category='Chronic'
1504      		Group By
1505      			enrolid;
NOTE: Data set "WORK.trash205" has 10 observation(s) and 2 variable(s)
1506      
1507      *** sum all LOS in the past 90 days;
1508      Create table work.trash206 as
1509      		Select
1510      			enrolid,
1511      			sum(disdate-admdate+1) as SumLOS3mAll
1512      		From
1513      			temp.SampleInp1
1514      		Where
1515      			admdate > &StartDate. - 90
57                                       The WPS System   12:31 Wednesday, October 24, 2018     

1516      		Group By
1517      			enrolid;
NOTE: Data set "WORK.trash206" has 19 observation(s) and 2 variable(s)
1518      
1519      *** Days to the last admission(admdate) in the past year;
1520      Create table work.trash207 as
1521      		Select
1522      			enrolid,
1523      			&StartDate. - max(admdate) as DaysAnyAdm
1524      		From
1525      			temp.SampleInp1
1526      		Group By
1527      			enrolid;
NOTE: Data set "WORK.trash207" has 56 observation(s) and 2 variable(s)
1528      
1529      *** Days to the last chronic admission(admdate) in the past year;
1530      Create table work.trash208 as
1531      		Select
1532      			enrolid,
1533      			&StartDate. - max(admdate) as DaysChronicAdm
1534      		From
1535      			temp.SampleInp1
1536      		Where
1537      			category='Chronic'
1538      		Group By
1539      			enrolid;
NOTE: Data set "WORK.trash208" has 21 observation(s) and 2 variable(s)
1540      
1541      *** Days to the last surgical admission(admdate) in the past year;
1542      Create table work.trash209 as
1543      		Select
1544      			enrolid,
1545      			&StartDate. - max(admdate) as DaysSurgAdm
1546      		From
1547      			temp.SampleInp1
1548      		Where
1549      			admtyp='1'
1550      		Group By
1551      			enrolid;
NOTE: Data set "WORK.trash209" has 9 observation(s) and 2 variable(s)
1552      
1553      *** Days to the last medical admission(admdate) in the past year;
1554      Create table work.trash210 as
1555      		Select
1556      			enrolid,
1557      			&StartDate. - max(admdate) as DaysMedicalAdm
1558      		From
1559      			temp.SampleInp1
1560      		Where
1561      			admtyp='2'
1562      		Group By
1563      			enrolid;
NOTE: Data set "WORK.trash210" has 20 observation(s) and 2 variable(s)
58                                       The WPS System   12:31 Wednesday, October 24, 2018     

1564      
1565      *** Days to the last maternity admission(admdate) in the past year;
1566      Create table work.trash211 as
1567      		Select
1568      			enrolid,
1569      			&StartDate. - max(admdate) as DaysMtrntyAdm
1570      		From
1571      			temp.SampleInp1
1572      		Where
1573      			admtyp='3'
1574      		Group By
1575      			enrolid;
NOTE: Data set "WORK.trash211" has 21 observation(s) and 2 variable(s)
1576      
1577      *** Days to the last mental health/substance abuse admission(admdate) in the past year
1577    ! ;
1578      Create table work.trash212 as
1579      		Select
1580      			enrolid,
1581      			&StartDate. - max(admdate) as DaysMHSAAdm
1582      		From
1583      			temp.SampleInp1
1584      		Where
1585      			admtyp='4'
1586      		Group By
1587      			enrolid;
NOTE: Data set "WORK.trash212" has 7 observation(s) and 2 variable(s)
1588      
1589      Quit;
NOTE: Procedure SQL step took :
      real time : 0.176
      cpu time  : 0.014


1590      
1591      *** put all the inpatient related variables together;
1592      DATA
1593      	work.trash213;
1594      Merge
1595      	trash202(in=a)
1596      	trash203(in=b)
1597      	trash204(in=c)
1598      	trash205(in=d)
1599      	trash206(in=e)
1600      	trash207(in=f)
1601      	trash208(in=g)
1602      	trash209(in=h)
1603      	trash210(in=i)
1604      	trash211(in=j)
1605      	trash212(in=k);
1606      By
1607      	enrolid;
1608      If
59                                       The WPS System   12:31 Wednesday, October 24, 2018     

1609      	a or b or c or d or e or f or g or h or i or j or k;
1610      run;

NOTE: 19 observations were read from "WORK.trash202"
NOTE: 8 observations were read from "WORK.trash203"
NOTE: 33 observations were read from "WORK.trash204"
NOTE: 10 observations were read from "WORK.trash205"
NOTE: 19 observations were read from "WORK.trash206"
NOTE: 56 observations were read from "WORK.trash207"
NOTE: 21 observations were read from "WORK.trash208"
NOTE: 9 observations were read from "WORK.trash209"
NOTE: 20 observations were read from "WORK.trash210"
NOTE: 21 observations were read from "WORK.trash211"
NOTE: 7 observations were read from "WORK.trash212"
NOTE: Data set "WORK.trash213" has 56 observation(s) and 12 variable(s)
NOTE: The data step took :
      real time : 0.022
      cpu time  : 0.003


1611      
1612      *** Merge with the original Sample and use counts of zero when no admissions;
1613      PROC SQL;
1614      Create Table temp.IP as
1615      Select
1616      	a.enrolid,
1617      	max(0,b.CountAdm3mAll)			as CountAdm3mAll,
1618      	max(0,b.CountAdm3mChronic)		as CountAdm3mChronic,
1619      	max(0,b.CountAdm6mAll)			as CountAdm6mAll,
1620      	max(0,b.CountAdm6mChronic)		as CountAdm6mChronic,
1621      	max(0,b.SumLOS3mAll)			as SumLOS3mAll,
1622      	min(365,DaysAnyAdm)				as DaysAnyAdm,
1623      	min(365,DaysChronicAdm)			as DaysChronicAdm,
1624      	min(365,DaysSurgAdm)			as DaysSurgAdm,
1625      	min(365,DaysMedicalAdm)			as DaysMedicalAdm,
1626      	min(365,DaysMtrntyAdm)			as DaysMtrntyAdm,
1627      	min(365,DaysMHSAAdm)			as DaysMHSAAdm
1628      From
1629      	(Select distinct enrolid from temp.SamplewClassification) as a
1630      Left Join
1631      	work.trash213 as b
1632      On
1633      	a.enrolid=b.enrolid
1634      Order by
1635      	a.enrolid;
NOTE: View opening spill file for output observations.
NOTE: Data set "TEMP.IP" has 1798 observation(s) and 12 variable(s)
1636      
1637      
1638      *** summarize the drugs data ***;
1639      ********************************;
1640      
1641      *** Modified ;
60                                       The WPS System   12:31 Wednesday, October 24, 2018     

1642      *** get all the drugs data from the matched IDs;
NOTE: Procedure SQL step took :
      real time : 0.259
      cpu time  : 0.038


1643      PROC SQL;
1644      Create Table trash301 as select distinct
1645      	a.enrolid,
1646      	a.svcdate,
1647      	a.daysupp,
1648      	a.ndcnum,
1649      	a.generid,
1650      	a.thercls,
1651      	a.pay
1652      From
1653      	ccaed as a,
1654      	temp.SamplewClassification	as b
1655      Where
1656      	a.enrolid=b.enrolid
1657      Order by
1658      	a.enrolid,
1659      	a.svcdate;
NOTE: Data set "WORK.trash301" has 14885 observation(s) and 7 variable(s)
1660      
1661      *** bring in the maintenance flag for the Rx based on metadata table;
1662      Create Table temp.SampleRx1 as select
1663      	a.*,
1664      	b.category
1665      From
1666      	trash301			as a
1667      Left Join
1668      	temp.ChronicRx		as b
1669      On
1670      	a.ndcnum=b.ndcnum
1671      Order by
1672      	a.enrolid,
1673      	a.svcdate;
NOTE: Data set "TEMP.SampleRx1" has 14885 observation(s) and 8 variable(s)
1674      ;
1675      Quit;
NOTE: Procedure SQL step took :
      real time : 0.787
      cpu time  : 0.231


1676      
1677      
1678      /*** check some counts of patients/drugs in the data selected above;
1679      PROC SQL;
1680      select count (distinct enrolid) as count_ids from temp.SampleRx1;
1681      select mean(count_drugs) as average_drugs from (select enrolid format=15.0, count(dist
1681    ! inct ndcnum) as count_drugs from temp.SampleRx1 group by enrolid);*/
61                                       The WPS System   12:31 Wednesday, October 24, 2018     

1682      
1683      *** count of maintenance drugs 1 year;
1684      proc sql;
1685      Create View work.trash302 as
1686      		Select
1687      			enrolid,
1688      			max((category="Maintenance")) as FlagChronicRx
1689      		From
1690      			temp.SampleRx1
1691      		Group By
1692      			enrolid;
NOTE: View WORK.trash302 successfully created
1693      
1694      
1695      *** count of the new maintenance drugs in the past 90 days where no drugs in same ther
1695    ! cls is found before;
NOTE: Procedure sql step took :
      real time : 0.022
      cpu time  : 0.000


1696      proc sql;
1697      Create View work.trash3031 as
1698      		Select
1699      			enrolid,
1700      			thercls,
1701      			min(svcdate) as dateafter format=date10.
1702      		From
1703      			temp.SampleRx1
1704      		Where
1705      			category="Maintenance"	and
1706      			svcdate > &StartDate.-90
1707      		Group by
1708      			enrolid,
1709      			thercls;
NOTE: View WORK.trash3031 successfully created
1710      
1711      Create View work.trash3032 as
1712      		Select distinct
1713      			enrolid,
1714      			thercls,
1715      			max(svcdate) as datebefore format=date10.
1716      		From
1717      			temp.SampleRx1
1718      		Where
1719      			category="Maintenance"	and
1720      			svcdate <= &StartDate.-90
1721      		Group by
1722      			enrolid,
1723      			thercls;
NOTE: View WORK.trash3032 successfully created
1724      
1725      Create View work.trash303 as
62                                       The WPS System   12:31 Wednesday, October 24, 2018     

1726      		Select
1727      			a.enrolid,
1728      			max((a.thercls^=b.thercls))			as	FlagNewChronicRx
1729      		From
1730      			work.trash3031 as a
1731      		Left Join
1732      			work.trash3032 as b
1733      		On
1734      			a.enrolid=b.enrolid and
1735      			a.thercls=b.thercls
1736      		Group by
1737      			a.enrolid;
NOTE: View WORK.trash303 successfully created
1738      
1739      *** count of days supply in the past 90/180 days;
NOTE: Procedure sql step took :
      real time : 0.072
      cpu time  : 0.002


1740      proc sql;
1741      Create View work.trash304 as
1742      		Select
1743      			enrolid,
1744      			sum(daysupp*(svcdate > &StartDate.-90)) 							as CountDaysSupp3m,
1745      			sum(daysupp*(svcdate > &StartDate.-180))							as CountDaysSupp6m,
1746      			sum(daysupp*(svcdate > &StartDate.-90) *(category="Maintenance")) 	as CountDaysSupp
1746    ! Chronic3m,
1747      			sum(daysupp*(svcdate > &StartDate.-180)*(category="Maintenance")) 	as CountDaysSupp
1747    ! Chronic6m,
1748      			sum(daysupp*(svcdate > &StartDate.-90) * max(thercls in (&OpiatesTCLS.),generid in 
1748    ! (&OpiatesGNID.))) 	as CountDaysSuppOpiates3m,
1749      			sum(daysupp*(svcdate > &StartDate.-180)* max(thercls in (&OpiatesTCLS.),generid in 
1749    ! (&OpiatesGNID.))) 	as CountDaysSuppOpiates6m
1750      		From
1751      			temp.SampleRx1
1752      		Group by
1753      			enrolid;
NOTE: View WORK.trash304 successfully created
1754      
1755      *** count of unique all/maintenance(Chronic) therapeutic classes  in the past 90/180 d
1755    ! ays;
NOTE: Procedure sql step took :
      real time : 0.033
      cpu time  : 0.001


1756      proc sql;
1757      Create View work.trash305 as
1758      		Select
1759      			enrolid,
1760      			count(distinct thercls)		as CountTherClass3m
1761      		From
63                                       The WPS System   12:31 Wednesday, October 24, 2018     

1762      			temp.SampleRx1
1763      		Where
1764      			svcdate > &StartDate.-90
1765      		Group by
1766      			enrolid;
NOTE: View WORK.trash305 successfully created
NOTE: Procedure sql step took :
      real time : 0.028
      cpu time  : 0.000


1767      
1768      proc sql;
1769      Create View work.trash306 as
1770      		Select
1771      			enrolid,
1772      			count(distinct thercls)		as CountTherClass6m
1773      		From
1774      			temp.SampleRx1
1775      		Where
1776      			svcdate > &StartDate.-180
1777      		Group by
1778      			enrolid;
NOTE: View WORK.trash306 successfully created
NOTE: Procedure sql step took :
      real time : 0.024
      cpu time  : 0.000


1779      
1780      proc sql;
1781      Create View work.trash307 as
1782      		Select
1783      			enrolid,
1784      			count(distinct thercls)		as CountTherClassChronic3m
1785      		From
1786      			temp.SampleRx1
1787      		Where
1788      			svcdate > &StartDate.-90	and
1789      			category="Maintenance"
1790      		Group by
1791      			enrolid;
NOTE: View WORK.trash307 successfully created
NOTE: Procedure sql step took :
      real time : 0.033
      cpu time  : 0.000


1792      
1793      proc sql;
1794      Create View work.trash308 as
1795      		Select
1796      			enrolid,
64                                       The WPS System   12:31 Wednesday, October 24, 2018     

1797      			count(distinct thercls)		as CountTherClassChronic6m
1798      		From
1799      			temp.SampleRx1
1800      		Where
1801      			svcdate > &StartDate.-180	and
1802      			category="Maintenance"
1803      		Group by
1804      			enrolid;
NOTE: View WORK.trash308 successfully created
1805      
1806      *** put all the drugs related variables together;
NOTE: Procedure sql step took :
      real time : 0.025
      cpu time  : 0.001


1807      DATA
1808      	work.trash311;
1809      Merge
1810      	trash302(in=a)
1811      	trash303(in=b)
1812      	trash304(in=c)
1813      	trash305(in=d)
1814      	trash306(in=e)
1815      	trash307(in=f)
1816      	trash308(in=g);
1817      By
1818      	enrolid;
1819      If
1820      	a or b or c or d or e or f or g;
1821      run;

NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: 1134 observations were read from "WORK.trash302"
NOTE: 499 observations were read from "WORK.trash303"
NOTE: 1134 observations were read from "WORK.trash304"
NOTE: 825 observations were read from "WORK.trash305"
NOTE: 966 observations were read from "WORK.trash306"
NOTE: 499 observations were read from "WORK.trash307"
NOTE: 553 observations were read from "WORK.trash308"
NOTE: Data set "WORK.trash311" has 1134 observation(s) and 13 variable(s)
NOTE: The data step took :
      real time : 0.548
      cpu time  : 0.068

65                                       The WPS System   12:31 Wednesday, October 24, 2018     


1822      
1823      *** Merge with the original Sample and use counts of zero when no admissions;
1824      PROC SQL;
1825      Create Table temp.Rx as
1826      Select
1827      	a.enrolid,
1828      	max(0,b.FlagChronicRx)				as FlagChronicRx,
1829      	max(0,b.FlagNewChronicRx)			as FlagNewChronicRx,
1830      	max(0,b.CountDaysSupp3m)			as CountDaysSupp3m,
1831      	max(0,b.CountDaysSupp6m)			as CountDaysSupp6m,
1832      	max(0,b.CountDaysSuppChronic3m)		as CountDaysSuppChronic3m,
1833      	max(0,b.CountDaysSuppChronic6m)		as CountDaysSuppChronic6m,
1834      	max(0,b.CountDaysSuppOpiates3m)		as CountDaysSuppOpiates3m,
1835      	max(0,b.CountDaysSuppOpiates6m)		as CountDaysSuppOpiates6m,
1836      	max(0,b.CountTherClass3m)			as CountTherClass3m,
1837      	max(0,b.CountTherClass6m)			as CountTherClass6m,
1838      	max(0,b.CountTherClassChronic3m)	as CountTherClassChronic3m,
1839      	max(0,b.CountTherClassChronic6m)	as CountTherClassChronic6m
1840      From
1841      	(Select distinct enrolid from temp.SamplewClassification) as a
1842      Left Join
1843      	work.trash311 as b
1844      On
1845      	a.enrolid=b.enrolid
1846      Order by
1847      	a.enrolid;
NOTE: View opening spill file for output observations.
NOTE: Data set "TEMP.Rx" has 1798 observation(s) and 13 variable(s)
1848      
1849      
1850      *** PROC PRINT DATA=temp.Rx(OBS=40);RUN;
NOTE: RUN has no effect in proc sql as all statements are executed immediately.
1851      
1852      *** summarize the diagnosis from both OP+IP data ***;
1853      ****************************************************;
1854      
1855      *** Modified ;
1856      *** prepare the data for AE;
1857      *** get all the inpatient and outpatient data from the matched IDs and the variables n
1857    ! eeded to run DS in Analytics Engine;
NOTE: Procedure SQL step took :
      real time : 0.285
      cpu time  : 0.040


1858      PROC SQL;
1859      Create Table trash401 as select
1860      	a.enrolid 														as patient_id,
1861      	'F' 															as fac_prof,
1862      	'I'||strip(put(a.seqnum,15.)) 									as record_identifier,
1863      	a.age 															as age,
1864      	case a.sex when '1' then 'M' when '2' then 'F' else ' ' end 	as sex,
66                                       The WPS System   12:31 Wednesday, October 24, 2018     

1865      	a.proc1 														as icd_proc1,
1866      	'9' 															as icd_flag,
1867      	a.dx1 															as dx1,
1868      	a.dx2 															as dx2,
1869      	a.dx3 															as dx3,
1870      	a.dx4 															as dx4,
1871      	'I' 															as rec_type,
1872      	' ' 															as std_place,
1873      	admtyp															as custom1,
1874      	svcscat 														as custom2,
1875      	svcdate															as custom3
1876      From
1877      	ccaes as a,
1878      	temp.SamplewClassification	as b
1879      Where
1880      	a.enrolid=b.enrolid
1881      Order by
1882      	patient_id,
1883      	record_identifier;
NOTE: Data set "WORK.trash401" has 1673 observation(s) and 16 variable(s)
1884      ;
1885      
1886      *** Modified ;
1887      Create Table trash402 as select
1888      	a.enrolid 														as patient_id,
1889      	a.facprof														as fac_prof,
1890      	'O'||strip(put(a.seqnum,15.)) 									as record_identifier,
1891      	a.age 															as age,
1892      	case a.sex when '1' then 'M' when '2' then 'F' else ' ' end 	as sex,
1893      	a.proc1 														as icd_proc1,
1894      	'9' 															as icd_flag,
1895      	a.dx1 															as dx1,
1896      	a.dx2 															as dx2,
1897      	a.dx3 															as dx3,
1898      	a.dx4 															as dx4,
1899      	'O' 															as rec_type,
1900      	' ' 															as std_place,
1901      	' '																as custom1,
1902      	svcscat 														as custom2,
1903      	svcdate															as custom3
1904      From
1905      	ccaeo as a,
1906      	temp.SamplewClassification	as b
1907      Where
1908      	a.enrolid=b.enrolid
1909      Order by
1910      	patient_id,
1911      	record_identifier;
NOTE: Data set "WORK.trash402" has 32490 observation(s) and 16 variable(s)
1912      ;
1913      
1914      
1915      *** put together inp and outpatient data and sort and dedup (for DS we need unique pat
67                                       The WPS System   12:31 Wednesday, October 24, 2018     

1915    ! ient/eventIDs;
NOTE: Procedure SQL step took :
      real time : 1.851
      cpu time  : 1.032


1916      data temp.IPandOPforAE; set trash401 trash402; by patient_id record_identifier; run;

NOTE: 1673 observations were read from "WORK.trash401"
NOTE: 32490 observations were read from "WORK.trash402"
NOTE: Data set "TEMP.IPandOPforAE" has 34163 observation(s) and 16 variable(s)
NOTE: The data step took :
      real time : 0.081
      cpu time  : 0.027


1917      proc sort data=temp.IPandOPforAE nodupkey; by patient_id record_identifier; run;
NOTE: 34163 observations were read from "TEMP.IPandOPforAE"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "TEMP.IPandOPforAE" has 34163 observation(s) and 16 variable(s)
NOTE: Procedure sort step took :
      real time : 0.126
      cpu time  : 0.061


1918      
1919      *** export data into csv;
1920      proc export
1921      	data=temp.IPandOPforAE
1922      	outfile="&AEoutpath./&version..csv"
1923      	replace;
1924      run;
NOTE: Procedure export step took :
      real time : 0.001
      cpu time  : 0.000


1925      data _null_;
1926        file '/rpscan/u071366/POPSTRATIFICATION/AEout/31DEC2015MarketScanSample/31DEC2015Mar
1926    ! ketScanSample.csv' delimiter=',' DSD DROPOVER LRECL=186;
1927        format patient_id BEST12.;
1928        format fac_prof $1.;
1929        format record_identifier $16.;
1930        format age BEST12.;
1931        format sex $1.;
1932        format icd_proc1 $7.;
1933        format icd_flag $1.;
1934        format dx1 $7.;
1935        format dx2 $7.;
1936        format dx3 $7.;
1937        format dx4 $7.;
1938        format rec_type $1.;
1939        format std_place $1.;
68                                       The WPS System   12:31 Wednesday, October 24, 2018     

1940        format custom1 $1.;
1941        format custom2 $5.;
1942        format custom3 MMDDYY10.;
1943        if _n_=1 then do;
1944            put
1945               'patient_id'        ','
1946               'fac_prof'        ','
1947               'record_identifier'        ','
1948               'age'        ','
1949               'sex'        ','
1950               'icd_proc1'        ','
1951               'icd_flag'        ','
1952               'dx1'        ','
1953               'dx2'        ','
1954               'dx3'        ','
1955               'dx4'        ','
1956               'rec_type'        ','
1957               'std_place'        ','
1958               'custom1'        ','
1959               'custom2'        ','
1960               'custom3';
1961          end;
1962        set temp.IPandOPforAE;
1963        put patient_id @;
1964        put fac_prof @;
1965        put record_identifier @;
1966        put age @;
1967        put sex @;
1968        put icd_proc1 @;
1969        put icd_flag @;
1970        put dx1 @;
1971        put dx2 @;
1972        put dx3 @;
1973        put dx4 @;
1974        put rec_type @;
1975        put std_place @;
1976        put custom1 @;
1977        put custom2 @;
1978        put custom3;
1979      run;

NOTE: The file
      '/rpscan/u071366/POPSTRATIFICATION/AEout/31DEC2015MarketScanSample/31DEC2015MarketScanSamp
      le.csv' is:
      File
      Name=/rpscan/u071366/POPSTRATIFICATION/AEout/31DEC2015MarketScanSample/31DEC2015MarketScan
      Sample.csv,
      Access Permissions=-rw-rw-r--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=0, Last Modified=12:32:28 Oct 24 2018,
      Created=12:32:28 Oct 24 2018, Lrecl=186, Recfm=V

NOTE: 34164 records were written to file
69                                       The WPS System   12:31 Wednesday, October 24, 2018     

      '/rpscan/u071366/POPSTRATIFICATION/AEout/31DEC2015MarketScanSample/31DEC2015MarketScanSamp
      le.csv'
      The minimum record length was 56
      The maximum record length was 123
NOTE: 34163 observations were read from "TEMP.IPandOPforAE"
NOTE: The data step took :
      real time : 0.278
      cpu time  : 0.149


1980      FILENAME ##EXPOUT CLEAR;
1981      
1982      
1983      *** setup the Configfile.properties for AE;
1984      filename AEconfig "&AEoutpath./Configfile.properties";
1985      data _null_;
1986      file AEconfig;
1987      put "-m:DiseaseStaging";
1988      put "-f:&AEoutpath./&version..csv";
1989      put "-o:&AEoutpath.";
1990      run;

NOTE: The file AEconfig is:
      File
      Name=/rpscan/u071366/POPSTRATIFICATION/AEout/31DEC2015MarketScanSample/Configfile.properti
      es,
      Access Permissions=-rw-rw-r--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=0, Last Modified=12:32:28 Oct 24 2018,
      Created=12:32:28 Oct 24 2018, Lrecl=256, Recfm=V

NOTE: 3 records were written to file AEconfig
      The minimum record length was 17
      The maximum record length was 98
NOTE: The data step took :
      real time : 0.017
      cpu time  : 0.003


1991      
1992      
1993      /* import AE back into the data */
1994      data temp.SampleIPOPwDS1;
1995      	infile "&AEoutpath./&username._DISEASESTAGING6.34_&version._Dsoutput.csv"
1996      	delimiter = ','
1997      	MISSOVER
1998      	DSD
1999      	lrecl=32767
2000      	firstobs=2;
2001      input
2002                        enrolid
2003                        fac_prof :$1.
2004                        eventid :$16.
70                                       The WPS System   12:31 Wednesday, October 24, 2018     

2005                        age
2006                        sex :$1.
2007                        proc1 :$7.
2008                        icd_flag :$1.
2009                        dx1 :$7.
2010                        dx2 :$7.
2011                        dx3 :$7.
2012                        dx4 :$7.
2013                        rec_type :$1.
2014                        std_place :$1.
2015      				  admtyp :$1.
2016      				  svcscat :$5.
2017      				  svcdate :mmddyy10.
2018                        dxcat1 :$5.
2019                        dxcat2 :$5.
2020                        dxcat3 :$5.
2021                        dxcat4 :$5.
2022                        dxstage1
2023                        dxstage2
2024                        dxstage3
2025                        dxstage4
2026      ;
2027      format svcdate mmddyy10.;
2028      run;

NOTE: The file
      '/rpscan/u071366/POPSTRATIFICATION/AEout/31DEC2015MarketScanSample/u071366_DISEASESTAGING6
      .34_31DEC2015MarketScanSample_Dsoutput.csv' is:
      File
      Name=/rpscan/u071366/POPSTRATIFICATION/AEout/31DEC2015MarketScanSample/u071366_DISEASESTAG
      ING6.34_31DEC2015MarketScanSample_Dsoutput.csv,
      Access Permissions=-rw-r--r--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=3100854, Last Modified=12:18:02 Oct 19 2018,
      Created=12:18:02 Oct 19 2018, Lrecl=32767, Recfm=V

NOTE: 34163 records were read from file
      '/rpscan/u071366/POPSTRATIFICATION/AEout/31DEC2015MarketScanSample/u071366_DISEASESTAGING6
      .34_31DEC2015MarketScanSample_Dsoutput.csv'
      The minimum record length was 68
      The maximum record length was 126
NOTE: Data set "TEMP.SampleIPOPwDS1" has 34163 observation(s) and 24 variable(s)
NOTE: The data step took :
      real time : 0.417
      cpu time  : 0.164


2029      
2030      
2031      *** flag the patients with MHSA and maternity history;
2032      proc sql;
2033      create view trash501 as select
2034      	enrolid,
71                                       The WPS System   12:31 Wednesday, October 24, 2018     

2035      	max(
2036      				(admtyp='4'	 				or
2037      				dxcat1 in (&SvcCatMHSA.)	or
2038      				dxcat2 in (&SvcCatMHSA.)	or
2039      				dxcat3 in (&SvcCatMHSA.)	or
2040      				dxcat4 in (&SvcCatMHSA.))
2041      		)												as flag12mMHSA,
2042      	max(		
2043      				(svcdate > &StartDate.-90)		and
2044      				(dxcat1 in (&SvcCatGYN.)	or
2045      				 dxcat2 in (&SvcCatGYN.)	or
2046      				 dxcat3 in (&SvcCatGYN.)	or
2047      				 dxcat4 in (&SvcCatGYN.))
2048      		)												as flag3mGYN
2049      from
2050      	temp.SampleIPOPwDS1
2051      group by
2052      	enrolid;
NOTE: View WORK.trash501 successfully created
2053      
2054      *** create the flags for all the DxCats that satisfy the conditions for Acute/Chrnic/S
2054    ! tage>3/HighSignificance;
NOTE: Procedure sql step took :
      real time : 0.054
      cpu time  : 0.001


2055      data trash502(keep=
2056      				enrolid
2057      				svcdate flag3mStage3
2058      				dxcat flag3mAcuteStage3 flag3mChronicStage3 flag6mChronicStage3 flag3mAcuteSign fl
2058    ! ag3mChronicSign flag6mChronicSign flag12mChronicSign flag3mAcute flag6mAcute flag3mChr
2058    ! onic flag12mChronic
2059      				body flag3mBody flag3mBodySign
2060      				flagNew3mChronicSign flagNew12mChronicSign);
2061      set temp.SampleIPOPwDS1;
2062      length dxcat $5. body $2.;
2063      array dxarray dxcat1-dxcat4;
2064      array dxstage dxstage1-dxstage4;
2065      	do i=1 to 4;
2066      		dxcat=' '; body=' ';
2067      /* flags for days with Stage3 */
2068      		if svcdate > &StartDate.-90  and dxstage[i] ge 3 and
2069      			^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&Pr
2069    ! ocExclusionList.)))
2070      		then do; dxcat=dxarray[i]; flag3mStage3=1;   end;
2071      /* flags for DxCat counts */
2072      		if svcdate > &StartDate.-90  and put(dxarray[i],$DxCatAssign.)='Acute' and dxstage[i
2072    ! ] ge 3 and
2073      			^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&Pr
2073    ! ocExclusionList.)))
2074      		then do; dxcat=dxarray[i]; flag3mAcuteStage3=1; end;
2075      		if svcdate > &StartDate.-90  and put(dxarray[i],$DxCatAssign.)='Chronic' and dxstage
72                                       The WPS System   12:31 Wednesday, October 24, 2018     

2075    ! [i] ge 3 and
2076      		   	^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (
2076    ! &ProcExclusionList.)))
2077      		then do; dxcat=dxarray[i]; flag3mChronicStage3=1; end;
2078      		if svcdate > &StartDate.-180 and put(dxarray[i],$DxCatAssign.)='Chronic' and dxstage
2078    ! [i] ge 3 and
2079      		   	^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (
2079    ! &ProcExclusionList.)))
2080      		then do; dxcat=dxarray[i]; flag6mChronicStage3=1; end;
2081      		if svcdate > &StartDate.-90  and put(dxarray[i],$DxCatAssign.)='Acute'   and put(dxa
2081    ! rray[i],$DxCatHigh.)='High' and
2082      			^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&Pr
2082    ! ocExclusionList.)))
2083      		then do; dxcat=dxarray[i]; flag3mAcuteSign=1;   end;
2084      		if svcdate > &StartDate.-90  and put(dxarray[i],$DxCatAssign.)='Chronic' and put(dxa
2084    ! rray[i],$DxCatHigh.)='High' and
2085      			^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&Pr
2085    ! ocExclusionList.)))
2086      		then do; dxcat=dxarray[i]; flag3mChronicSign=1; end;
2087      		if svcdate > &StartDate.-180 and put(dxarray[i],$DxCatAssign.)='Chronic' and put(dxa
2087    ! rray[i],$DxCatHigh.)='High' and
2088      			^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&Pr
2088    ! ocExclusionList.)))
2089      		then do; dxcat=dxarray[i]; flag6mChronicSign=1; end;
2090      		if svcdate > &StartDate.-366 and put(dxarray[i],$DxCatAssign.)='Chronic' and put(dxa
2090    ! rray[i],$DxCatHigh.)='High' and
2091      			^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&Pr
2091    ! ocExclusionList.)))
2092      		then do; dxcat=dxarray[i]; flag12mChronicSign=1; end;
2093      		if svcdate > &StartDate.-90  and put(dxarray[i],$DxCatAssign.)='Acute' and
2094      			^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&Pr
2094    ! ocExclusionList.)))
2095      		then do; dxcat=dxarray[i]; flag3mAcute=1;   end;
2096      		if svcdate > &StartDate.-180 and put(dxarray[i],$DxCatAssign.)='Acute'  and
2097      			^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&Pr
2097    ! ocExclusionList.)))
2098      		then do; dxcat=dxarray[i]; flag6mAcute=1;   end;
2099      		if svcdate > &StartDate.-90  and put(dxarray[i],$DxCatAssign.)='Chronic' and
2100      			^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&Pr
2100    ! ocExclusionList.)))
2101      		then do; dxcat=dxarray[i]; flag3mChronic=1; end;
2102      		if svcdate > &StartDate.-366 and put(dxarray[i],$DxCatAssign.)='Chronic' and
2103      			^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&Pr
2103    ! ocExclusionList.)))
2104      		then do; dxcat=dxarray[i]; flag12mChronic=1; end;
2105      /* flags for body counts */
2106      		if svcdate > &StartDate.-90 and missing(dxarray[i])=0 				then do; body=put(dxarray[
2106    ! i],$DxCatBody.); flag3mBody=1; dxcat=dxarray[i]; end;
2107      		if svcdate > &StartDate.-90 and put(dxarray[i],$DxCatHigh.)='High' 	then do; body=pu
2107    ! t(dxarray[i],$DxCatBody.); flag3mBodySign=1; end;
2108      /* flags for new chronic significant condition */
2109      		if svcdate > &StartDate.-90  and put(dxarray[i],$DxCatAssign.)='Chronic' and put(dxa
2109    ! rray[i],$DxCatHigh.)='High' and
73                                       The WPS System   12:31 Wednesday, October 24, 2018     

2110      		   ^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&
2110    ! ProcExclusionList.)))
2111      		then do; dxcat=dxarray[i]; flagNew3mChronicSign=1; end;
2112      		if &StartDate.-366 < svcdate <= &StartDate.-90  and put(dxarray[i],$DxCatAssign.)='C
2112    ! hronic' and put(dxarray[i],$DxCatHigh.)='High' and
2113      		   ^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&
2113    ! ProcExclusionList.)))
2114      		then do; dxcat=dxarray[i]; flagNew12mChronicSign=1; end;
2115      		if missing(dxcat)=0 or missing(body)=0 then output;
2116      	end;
2117      run;

NOTE: 34163 observations were read from "TEMP.SampleIPOPwDS1"
NOTE: Data set "WORK.trash502" has 14294 observation(s) and 20 variable(s)
NOTE: The data step took :
      real time : 0.982
      cpu time  : 0.486


2118      
2119      *** count the unique DxCats for different combinations of Acute/Chronic/Sign/3m/6m/eac
2119    ! h, it's using the flags defined in the previous step;
2120      proc sql;
2121      create view trash503 as select
2122      	enrolid,
2123      	count(distinct dxcat) as Count3mAcuteStage3
2124      from trash502
2125      where flag3mAcuteStage3=1
2126      group by enrolid;
NOTE: View WORK.trash503 successfully created
2127      
2128      create view trash504 as select
2129      	enrolid,
2130      	count(distinct dxcat) as Count3mChronicStage3
2131      from trash502
2132      where flag3mChronicStage3=1
2133      group by enrolid;
NOTE: View WORK.trash504 successfully created
2134      
2135      create view trash505 as select
2136      	enrolid,
2137      	count(distinct dxcat) as Count6mChronicStage3
2138      from trash502
2139      where flag6mChronicStage3=1
2140      group by enrolid;
NOTE: View WORK.trash505 successfully created
2141      
2142      create view trash506 as select
2143      	enrolid,
2144      	count(distinct dxcat) as Count3mAcuteSign
2145      from trash502
2146      where flag3mAcuteSign=1
2147      group by enrolid;
74                                       The WPS System   12:31 Wednesday, October 24, 2018     

NOTE: View WORK.trash506 successfully created
2148      
2149      create view trash507 as select
2150      	enrolid,
2151      	count(distinct dxcat) as Count3mChronicSign
2152      from trash502
2153      where flag3mChronicSign=1
2154      group by enrolid;
NOTE: View WORK.trash507 successfully created
2155      
2156      create view trash508 as select
2157      	enrolid,
2158      	count(distinct dxcat) as Count6mChronicSign
2159      from trash502
2160      where flag6mChronicSign=1
2161      group by enrolid;
NOTE: View WORK.trash508 successfully created
2162      
2163      create view trash508_1 as select
2164      	enrolid,
2165      	count(distinct dxcat) as Count12mChronicSign
2166      from trash502
2167      where flag12mChronicSign=1
2168      group by enrolid;
NOTE: View WORK.trash508_1 successfully created
2169      
2170      create view trash509 as select
2171      	enrolid,
2172      	count(distinct dxcat) as Count3mAcute
2173      from trash502
2174      where flag3mAcute=1
2175      group by enrolid;
NOTE: View WORK.trash509 successfully created
2176      
2177      create view trash510 as select
2178      	enrolid,
2179      	count(distinct dxcat) as Count6mAcute
2180      from trash502
2181      where flag6mAcute=1
2182      group by enrolid;
NOTE: View WORK.trash510 successfully created
2183      
2184      create view trash511 as select
2185      	enrolid,
2186      	count(distinct dxcat) as Count3mChronic
2187      from trash502
2188      where flag3mChronic=1
2189      group by enrolid;
NOTE: View WORK.trash511 successfully created
2190      
2191      create view trash512 as select
2192      	enrolid,
2193      	count(distinct dxcat) as Count12mChronic
75                                       The WPS System   12:31 Wednesday, October 24, 2018     

2194      from trash502
2195      where flag12mChronic=1
2196      group by enrolid;
NOTE: View WORK.trash512 successfully created
2197      
2198      *** count the unique Body systems;
2199      create view trash513 as select
2200      	enrolid,
2201      	count(distinct body) as Count3mBody
2202      from trash502
2203      where flag3mBody=1
2204      group by enrolid;
NOTE: View WORK.trash513 successfully created
2205      
2206      create view trash514 as select
2207      	enrolid,
2208      	count(distinct body) as Count3mBodySign
2209      from trash502
2210      where flag3mBodySign=1
2211      group by enrolid;
NOTE: View WORK.trash514 successfully created
2212      
2213      *** create flag for new significant chronic condition;
NOTE: Procedure sql step took :
      real time : 0.192
      cpu time  : 0.008


2214      proc sql;
2215      create view trash515 as select distinct
2216      	a.enrolid,
2217      	1 as flag3mNewChronicSign
2218      from
2219      	trash502(where=(flagNew3mChronicSign=1)) as a
2220      left join
2221      	trash502(where=(flagNew12mChronicSign=1)) as b
2222      on
2223      	a.enrolid=b.enrolid and a.dxcat=b.dxcat
2224      where
2225      	a.dxcat ne b.dxcat;
NOTE: View WORK.trash515 successfully created
2226      
2227      *** create flag for number of days with Stage3 within last 3m;
NOTE: Procedure sql step took :
      real time : 0.012
      cpu time  : 0.000


2228      proc sql;
2229      create view trash516 as select
2230      	enrolid,
2231      	count(distinct svcdate) as Days3mStage3
2232      from trash502
76                                       The WPS System   12:31 Wednesday, October 24, 2018     

2233      where flag3mStage3=1
2234      group by enrolid;
NOTE: View WORK.trash516 successfully created
2235      
2236      *** put all the DxCat related variables from IP and OP claims together;
NOTE: Procedure sql step took :
      real time : 0.031
      cpu time  : 0.000


2237      DATA
2238      	trash531;
2239      Merge
2240      	trash501(in=a)
2241      	trash503(in=b)
2242      	trash504(in=c)
2243      	trash505(in=d)
2244      	trash506(in=e)
2245      	trash507(in=f)
2246      	trash508(in=g)
2247      	trash508_1(in=g_1)
2248      	trash509(in=h)
2249      	trash510(in=i)
2250      	trash511(in=j)
2251      	trash512(in=k)
2252      	trash513(in=l)
2253      	trash514(in=m)
2254      	trash515(in=n)
2255      	trash516(in=o);
2256      By
2257      	enrolid;
2258      If
2259      	a or b or c or d or e or f or g or g_1 or h or i or j or k or l or m or n or o;
2260      run;

NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: 1344 observations were read from "WORK.trash501"
NOTE: 0 observations were read from "WORK.trash503"
77                                       The WPS System   12:31 Wednesday, October 24, 2018     

NOTE: 0 observations were read from "WORK.trash504"
NOTE: 6 observations were read from "WORK.trash505"
NOTE: 0 observations were read from "WORK.trash506"
NOTE: 0 observations were read from "WORK.trash507"
NOTE: 168 observations were read from "WORK.trash508"
NOTE: 318 observations were read from "WORK.trash508_1"
NOTE: 0 observations were read from "WORK.trash509"
NOTE: 541 observations were read from "WORK.trash510"
NOTE: 1 observations were read from "WORK.trash511"
NOTE: 752 observations were read from "WORK.trash512"
NOTE: 1 observations were read from "WORK.trash513"
NOTE: 0 observations were read from "WORK.trash514"
NOTE: 0 observations were read from "WORK.trash515"
NOTE: 0 observations were read from "WORK.trash516"
NOTE: Data set "WORK.trash531" has 1344 observation(s) and 18 variable(s)
NOTE: The data step took :
      real time : 1.020
      cpu time  : 0.144


2261      
2262      *** Merge with the original Sample and use counts of zero when no admissions;
2263      PROC SQL;
2264      Create Table temp.IPandOP as
2265      Select
2266      	a.enrolid,
2267      	max(0,b.flag12mMHSA) as flag12mMHSA,
2268      	max(0,b.flag3mGYN) as flag3mGYN,
2269      	max(0,b.Count3mAcuteStage3) as Count3mAcuteStage3,
2270      	max(0,b.Count3mChronicStage3) as Count3mChronicStage3,
2271      	max(0,b.Count6mChronicStage3) as Count6mChronicStage3,
2272      	max(0,b.Count3mAcuteSign) as Count3mAcuteSign,
2273      	max(0,b.Count3mChronicSign) as Count3mChronicSign,
2274      	max(0,b.Count6mChronicSign) as Count6mChronicSign,
2275      	max(0,b.Count12mChronicSign) as Count12mChronicSign,
2276      	max(0,b.Count3mAcute) as Count3mAcute,
2277      	max(0,b.Count6mAcute) as Count6mAcute,
2278      	max(0,b.Count3mChronic) as Count3mChronic,
2279      	max(0,b.Count12mChronic) as Count12mChronic,
2280      	max(0,b.Count3mBody) as Count3mBody,
2281      	max(0,b.Count3mBodySign) as Count3mBodySign,
2282      	max(0,b.flag3mNewChronicSign) as flag3mNewChronicSign,
2283      	max(0,b.Days3mStage3) as Days3mStage3
2284      From
2285      	(Select distinct enrolid from temp.SamplewClassification) as a
2286      Left Join
2287      	work.trash531 as b
2288      On
2289      	a.enrolid=b.enrolid
2290      Order by
2291      	a.enrolid;
NOTE: View opening spill file for output observations.
NOTE: Data set "TEMP.IPandOP" has 1798 observation(s) and 18 variable(s)
78                                       The WPS System   12:31 Wednesday, October 24, 2018     

2292      quit;
NOTE: Procedure SQL step took :
      real time : 0.246
      cpu time  : 0.043


2293      
2294      
2295      
2296      
2297      
2298      *** summarize the outpatient data ***;
2299      ************************************;
2300      
2301      *** Modified ;
2302      PROC SQL;
2303      *** get all the outpatient data from the matched IDs;
2304      Create View trash001 as select distinct
2305      	a.enrolid,
2306      	a.msclmid,
2307      	a.facprof,
2308      	a.fachdid,
2309      	a.proc1,
2310      	a.procgrp,
2311      	a.dxcat,
2312      	a.svcscat,
2313      	a.stdprov,
2314      	a.svcdate,
2315      	a.pay
2316      from
2317      	ccaeo as a,
2318      	temp.SamplewClassification	as b	
2319      where
2320      	a.enrolid=b.enrolid
2321      order by
2322      	a.enrolid,
2323      	a.svcdate;
NOTE: View WORK.trash001 successfully created
2324      
2325      *** map the principal DxCat from the outpatient claim to chronic/acute;
2326      Create View trash002 as select
2327      	a.*,
2328      	b.category
2329      from
2330      	trash001					as a
2331      left join
2332      	temp.GeneralAssignments		as b
2333      on
2334      	a.dxcat=b.dxcat;
NOTE: View WORK.trash002 successfully created
2335      
2336      *** link to ATG from OPEG Lookup;
2337      Create View trash003 as select
79                                       The WPS System   12:31 Wednesday, October 24, 2018     

2338      	a.*,
2339      	b.ATG
2340      from
2341      	trash002 		as a
2342      left join
2343      	temp.OPEGLookup		as b
2344      on
2345      	a.proc1=b.hcpcs;
NOTE: View WORK.trash003 successfully created
2346      
2347      *** link to Significant Conditions based on ProcGrp map;
2348      Create View trash004 as select
2349      	a.*,
2350      	b.Significance
2351      from
2352      	trash003 		as a
2353      left join
2354      	temp.SignificantConditions		as b
2355      on
2356      	a.dxcat=b.dxcat;
NOTE: View WORK.trash004 successfully created
2357      
2358      *** link to facility header table to get the inpatient flag based on CASEID being pres
2358    ! ent;
2359      Create Table temp.SampleOtp1 as select distinct
2360      	a.*,
2361      	b.caseid
2362      from
2363      	trash004			as a
2364      left join
2365      	ccaef as b
2366      on
2367      	a.enrolid=b.enrolid and
2368      	a.fachdid=b.fachdid;
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: Data set "TEMP.SampleOtp1" has 32108 observation(s) and 15 variable(s)
2369      Quit;
NOTE: Procedure SQL step took :
      real time : 2.519
      cpu time  : 1.186


2370      
2371      
2372      /*** check some counts of patients/claims in the data selected above;
2373      proc sql;
2374      select count (distinct enrolid) from temp.SampleOtp1;
2375      select enrolid format=15.0, count(distinct svcdate) as count_claims from temp.SampleOt
2375    ! p1 group by enrolid;
2376      quit;*/
80                                       The WPS System   12:31 Wednesday, October 24, 2018     

2377      
2378      PROC SQL;
2379      *** counting 3/12 months office visits to any provider for any conditions by service d
2379    ! ate;
2380      Create View work.trash001_1 as
2381      select
2382      	enrolid,
2383      	count(distinct msclmid) as Count3mOV
2384      from
2385      	temp.SampleOtp1
2386      where
2387      	svcdate > &StartDate. - 90							and		/*3 months*/
2388      	substr(svcscat,4,2)="25"							and		/*office visits*/
2389      	^(proc1 in (&ProcExclusionList.))							/*exclusion based on procedures*/
2390      group by
2391      	enrolid
2392      ;
NOTE: View WORK.trash001_1 successfully created
2393      Create View work.trash001_2 as
2394      select
2395      	enrolid,
2396      	count(distinct msclmid) as Count12mOV
2397      from
2398      	temp.SampleOtp1
2399      where
2400      	svcdate > &StartDate. - 366							and		/*12 months*/
2401      	substr(svcscat,4,2)="25"							and		/*office visits*/
2402      	^(proc1 in (&ProcExclusionList.))							/*exclusion based on procedures*/
2403      group by
2404      	enrolid
2405      ;
NOTE: View WORK.trash001_2 successfully created
2406      
2407      *** counting 3/6 months office visits to any provider for Chronic conditions by servic
2407    ! e date;
2408      Create View work.trash002_1 as
2409      select
2410      	enrolid,
2411      	count(distinct msclmid) as Count3mOVChronic
2412      from
2413      	temp.SampleOtp1
2414      where
2415      	category='Chronic'									and		/*Chronic*/
2416      	svcdate > &StartDate. - 90 							and		/*3 months*/
2417      	substr(svcscat,4,2)="25"							and		/*office visits*/
2418      	^(proc1 in (&ProcExclusionList.))							/*exclusion based on procedures*/
2419      group by
2420      	enrolid
2421      ;
NOTE: View WORK.trash002_1 successfully created
2422      Create View work.trash002_2 as
2423      select
2424      	enrolid,
81                                       The WPS System   12:31 Wednesday, October 24, 2018     

2425      	count(distinct msclmid) as Count6mOVChronic
2426      from
2427      	temp.SampleOtp1
2428      where
2429      	category='Chronic'									and		/*Chronic*/
2430      	svcdate > &StartDate. - 180							and		/*6 months*/
2431      	substr(svcscat,4,2)="25"							and		/*office visits*/
2432      	^(proc1 in (&ProcExclusionList.))							/*exclusion based on procedures*/
2433      group by
2434      	enrolid
2435      ;
NOTE: View WORK.trash002_2 successfully created
2436      
2437      *** counting 3/6 months office visits to specialists for Chronic conditions by service
2437    !  date;
2438      Create View work.trash003_1 as
2439      select
2440      	enrolid,
2441      	count(distinct msclmid) as Count3mOVChronicSpecialist
2442      from
2443      	temp.SampleOtp1
2444      where
2445      	category='Chronic'							and		/*Chronic*/
2446      	svcdate > &StartDate. - 90 					and		/*3 months*/
2447      	substr(svcscat,4,2)="25"					and		/*office visits*/
2448      	stdprov between 100 and 799					and		/*specialists*/
2449      	^(stdprov in (&SpecExclusionList.))			and		/*exclusions from specialists*/
2450      	^(proc1 in (&ProcExclusionList.))					/*exclusion based on procedures*/
2451      group by
2452      	enrolid
2453      ;
NOTE: View WORK.trash003_1 successfully created
2454      Create View work.trash003_2 as
2455      select
2456      	enrolid,
2457      	count(distinct msclmid) as Count6mOVChronicSpecialist
2458      from
2459      	temp.SampleOtp1
2460      where
2461      	category='Chronic'							and		/*Chronic*/
2462      	svcdate > &StartDate. - 180 				and		/*6 months*/
2463      	substr(svcscat,4,2)="25"					and		/*office visits*/
2464      	stdprov between 100 and 799					and		/*specialists*/
2465      	^(stdprov in (&SpecExclusionList))			and		/*exclusions from specialists*/
2466      	^(proc1 in (&ProcExclusionList.))					/*exclusion based on procedures*/
2467      group by
2468      	enrolid
2469      ;
NOTE: View WORK.trash003_2 successfully created
2470      
2471      *** counting 3 months unique specialties for office visits;
2472      Create View work.trash004 as
2473      select
82                                       The WPS System   12:31 Wednesday, October 24, 2018     

2474      	enrolid,
2475      	count(distinct stdprov) as Count3mOVSpecialties
2476      from
2477      	temp.SampleOtp1
2478      where
2479      	svcdate > &StartDate. - 90					and		/*3 months*/
2480      	stdprov between 100 and 799					and		/*specialists*/
2481      	^(stdprov in (&SpecExclusionList))			and		/*exclusions from specialists*/
2482      	^(proc1 in (&ProcExclusionList.))			and		/*exclusion based on procedures*/
2483      	substr(svcscat,4,2)="25"							/*office visits*/
2484      group by
2485      	enrolid
2486      ;
NOTE: View WORK.trash004 successfully created
2487      
2488      *** counting 3 months unique specialties for office visits Chronic;
2489      Create View work.trash005 as
2490      select
2491      	enrolid,
2492      	count(distinct stdprov) as Count3mOVChronicSpecialties
2493      from
2494      	temp.SampleOtp1
2495      where
2496      	svcdate > &StartDate. - 90					and		/*3 months*/
2497      	stdprov between 100 and 799					and		/*specialists*/
2498      	^(stdprov in (&SpecExclusionList))			and		/*exclusions from specialists*/
2499      	^(proc1 in (&ProcExclusionList.))			and		/*exclusion based on procedures*/
2500      	substr(svcscat,4,2)="25"					and		/*office visits*/
2501      	category='Chronic'									/*Chronic*/
2502      group by
2503      	enrolid
2504      ;
NOTE: View WORK.trash005 successfully created
2505      
2506      *** counting 3/6 months ER visits for any conditions by claim id;
2507      Create View work.trash006_1 as
2508      select
2509      	enrolid,
2510      	count(distinct msclmid) as Count3mER
2511      from
2512      	temp.SampleOtp1
2513      where
2514      	svcdate > &StartDate. - 90					and		/*3 months*/
2515      	facprof='F'									and		/*Facility claim*/
2516      	substr(svcscat,4,2)="20"					and		/*ER visits*/
2517      	missing(caseid)=1							and 	/*no inpatient*/
2518      	^(proc1 in (&ProcExclusionList.))					/*exclusion based on procedures*/
2519      group by
2520      	enrolid
2521      ;
NOTE: View WORK.trash006_1 successfully created
2522      
2523      Create View work.trash006_2 as
83                                       The WPS System   12:31 Wednesday, October 24, 2018     

2524      select
2525      	enrolid,
2526      	count(distinct msclmid) as Count12mER
2527      from
2528      	temp.SampleOtp1
2529      where
2530      	svcdate > &StartDate. - 366					and		/*12 months*/
2531      	facprof='F'									and		/*Facility claim*/
2532      	substr(svcscat,4,2)="20"					and		/*ER visits*/
2533      	missing(caseid)=1							and 	/*no inpatient*/
2534      	^(proc1 in (&ProcExclusionList.))					/*exclusion based on procedures*/
2535      group by
2536      	enrolid
2537      ;
NOTE: View WORK.trash006_2 successfully created
2538      
2539      *** counting 3/6 months ER visits for Chronic conditions by claim id;
2540      Create View work.trash007_1 as
2541      select
2542      	enrolid,
2543      	count(distinct msclmid) as Count3mERChronic
2544      from
2545      	temp.SampleOtp1
2546      where
2547      	category='Chronic'							and		/*Chronic*/
2548      	svcdate > &StartDate. - 90					and		/*3 months*/
2549      	facprof='F'									and		/*Facility claim*/
2550      	substr(svcscat,4,2)="20"					and		/*ER visits*/
2551      	missing(caseid)=1							and 	/*no inpatient*/
2552      	^(proc1 in (&ProcExclusionList.))					/*exclusion based on procedures*/
2553      group by
2554      	enrolid
2555      ;
NOTE: View WORK.trash007_1 successfully created
2556      
2557      Create View work.trash007_2 as
2558      select
2559      	enrolid,
2560      	count(distinct msclmid) as Count6mERChronic
2561      from
2562      	temp.SampleOtp1
2563      where
2564      	category='Chronic'							and		/*Chronic*/
2565      	svcdate > &StartDate. - 180					and		/*6 months*/
2566      	facprof='F'									and		/*Facility claim*/
2567      	substr(svcscat,4,2)="20"					and		/*ER visits*/
2568      	missing(caseid)=1							and 	/*no inpatient*/
2569      	^(proc1 in (&ProcExclusionList.))					/*exclusion based on procedures*/
2570      group by
2571      	enrolid
2572      ;
NOTE: View WORK.trash007_2 successfully created
2573      
84                                       The WPS System   12:31 Wednesday, October 24, 2018     

2574      *** days since any ER;
2575      Create View work.trash008 as
2576      select
2577      	enrolid,
2578      	&StartDate.-max(svcdate) 	as DaysER
2579      from
2580      	temp.SampleOtp1
2581      where
2582      	facprof='F'									and		/*Facility claim*/
2583      	substr(svcscat,4,2)="20"					and		/*ER visits*/
2584      	missing(caseid)=1							and 	/*no inpatient*/
2585      	^(proc1 in (&ProcExclusionList.))					/*exclusion based on procedures*/
2586      group by
2587      	enrolid
2588      ;
NOTE: View WORK.trash008 successfully created
2589      
2590      *** days since Major ER;
2591      *** from DS output transpose the dxcat and stage, one per row and dedup, so that can b
2591    ! e merged into OP data;
NOTE: Procedure SQL step took :
      real time : 0.120
      cpu time  : 0.008


2592      data work.trash0091(keep=enrolid svcdate dxcat dxstage);
2593      set temp.SampleIPOPwDS1;
2594      array listcat[4] dxcat1-dxcat4;
2595      array liststage[4] dxstage1-dxstage4;
2596      do i=1 to 4;
2597      	dxcat=listcat[i];
2598      	dxstage=liststage[i];
2599      	if dxstage >= 3 then output;
2600      end;
2601      run;

NOTE: 34163 observations were read from "TEMP.SampleIPOPwDS1"
NOTE: Data set "WORK.trash0091" has 894 observation(s) and 4 variable(s)
NOTE: The data step took :
      real time : 0.066
      cpu time  : 0.029


2602      proc sort data=work.trash0091 nodupkey; by enrolid svcdate dxcat; run;
NOTE: 894 observations were read from "WORK.trash0091"
NOTE: 679 observations were found and deleted due to having duplicate sort keys
NOTE: Data set "WORK.trash0091" has 215 observation(s) and 4 variable(s)
NOTE: Procedure sort step took :
      real time : 0.025
      cpu time  : 0.004


2603      *** Merge the Stage from DS;
85                                       The WPS System   12:31 Wednesday, October 24, 2018     

2604      proc sql;
2605      Create View work.trash0092 as
2606      Select
2607      	a.*,
2608      	b.dxstage
2609      From
2610      	temp.SampleOtp1 as a
2611      Left Join
2612      	work.trash0091 as b
2613      On
2614      	a.enrolid=b.enrolid and
2615      	a.svcdate=b.svcdate and
2616      	a.dxcat=b.dxcat;
NOTE: View WORK.trash0092 successfully created
2617      *** count the days using all the criteria including DS stage;
2618      Create View work.trash009 as
2619      Select
2620      	enrolid,
2621      	&StartDate.-max(svcdate) 	as DaysMajorER
2622      from
2623      	work.trash0092
2624      where
2625      	facprof='F'									and		/*Facility claim*/
2626      	substr(svcscat,4,2)="20"					and		/*ER visits*/
2627      	missing(caseid)=1							and 	/*no inpatient*/
2628      	^(proc1 in (&ProcExclusionList.))			and		/*exclusion based on procedures*/
2629      	(Significance="High" or dxstage>=3)					/*must be significant or stage higher than 3*
2629    ! /
2630      group by
2631      	enrolid
2632      ;
NOTE: View WORK.trash009 successfully created
2633      
2634      *** days since home health;
2635      Create View work.trash010 as
2636      select
2637      	enrolid,
2638      	&StartDate.-max(svcdate) 	as DaysHH
2639      from
2640      	temp.SampleOtp1
2641      where
2642      	substr(svcscat,4,2)="33"					and		/*Home Health claim*/
2643      	missing(caseid)=1							and 	/*no inpatient*/
2644      	^(proc1 in (&ProcExclusionList.))					/*exclusion based on procedures*/
2645      group by
2646      	enrolid
2647      ;
NOTE: View WORK.trash010 successfully created
2648      
2649      *** days since Major Surgery;
2650      Create View work.trash011 as
2651      select
2652      	enrolid,
86                                       The WPS System   12:31 Wednesday, October 24, 2018     

2653      	&StartDate.-max(svcdate) 	as DaysMajorSurg
2654      from
2655      	temp.SampleOtp1
2656      where
2657      	missing(caseid)=1							and 	/*no inpatient*/
2658      	ATG="SURG MAJOR"
2659      group by
2660      	enrolid
2661      ;
NOTE: View WORK.trash011 successfully created
2662      
2663      *** days since Oxygen treatment;
2664      Create View work.trash012 as
2665      select
2666      	enrolid,
2667      	&StartDate.-max(svcdate) 	as DaysOxygen
2668      from
2669      	temp.SampleOtp1
2670      where
2671      	missing(caseid)=1							and 	/*no inpatient*/
2672      	proc1 in (&OxygenCPTList.)
2673      group by
2674      	enrolid
2675      ;
NOTE: View WORK.trash012 successfully created
2676      
2677      *** Days in LTC and Flag for LTC in the last 90 days (LTC defined based on svcscat = 1
2677    ! 02xx);
2678      Create View work.trash013 as
2679      select
2680      	a.enrolid,
2681      	a.fachdid,
2682      	a.svcscat,
2683      	b.svcdate as header_date,
2684      	b.tsvcdat as header_last,
2685      	b.days
2686      from
2687      	temp.SampleOTP1(where=
2688      					(substr(svcscat,1,3)='102' and svcdate > &StartDate. - 90)
2689      					) as a,
2690      	ccaef as b
2691      where
2692      	a.enrolid=b.enrolid and
2693      	a.fachdid=b.fachdid
2694      order by
2695      	enrolid,
2696      	header_date;
NOTE: View WORK.trash013 successfully created
2697      ;
2698      Quit;
NOTE: Procedure sql step took :
      real time : 0.059
      cpu time  : 0.003
87                                       The WPS System   12:31 Wednesday, October 24, 2018     



2699      
2700      data work.trash013_1(keep=enrolid Days3mLTC flag3mLTC);
2701      	set work.trash013;
2702      	by enrolid;
2703      	retain first last Days3mLTC 0;
2704      	if first.enrolid then do;
2705      		first=header_date;
2706      		last=header_last;
2707      		Days3mLTC=0;
2708      	end;
2709      	if header_date <= last then
2710      		last=max(last,header_last);
2711      	else do;
2712      		Days3mLTC=Days3mLTC + last-first;
2713      		first=header_date;
2714      		last=header_last;
2715      	end;
2716      	if last.enrolid then do;
2717      		Days3mLTC=Days3mLTC + last-first;
2718      		flag3mLTC=1;
2719      		output;
2720      	end;
2721      run;

NOTE: View opening spill file for output observations.
NOTE: 0 observations were read from "WORK.trash013"
NOTE: Data set "WORK.trash013_1" has 0 observation(s) and 3 variable(s)
NOTE: The data step took :
      real time : 0.089
      cpu time  : 0.030


2722      
2723      *** put the all the outpatient related variables together;
2724      DATA
2725      	work.trash101;
2726      merge
2727      	trash001_1(in=a)
2728      	trash001_2(in=b)
2729      	trash002_1(in=c)
2730      	trash002_2(in=d)
2731      	trash003_1(in=e)
2732      	trash003_2(in=f)
2733      	trash004 (in=g)
2734      	trash005 (in=h)
2735      	trash006_1(in=i)
2736      	trash006_2(in=j)
2737      	trash007_1(in=k)
2738      	trash007_2(in=l)
2739      	trash008  (in=m)
2740      	trash009  (in=n)
88                                       The WPS System   12:31 Wednesday, October 24, 2018     

2741      	trash010  (in=o)
2742      	trash011  (in=p)
2743      	trash012  (in=q)
2744      	trash013_1(in=r)
2745      ;
2746      by
2747      	enrolid;
2748      if
2749      	a or b or c or d or e or f or g or h or i or j or k or l or m or n or o or p or q or 
2749    ! r;
2750      run;

NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: 726 observations were read from "WORK.trash001_1"
NOTE: 1229 observations were read from "WORK.trash001_2"
NOTE: 281 observations were read from "WORK.trash002_1"
NOTE: 434 observations were read from "WORK.trash002_2"
NOTE: 124 observations were read from "WORK.trash003_1"
NOTE: 177 observations were read from "WORK.trash003_2"
NOTE: 255 observations were read from "WORK.trash004"
NOTE: 124 observations were read from "WORK.trash005"
NOTE: 54 observations were read from "WORK.trash006_1"
NOTE: 203 observations were read from "WORK.trash006_2"
NOTE: 9 observations were read from "WORK.trash007_1"
NOTE: 18 observations were read from "WORK.trash007_2"
NOTE: 203 observations were read from "WORK.trash008"
NOTE: 34 observations were read from "WORK.trash009"
NOTE: 3 observations were read from "WORK.trash010"
NOTE: 64 observations were read from "WORK.trash011"
NOTE: 2 observations were read from "WORK.trash012"
NOTE: 0 observations were read from "WORK.trash013_1"
NOTE: Data set "WORK.trash101" has 1244 observation(s) and 20 variable(s)
NOTE: The data step took :
      real time : 0.672
      cpu time  : 0.092

89                                       The WPS System   12:31 Wednesday, October 24, 2018     


2751      
2752      *** Merge with the original Sample and use counts of zero when no admissions;
2753      PROC SQL;
2754      Create Table temp.OP as
2755      select
2756      	a.enrolid,
2757      	max(0,b.Count3mOV)							as Count3mOV,
2758      	max(0,b.Count12mOV)							as Count12mOV,
2759      	max(0,b.Count3mOVChronic)					as Count3mOVChronic,
2760      	max(0,b.Count6mOVChronic)					as Count6mOVChronic,
2761      	max(0,b.Count3mOVChronicSpecialist)			as Count3mOVChronicSpecialist,
2762      	max(0,b.Count6mOVChronicSpecialist)			as Count6mOVChronicSpecialist,
2763      	max(0,b.Count3mOVSpecialties)				as Count3mOVSpecialties,
2764      	max(0,b.Count3mOVChronicSpecialties)		as Count3mOVChronicSpecialties,
2765      	max(0,b.Count3mEr)							as Count3mER,
2766      	max(0,b.Count12mER)							as Count12mER,
2767      	max(0,b.Count3mERChronic)					as Count3mERChronic,
2768      	max(0,b.Count6mERChronic)					as Count6mERChronic,
2769      	min(365,b.DaysER)							as DaysER,
2770      	min(365,b.DaysMajorER)						as DaysMajorER,
2771      	min(365,b.DaysHH)							as DaysHH,
2772      	min(365,b.DaysMajorSurg)					as DaysMajorSurg,
2773      	min(365,b.DaysOxygen)						as DaysOxygen,
2774      	max(0,b.Days3mLTC)							as Days3mLTC,
2775      	max(0,b.flag3mLTC)							as flag3mLTC
2776      from
2777      	(Select distinct enrolid from temp.SamplewClassification) as a
2778      left join
2779      	work.trash101 as b
2780      on
2781      	a.enrolid=b.enrolid
2782      Order by
2783      	a.enrolid;
NOTE: View opening spill file for output observations.
NOTE: Data set "TEMP.OP" has 1798 observation(s) and 20 variable(s)
2784      
2785      
2786      *************************************************************;
2787      *** Merge all the variables from all claims OP/IP/Rx together;
NOTE: Procedure SQL step took :
      real time : 0.339
      cpu time  : 0.034


2788      data temp.AllModelInputs;
2789      merge
2790      	temp.SamplewClassification(in=orig)
2791      	temp.OP		(in=a)
2792      	temp.IP		(in=b)
2793      	temp.Rx		(in=c)
2794      	temp.IPandOP(in=d);
2795      if orig or a or b or c or d;
90                                       The WPS System   12:31 Wednesday, October 24, 2018     

2796      by enrolid;
2797      run;

NOTE: 1798 observations were read from "TEMP.SamplewClassification"
NOTE: 1798 observations were read from "TEMP.OP"
NOTE: 1798 observations were read from "TEMP.IP"
NOTE: 1798 observations were read from "TEMP.Rx"
NOTE: 1798 observations were read from "TEMP.IPandOP"
NOTE: Data set "TEMP.AllModelInputs" has 1798 observation(s) and 61 variable(s)
NOTE: The data step took :
      real time : 0.031
      cpu time  : 0.005


2798      proc export
2799      	data=temp.AllModelInputs
2800      	outfile="&outpath./ModelInputs&version..csv"
2801      	replace;
2802      run;
NOTE: Procedure export step took :
      real time : 0.001
      cpu time  : 0.000


2803      data _null_;
2804        file '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/ModelInputs
2804    ! 31DEC2015MarketScanSample.csv' delimiter=',' DSD DROPOVER LRECL=1145;
2805        format ENROLID BEST12.;
2806        format AssignmentFinal $1.;
2807        format Count3mOV BEST12.;
2808        format Count12mOV BEST12.;
2809        format Count3mOVChronic BEST12.;
2810        format Count6mOVChronic BEST12.;
2811        format Count3mOVChronicSpecialist BEST12.;
2812        format Count6mOVChronicSpecialist BEST12.;
2813        format Count3mOVSpecialties BEST12.;
2814        format Count3mOVChronicSpecialties BEST12.;
2815        format Count3mER BEST12.;
2816        format Count12mER BEST12.;
2817        format Count3mERChronic BEST12.;
2818        format Count6mERChronic BEST12.;
2819        format DaysER BEST12.;
2820        format DaysMajorER BEST12.;
2821        format DaysHH BEST12.;
2822        format DaysMajorSurg BEST12.;
2823        format DaysOxygen BEST12.;
2824        format Days3mLTC BEST12.;
2825        format flag3mLTC BEST12.;
2826        format CountAdm3mAll BEST12.;
2827        format CountAdm3mChronic BEST12.;
2828        format CountAdm6mAll BEST12.;
2829        format CountAdm6mChronic BEST12.;
2830        format SumLOS3mAll BEST12.;
91                                       The WPS System   12:31 Wednesday, October 24, 2018     

2831        format DaysAnyAdm BEST12.;
2832        format DaysChronicAdm BEST12.;
2833        format DaysSurgAdm BEST12.;
2834        format DaysMedicalAdm BEST12.;
2835        format DaysMtrntyAdm BEST12.;
2836        format DaysMHSAAdm BEST12.;
2837        format FlagChronicRx BEST12.;
2838        format FlagNewChronicRx BEST12.;
2839        format CountDaysSupp3m BEST12.;
2840        format CountDaysSupp6m BEST12.;
2841        format CountDaysSuppChronic3m BEST12.;
2842        format CountDaysSuppChronic6m BEST12.;
2843        format CountDaysSuppOpiates3m BEST12.;
2844        format CountDaysSuppOpiates6m BEST12.;
2845        format CountTherClass3m BEST12.;
2846        format CountTherClass6m BEST12.;
2847        format CountTherClassChronic3m BEST12.;
2848        format CountTherClassChronic6m BEST12.;
2849        format flag12mMHSA BEST12.;
2850        format flag3mGYN BEST12.;
2851        format Count3mAcuteStage3 BEST12.;
2852        format Count3mChronicStage3 BEST12.;
2853        format Count6mChronicStage3 BEST12.;
2854        format Count3mAcuteSign BEST12.;
2855        format Count3mChronicSign BEST12.;
2856        format Count6mChronicSign BEST12.;
2857        format Count12mChronicSign BEST12.;
2858        format Count3mAcute BEST12.;
2859        format Count6mAcute BEST12.;
2860        format Count3mChronic BEST12.;
2861        format Count12mChronic BEST12.;
2862        format Count3mBody BEST12.;
2863        format Count3mBodySign BEST12.;
2864        format flag3mNewChronicSign BEST12.;
2865        format Days3mStage3 BEST12.;
2866        if _n_=1 then do;
2867            put
2868               'ENROLID'        ','
2869               'AssignmentFinal'        ','
2870               'Count3mOV'        ','
2871               'Count12mOV'        ','
2872               'Count3mOVChronic'        ','
2873               'Count6mOVChronic'        ','
2874               'Count3mOVChronicSpecialist'        ','
2875               'Count6mOVChronicSpecialist'        ','
2876               'Count3mOVSpecialties'        ','
2877               'Count3mOVChronicSpecialties'        ','
2878               'Count3mER'        ','
2879               'Count12mER'        ','
2880               'Count3mERChronic'        ','
2881               'Count6mERChronic'        ','
2882               'DaysER'        ','
2883               'DaysMajorER'        ','
92                                       The WPS System   12:31 Wednesday, October 24, 2018     

2884               'DaysHH'        ','
2885               'DaysMajorSurg'        ','
2886               'DaysOxygen'        ','
2887               'Days3mLTC'        ','
2888               'flag3mLTC'        ','
2889               'CountAdm3mAll'        ','
2890               'CountAdm3mChronic'        ','
2891               'CountAdm6mAll'        ','
2892               'CountAdm6mChronic'        ','
2893               'SumLOS3mAll'        ','
2894               'DaysAnyAdm'        ','
2895               'DaysChronicAdm'        ','
2896               'DaysSurgAdm'        ','
2897               'DaysMedicalAdm'        ','
2898               'DaysMtrntyAdm'        ','
2899               'DaysMHSAAdm'        ','
2900               'FlagChronicRx'        ','
2901               'FlagNewChronicRx'        ','
2902               'CountDaysSupp3m'        ','
2903               'CountDaysSupp6m'        ','
2904               'CountDaysSuppChronic3m'        ','
2905               'CountDaysSuppChronic6m'        ','
2906               'CountDaysSuppOpiates3m'        ','
2907               'CountDaysSuppOpiates6m'        ','
2908               'CountTherClass3m'        ','
2909               'CountTherClass6m'        ','
2910               'CountTherClassChronic3m'        ','
2911               'CountTherClassChronic6m'        ','
2912               'flag12mMHSA'        ','
2913               'flag3mGYN'        ','
2914               'Count3mAcuteStage3'        ','
2915               'Count3mChronicStage3'        ','
2916               'Count6mChronicStage3'        ','
2917               'Count3mAcuteSign'        ','
2918               'Count3mChronicSign'        ','
2919               'Count6mChronicSign'        ','
2920               'Count12mChronicSign'        ','
2921               'Count3mAcute'        ','
2922               'Count6mAcute'        ','
2923               'Count3mChronic'        ','
2924               'Count12mChronic'        ','
2925               'Count3mBody'        ','
2926               'Count3mBodySign'        ','
2927               'flag3mNewChronicSign'        ','
2928               'Days3mStage3';
2929          end;
2930        set temp.AllModelInputs;
2931        put ENROLID @;
2932        put AssignmentFinal @;
2933        put Count3mOV @;
2934        put Count12mOV @;
2935        put Count3mOVChronic @;
2936        put Count6mOVChronic @;
93                                       The WPS System   12:31 Wednesday, October 24, 2018     

2937        put Count3mOVChronicSpecialist @;
2938        put Count6mOVChronicSpecialist @;
2939        put Count3mOVSpecialties @;
2940        put Count3mOVChronicSpecialties @;
2941        put Count3mER @;
2942        put Count12mER @;
2943        put Count3mERChronic @;
2944        put Count6mERChronic @;
2945        put DaysER @;
2946        put DaysMajorER @;
2947        put DaysHH @;
2948        put DaysMajorSurg @;
2949        put DaysOxygen @;
2950        put Days3mLTC @;
2951        put flag3mLTC @;
2952        put CountAdm3mAll @;
2953        put CountAdm3mChronic @;
2954        put CountAdm6mAll @;
2955        put CountAdm6mChronic @;
2956        put SumLOS3mAll @;
2957        put DaysAnyAdm @;
2958        put DaysChronicAdm @;
2959        put DaysSurgAdm @;
2960        put DaysMedicalAdm @;
2961        put DaysMtrntyAdm @;
2962        put DaysMHSAAdm @;
2963        put FlagChronicRx @;
2964        put FlagNewChronicRx @;
2965        put CountDaysSupp3m @;
2966        put CountDaysSupp6m @;
2967        put CountDaysSuppChronic3m @;
2968        put CountDaysSuppChronic6m @;
2969        put CountDaysSuppOpiates3m @;
2970        put CountDaysSuppOpiates6m @;
2971        put CountTherClass3m @;
2972        put CountTherClass6m @;
2973        put CountTherClassChronic3m @;
2974        put CountTherClassChronic6m @;
2975        put flag12mMHSA @;
2976        put flag3mGYN @;
2977        put Count3mAcuteStage3 @;
2978        put Count3mChronicStage3 @;
2979        put Count6mChronicStage3 @;
2980        put Count3mAcuteSign @;
2981        put Count3mChronicSign @;
2982        put Count6mChronicSign @;
2983        put Count12mChronicSign @;
2984        put Count3mAcute @;
2985        put Count6mAcute @;
2986        put Count3mChronic @;
2987        put Count12mChronic @;
2988        put Count3mBody @;
2989        put Count3mBodySign @;
94                                       The WPS System   12:31 Wednesday, October 24, 2018     

2990        put flag3mNewChronicSign @;
2991        put Days3mStage3;
2992      run;

NOTE: The file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/ModelInputs31DEC2015Ma
      rketScanSample.csv' is:
      File
      Name=/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/ModelInputs31DEC20
      15MarketScanSample.csv,
      Access Permissions=-rw-rw-r--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=0, Last Modified=12:32:35 Oct 24 2018,
      Created=12:32:35 Oct 24 2018, Lrecl=1145, Recfm=V

NOTE: 1799 records were written to file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/ModelInputs31DEC2015Ma
      rketScanSample.csv'
      The minimum record length was 143
      The maximum record length was 976
NOTE: 1798 observations were read from "TEMP.AllModelInputs"
NOTE: The data step took :
      real time : 0.082
      cpu time  : 0.033


2993      FILENAME ##EXPOUT CLEAR;
2994      
2995      /*** RUN SPSS and get the Decision Tree model ***/
2996      /*** Implement the Decision Tree Model from SPSS ***/									*************** <<<<<<<<
2996    ! ---------- Put all model+rules together;
2997      data temp.DTModel
2998      /*	(keep=	
2999      			enrolid
3000      			AssignmentFinal
3001      			Count6mChronicStage3
3002      			CountDaysSuppOpiates3m
3003      			Count12mChronicSign
3004      			Count12mOV
3005      			CountDaysSupp3m
3006      			DaysAnyAdm
3007      			DaysMajorER
3008      			CountTherClassChronic6m
3009      			CountAdm3mAll
3010      			Count6mERChronic
3011      			Count12mER /* not used in the model but we'll use it for validation analysis *
3012      			Count3mER  /* not used in the model but we'll use it for validation analysis *
3013      			PopClass
3014      			Rule)*/;
3015      set temp.AllModelInputs (drop=AssignmentFinal);
3016      if Count6mChronicStage3 <= 0 then do;
3017      	if	CountDaysSuppOpiates3m <= 50 then do;
3018      		if	Count12mChronicSign <= 0 then do;
95                                       The WPS System   12:31 Wednesday, October 24, 2018     

3019      			if Count12mOV <= 0 then do;
3020      				if CountDaysSupp3m <= 37 then do; PopClass=1; Rule=1; RuleConfidence=input(put(Rul
3020    ! e,RuleConfidence.),best5.3); end;
3021      				else do; PopClass=2; Rule=2; RuleConfidence=input(put(Rule,RuleConfidence.),best5.
3021    ! 3); end;
3022      			end;
3023      			else do;
3024      				if DaysAnyAdm <= 32 then do; PopClass=7; Rule=3; RuleConfidence=input(put(Rule,Rul
3024    ! eConfidence.),best5.3); end;
3025      				else do; PopClass=2; Rule=4; RuleConfidence=input(put(Rule,RuleConfidence.),best5.
3025    ! 3); end;
3026      			end;
3027      		end;
3028      		else do;
3029      			if DaysAnyAdm <= 38 then do; PopClass=7; Rule=5; RuleConfidence=input(put(Rule,Rule
3029    ! Confidence.),best5.3); end;
3030      			else do;
3031      				if Count12mChronicSign <= 4 then do;
3032      					if DaysMajorER <= 255 then do; PopClass=6; Rule=6; RuleConfidence=input(put(Rule,
3032    ! RuleConfidence.),best5.3); end;
3033      					else do;
3034      						if CountTherClassChronic6m <= 6 then do; PopClass=3; Rule=7; RuleConfidence=inpu
3034    ! t(put(Rule,RuleConfidence.),best5.3); end;
3035      						else do; PopClass=5; Rule=8; RuleConfidence=input(put(Rule,RuleConfidence.),best
3035    ! 5.3); end;
3036      					end;
3037      				end;
3038      				else do; PopClass=5; Rule=9; RuleConfidence=input(put(Rule,RuleConfidence.),best5.
3038    ! 3); end;
3039      			end;
3040      		end;
3041      	end;
3042      	else do; PopClass=6; Rule=10; RuleConfidence=input(put(Rule,RuleConfidence.),best5.3)
3042    ! ; end;
3043      end;
3044      else do;
3045      	if CountAdm3mAll <= 0 then do; PopClass=6; Rule=11; RuleConfidence=input(put(Rule,Rul
3045    ! eConfidence.),best5.3); end;
3046      	else do;
3047      		if Count6mERChronic <= 0 then do; PopClass=10; Rule=12; RuleConfidence=input(put(Rul
3047    ! e,RuleConfidence.),best5.3); end;
3048      		else do; PopClass=7; Rule=13; RuleConfidence=input(put(Rule,RuleConfidence.),best5.3
3048    ! ); end;
3049      	end;
3050      end;
3051      run;

NOTE: 1798 observations were read from "TEMP.AllModelInputs"
NOTE: Data set "TEMP.DTModel" has 1798 observation(s) and 63 variable(s)
NOTE: The data step took :
      real time : 0.028
      cpu time  : 0.006

96                                       The WPS System   12:31 Wednesday, October 24, 2018     


3052      proc export
3053      	data=temp.DTModel
3054      	outfile="&outpath./DTModel&version..csv"
3055      	replace;
3056      run;
NOTE: Procedure export step took :
      real time : 0.001
      cpu time  : 0.000


3057      data _null_;
3058        file '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/DTModel31DE
3058    ! C2015MarketScanSample.csv' delimiter=',' DSD DROPOVER LRECL=1174;
3059        format ENROLID BEST12.;
3060        format Count3mOV BEST12.;
3061        format Count12mOV BEST12.;
3062        format Count3mOVChronic BEST12.;
3063        format Count6mOVChronic BEST12.;
3064        format Count3mOVChronicSpecialist BEST12.;
3065        format Count6mOVChronicSpecialist BEST12.;
3066        format Count3mOVSpecialties BEST12.;
3067        format Count3mOVChronicSpecialties BEST12.;
3068        format Count3mER BEST12.;
3069        format Count12mER BEST12.;
3070        format Count3mERChronic BEST12.;
3071        format Count6mERChronic BEST12.;
3072        format DaysER BEST12.;
3073        format DaysMajorER BEST12.;
3074        format DaysHH BEST12.;
3075        format DaysMajorSurg BEST12.;
3076        format DaysOxygen BEST12.;
3077        format Days3mLTC BEST12.;
3078        format flag3mLTC BEST12.;
3079        format CountAdm3mAll BEST12.;
3080        format CountAdm3mChronic BEST12.;
3081        format CountAdm6mAll BEST12.;
3082        format CountAdm6mChronic BEST12.;
3083        format SumLOS3mAll BEST12.;
3084        format DaysAnyAdm BEST12.;
3085        format DaysChronicAdm BEST12.;
3086        format DaysSurgAdm BEST12.;
3087        format DaysMedicalAdm BEST12.;
3088        format DaysMtrntyAdm BEST12.;
3089        format DaysMHSAAdm BEST12.;
3090        format FlagChronicRx BEST12.;
3091        format FlagNewChronicRx BEST12.;
3092        format CountDaysSupp3m BEST12.;
3093        format CountDaysSupp6m BEST12.;
3094        format CountDaysSuppChronic3m BEST12.;
3095        format CountDaysSuppChronic6m BEST12.;
3096        format CountDaysSuppOpiates3m BEST12.;
3097        format CountDaysSuppOpiates6m BEST12.;
97                                       The WPS System   12:31 Wednesday, October 24, 2018     

3098        format CountTherClass3m BEST12.;
3099        format CountTherClass6m BEST12.;
3100        format CountTherClassChronic3m BEST12.;
3101        format CountTherClassChronic6m BEST12.;
3102        format flag12mMHSA BEST12.;
3103        format flag3mGYN BEST12.;
3104        format Count3mAcuteStage3 BEST12.;
3105        format Count3mChronicStage3 BEST12.;
3106        format Count6mChronicStage3 BEST12.;
3107        format Count3mAcuteSign BEST12.;
3108        format Count3mChronicSign BEST12.;
3109        format Count6mChronicSign BEST12.;
3110        format Count12mChronicSign BEST12.;
3111        format Count3mAcute BEST12.;
3112        format Count6mAcute BEST12.;
3113        format Count3mChronic BEST12.;
3114        format Count12mChronic BEST12.;
3115        format Count3mBody BEST12.;
3116        format Count3mBodySign BEST12.;
3117        format flag3mNewChronicSign BEST12.;
3118        format Days3mStage3 BEST12.;
3119        format PopClass BEST12.;
3120        format Rule BEST12.;
3121        format RuleConfidence BEST12.;
3122        if _n_=1 then do;
3123            put
3124               'ENROLID'        ','
3125               'Count3mOV'        ','
3126               'Count12mOV'        ','
3127               'Count3mOVChronic'        ','
3128               'Count6mOVChronic'        ','
3129               'Count3mOVChronicSpecialist'        ','
3130               'Count6mOVChronicSpecialist'        ','
3131               'Count3mOVSpecialties'        ','
3132               'Count3mOVChronicSpecialties'        ','
3133               'Count3mER'        ','
3134               'Count12mER'        ','
3135               'Count3mERChronic'        ','
3136               'Count6mERChronic'        ','
3137               'DaysER'        ','
3138               'DaysMajorER'        ','
3139               'DaysHH'        ','
3140               'DaysMajorSurg'        ','
3141               'DaysOxygen'        ','
3142               'Days3mLTC'        ','
3143               'flag3mLTC'        ','
3144               'CountAdm3mAll'        ','
3145               'CountAdm3mChronic'        ','
3146               'CountAdm6mAll'        ','
3147               'CountAdm6mChronic'        ','
3148               'SumLOS3mAll'        ','
3149               'DaysAnyAdm'        ','
3150               'DaysChronicAdm'        ','
98                                       The WPS System   12:31 Wednesday, October 24, 2018     

3151               'DaysSurgAdm'        ','
3152               'DaysMedicalAdm'        ','
3153               'DaysMtrntyAdm'        ','
3154               'DaysMHSAAdm'        ','
3155               'FlagChronicRx'        ','
3156               'FlagNewChronicRx'        ','
3157               'CountDaysSupp3m'        ','
3158               'CountDaysSupp6m'        ','
3159               'CountDaysSuppChronic3m'        ','
3160               'CountDaysSuppChronic6m'        ','
3161               'CountDaysSuppOpiates3m'        ','
3162               'CountDaysSuppOpiates6m'        ','
3163               'CountTherClass3m'        ','
3164               'CountTherClass6m'        ','
3165               'CountTherClassChronic3m'        ','
3166               'CountTherClassChronic6m'        ','
3167               'flag12mMHSA'        ','
3168               'flag3mGYN'        ','
3169               'Count3mAcuteStage3'        ','
3170               'Count3mChronicStage3'        ','
3171               'Count6mChronicStage3'        ','
3172               'Count3mAcuteSign'        ','
3173               'Count3mChronicSign'        ','
3174               'Count6mChronicSign'        ','
3175               'Count12mChronicSign'        ','
3176               'Count3mAcute'        ','
3177               'Count6mAcute'        ','
3178               'Count3mChronic'        ','
3179               'Count12mChronic'        ','
3180               'Count3mBody'        ','
3181               'Count3mBodySign'        ','
3182               'flag3mNewChronicSign'        ','
3183               'Days3mStage3'        ','
3184               'PopClass'        ','
3185               'Rule'        ','
3186               'RuleConfidence';
3187          end;
3188        set temp.DTModel;
3189        put ENROLID @;
3190        put Count3mOV @;
3191        put Count12mOV @;
3192        put Count3mOVChronic @;
3193        put Count6mOVChronic @;
3194        put Count3mOVChronicSpecialist @;
3195        put Count6mOVChronicSpecialist @;
3196        put Count3mOVSpecialties @;
3197        put Count3mOVChronicSpecialties @;
3198        put Count3mER @;
3199        put Count12mER @;
3200        put Count3mERChronic @;
3201        put Count6mERChronic @;
3202        put DaysER @;
3203        put DaysMajorER @;
99                                       The WPS System   12:31 Wednesday, October 24, 2018     

3204        put DaysHH @;
3205        put DaysMajorSurg @;
3206        put DaysOxygen @;
3207        put Days3mLTC @;
3208        put flag3mLTC @;
3209        put CountAdm3mAll @;
3210        put CountAdm3mChronic @;
3211        put CountAdm6mAll @;
3212        put CountAdm6mChronic @;
3213        put SumLOS3mAll @;
3214        put DaysAnyAdm @;
3215        put DaysChronicAdm @;
3216        put DaysSurgAdm @;
3217        put DaysMedicalAdm @;
3218        put DaysMtrntyAdm @;
3219        put DaysMHSAAdm @;
3220        put FlagChronicRx @;
3221        put FlagNewChronicRx @;
3222        put CountDaysSupp3m @;
3223        put CountDaysSupp6m @;
3224        put CountDaysSuppChronic3m @;
3225        put CountDaysSuppChronic6m @;
3226        put CountDaysSuppOpiates3m @;
3227        put CountDaysSuppOpiates6m @;
3228        put CountTherClass3m @;
3229        put CountTherClass6m @;
3230        put CountTherClassChronic3m @;
3231        put CountTherClassChronic6m @;
3232        put flag12mMHSA @;
3233        put flag3mGYN @;
3234        put Count3mAcuteStage3 @;
3235        put Count3mChronicStage3 @;
3236        put Count6mChronicStage3 @;
3237        put Count3mAcuteSign @;
3238        put Count3mChronicSign @;
3239        put Count6mChronicSign @;
3240        put Count12mChronicSign @;
3241        put Count3mAcute @;
3242        put Count6mAcute @;
3243        put Count3mChronic @;
3244        put Count12mChronic @;
3245        put Count3mBody @;
3246        put Count3mBodySign @;
3247        put flag3mNewChronicSign @;
3248        put Days3mStage3 @;
3249        put PopClass @;
3250        put Rule @;
3251        put RuleConfidence;
3252      run;

NOTE: The file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/DTModel31DEC2015Market
      ScanSample.csv' is:
100                                      The WPS System   12:31 Wednesday, October 24, 2018     

      File
      Name=/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/DTModel31DEC2015Ma
      rketScanSample.csv,
      Access Permissions=-rw-rw-r--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=0, Last Modified=12:32:35 Oct 24 2018,
      Created=12:32:35 Oct 24 2018, Lrecl=1174, Recfm=V

NOTE: 1799 records were written to file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/DTModel31DEC2015Market
      ScanSample.csv'
      The minimum record length was 152
      The maximum record length was 989
NOTE: 1798 observations were read from "TEMP.DTModel"
NOTE: The data step took :
      real time : 0.085
      cpu time  : 0.035


3253      FILENAME ##EXPOUT CLEAR;
3254      
3255      *** TREATMENT NAVIGATION ***;
3256      *** transpose the DxCat;
3257      data trash517_1(/*keep=enrolid svcdate DxCat DxStage*/ drop=dxcat1-dxcat4 dxstage1-dxs
3257    ! tage4 dx1-dx4 i);
3258      	set temp.SampleIPOPwDS1;	
3259      	array c[4] dxcat1  -dxcat4;
3260      	array s[4] dxstage1-dxstage4;
3261      	do i=1 to 4;
3262      		if
3263      			missing(c[i])=0 and
3264      			^(rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&Pr
3264    ! ocExclusionList.)))
3265      		then do;
3266      			DxCat=c[i];
3267      			DxStage=s[i];
3268      			output;
3269      		end;
3270      	end;
3271      run;

NOTE: 34163 observations were read from "TEMP.SampleIPOPwDS1"
NOTE: Data set "WORK.trash517_1" has 24926 observation(s) and 14 variable(s)
NOTE: The data step took :
      real time : 0.081
      cpu time  : 0.034


3272      
3273      *** Select patient who qualify as Treatment Navigation in the past 30 days;
3274      proc sql;
3275      
3276      create table trash517_2 as select distinct
101                                      The WPS System   12:31 Wednesday, October 24, 2018     

3277      	a.enrolid,
3278      	a.Dxcat,
3279      	b.condition
3280      from
3281      	trash517_1 as a
3282      inner join
3283      	temp.TreatmentNavigation as b
3284      on
3285      	a.DxCat=b.DxCat and
3286      	a.DxStage=b.stage
3287      where
3288      	svcdate > &StartDate. - 30;
NOTE: Data set "WORK.trash517_2" has 0 observation(s) and 3 variable(s)
3289      
3290      *** find the previous conditions for same dxcat and stage in the past year (366 days);
3291      create table trash517_3 as select distinct
3292      	a.enrolid,
3293      	b.condition
3294      from
3295      	trash517_1 as a
3296      inner join
3297      	temp.TreatmentNavigation as b
3298      on
3299      	a.DxCat=b.DxCat and
3300      	a.DxStage=b.stage
3301      where
3302      	&StartDate. - 30 >= svcdate > &StartDate. - 366;
NOTE: Data set "WORK.trash517_3" has 332 observation(s) and 2 variable(s)
3303      
3304      *** join with the new patients found previously;
3305      create table trash517_4 as select
3306      	a.*,
3307      	1-missing(b.condition) as FlagPriorTrNav
3308      from
3309      	trash517_2 as a
3310      left join
3311      	trash517_3 as b
3312      on
3313      	a.enrolid=b.enrolid and
3314      	a.condition=b.condition
3315      order by
3316      	a.enrolid,
3317      	a.DxCat;
NOTE: Data set "WORK.trash517_4" has 0 observation(s) and 4 variable(s)
3318      
3319      *** find the higher stages for any dxcat in the past 366 days;
3320      create table trash517_5 as select distinct
3321      	a.enrolid,
3322      	b.condition,
3323      	b.max_TrNavStage
3324      from
3325      	trash517_1 as a
3326      inner join
102                                      The WPS System   12:31 Wednesday, October 24, 2018     

3327      	(select distinct dxcat, condition, max(stage) as max_TrNavStage from temp.TreatmentNa
3327    ! vigation group by dxcat) as b
3328      on
3329      	a.DxCat=b.DxCat and
3330      	a.DxStage>b.max_TrNavStage
3331      where
3332      	svcdate > &StartDate. - 366;
NOTE: Summary results are required to be remerged with the original data
NOTE: View opening spill file for output observations.
NOTE: Data set "WORK.trash517_5" has 31 observation(s) and 3 variable(s)
3333      
3334      *** join with the new patients found previously									*************** <<<<<<<<------
3334    ! ---- Put all model+rules together;
3335      create table temp.TrNav as select distinct
3336      	a.enrolid,
3337      	1 as FlagTrNav,
3338      	4 as PopClass,
3339      	a.FlagPriorTrNav,
3340      	1-missing(b.max_TrNavStage) as FlagHigherStage
3341      from
3342      	trash517_4 as a
3343      left join
3344      	trash517_5 as b
3345      on
3346      	a.enrolid=b.enrolid and
3347      	a.condition=b.condition
3348      where
3349      	a.FlagPriorTrNav=0 and missing(b.max_TrNavStage)=1
3350      order by
3351      	a.enrolid;
NOTE: Data set "TEMP.TrNav" has 0 observation(s) and 5 variable(s)
3352      quit;
NOTE: Procedure sql step took :
      real time : 0.418
      cpu time  : 0.042


3353      
3354      proc export
3355      	data=temp.TrNav
3356      	outfile="&outpath./TreatmentNavigation&version..csv"
3357      	replace;
3358      run;
NOTE: Procedure export step took :
      real time : 0.000
      cpu time  : 0.000


3359      data _null_;
3360        file '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/TreatmentNa
3360    ! vigation31DEC2015MarketScanSample.csv' delimiter=',' DSD DROPOVER LRECL=80;
3361        format enrolid BEST12.;
3362        format FlagTrNav BEST12.;
103                                      The WPS System   12:31 Wednesday, October 24, 2018     

3363        format PopClass BEST12.;
3364        format FlagPriorTrNav BEST12.;
3365        format FlagHigherStage BEST12.;
3366        if _n_=1 then do;
3367            put
3368               'enrolid'        ','
3369               'FlagTrNav'        ','
3370               'PopClass'        ','
3371               'FlagPriorTrNav'        ','
3372               'FlagHigherStage';
3373          end;
3374        set temp.TrNav;
3375        put enrolid @;
3376        put FlagTrNav @;
3377        put PopClass @;
3378        put FlagPriorTrNav @;
3379        put FlagHigherStage;
3380      run;

NOTE: The file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/TreatmentNavigation31D
      EC2015MarketScanSample.csv' is:
      File
      Name=/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/TreatmentNavigatio
      n31DEC2015MarketScanSample.csv,
      Access Permissions=-rw-rw-r--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=0, Last Modified=12:32:36 Oct 24 2018,
      Created=12:32:36 Oct 24 2018, Lrecl=80, Recfm=V

NOTE: 1 record was written to file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/TreatmentNavigation31D
      EC2015MarketScanSample.csv'
      The minimum record length was 57
      The maximum record length was 57
NOTE: 0 observations were read from "TEMP.TrNav"
NOTE: The data step took :
      real time : 0.002
      cpu time  : 0.001


3381      FILENAME ##EXPOUT CLEAR;
3382      
3383      
3384      *** SURVEILLANCE ***;
3385      *** transpose the Dxcat + Stage to have one per record, also apply the exclusion crite
3385    ! ria;
3386      data trash518_1(keep=enrolid svcdate rec_type svcscat proc1 DxCat DxStage);
3387      	set temp.SampleIPOPwDS1;
3388      	where svcdate > &StartDate. - 90;	
3389      	array c[4] dxcat1  -dxcat4;
3390      	array s[4] dxstage1-dxstage4;
3391      	do i=1 to 4;
104                                      The WPS System   12:31 Wednesday, October 24, 2018     

3392      		if (rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&P
3392    ! rocExclusionList.))) then c[i]=' ';
3393      		if
3394      			(missing(c[i])=0 or missing(proc1)=0)
3395      		then do;
3396      			DxCat=c[i];
3397      			DxStage=s[i];
3398      			output;
3399      		end;
3400      	end;
3401      run;

NOTE: 9230 observations were read from "TEMP.SampleIPOPwDS1"
NOTE: Data set "WORK.trash518_1" has 34592 observation(s) and 7 variable(s)
NOTE: The data step took :
      real time : 0.048
      cpu time  : 0.025


3402      
3403      *** join the IP+OP data with HCPCxWalkPROCGRP to bring the PROCGRP codes;
3404      proc sql;
3405      create table trash518_2 as select
3406      	a.enrolid,
3407      	a.svcdate,
3408      	a.dxcat,
3409      	a.dxstage,
3410      	a.proc1,
3411      	a.svcscat,
3412      	a.rec_type,
3413      	b.ProcGRP
3414      from
3415      	trash518_1 as a
3416      left join
3417      	temp.HcpcXwalkGRP as b
3418      on
3419      	a.proc1=b.hcpc
3420      order by
3421      	a.enrolid;
NOTE: Data set "WORK.trash518_2" has 34592 observation(s) and 8 variable(s)
3422      quit;
NOTE: Procedure sql step took :
      real time : 0.311
      cpu time  : 0.159


3423      
3424      
3425      
3426      
3427      /* data trash518_2;
3428      set trash518_2;
3429      ProcGRP = put(ProcGRP,$6.);
105                                      The WPS System   12:31 Wednesday, October 24, 2018     

3430      run; */
3431      
3432      
3433      *** Modified ;
3434      *** create the flags for General Active Cancer;
3435      data trash518_3(keep=enrolid flag_GeneralActiveCancer);
3436      set trash518_2;	
3437      by enrolid;
3438      retain flag_SurvActiveCancerDxcat flag_SurvActiveCancerProcGRP 0;
3439      if first.enrolid then do;
3440      	flag_SurvActiveCancerDxcat=0;
3441      	flag_SurvActiveCancerProcGRP=0;
3442      end;
3443      if
3444      	put(dxcat,$SurvActiveCancerDxcat.)='Y'
3445      then
3446      	flag_SurvActiveCancerDxcat=1;
3447      if
3448      	put(dxcat,$SurvActiveCancerPxDxcat.)='Y'	or
3449      	/* put(ProcGRP,SurvActiveCancerPROCGRP.)='Y' */
3450      	put(ProcGRP,SurvActiveCancerPROCGRP.)='Y'
3451      then
3452      	flag_SurvActiveCancerProcGRP=1;
3453      flag_GeneralActiveCancer=flag_SurvActiveCancerDxcat * flag_SurvActiveCancerProcGRP;
3454      if last.enrolid and flag_SurvActiveCancerDxcat=1 and flag_SurvActiveCancerProcGRP=1 th
3454    ! en output;
3455      run;

NOTE: 34592 observations were read from "WORK.trash518_2"
NOTE: Data set "WORK.trash518_3" has 0 observation(s) and 2 variable(s)
NOTE: The data step took :
      real time : 0.065
      cpu time  : 0.035


3456      
3457      
3458      *** Works so far ***;
3459      
3460      
3461      
3462      /* data trash518_2;
3463      set trash518_2;
3464      ProcGRP = put(ProcGRP,$18.);
3465      run; */
3466      
3467      *** join with the Specific Cancer by Dxcat;
3468      proc sql;
3469      create table trash518_4 as select distinct
3470      	a.enrolid,
3471      	a.dxcat,
3472      	b.PROCGRP as ProcGRP_Specific
3473      from
106                                      The WPS System   12:31 Wednesday, October 24, 2018     

3474      	trash518_2 as a
3475      inner join
3476      	temp.SurvSpecificActiveCancer as b
3477      on
3478      	a.dxcat=b.dxcat and
3479      	a.dxstage>=b.stage;
NOTE: Data set "WORK.trash518_4" has 0 observation(s) and 3 variable(s)
3480      
3481      *** join with the Specific Cancer by PROCGRP;
NOTE: Procedure sql step took :
      real time : 0.036
      cpu time  : 0.004


3482      proc sql;
3483      create table trash518_5 as select distinct
3484      	a.enrolid,
3485      	a.PROCGRP
3486      from
3487      	trash518_2 as a
3488      inner join
3489      	temp.SurvSpecificActiveCancer as b
3490      on
3491      	a.procgrp=b.procgrp;
NOTE: Data set "WORK.trash518_5" has 13 observation(s) and 2 variable(s)
3492      
3493      
3494      
3495      *** Create Flag for Specific Active Cancer (join the previous selected based on DxCat 
3495    ! with Specific Cancer by PROCGRP);
NOTE: Procedure sql step took :
      real time : 0.037
      cpu time  : 0.008


3496      proc sql;
3497      create table trash518_6 as select distinct
3498      	a.enrolid,
3499      	1 as flag_SpecificActiveCancer
3500      from
3501      	trash518_4 as a
3502      inner join
3503      	trash518_5 as b
3504      on
3505      	a.enrolid=b.enrolid and
3506      	a.ProcGRP_Specific=b.ProcGRP
3507      order by
3508      	a.enrolid;
NOTE: Data set "WORK.trash518_6" has 0 observation(s) and 2 variable(s)
3509      
3510      *** Flag for Miscellaneous DRG;
NOTE: Procedure sql step took :
      real time : 0.018
107                                      The WPS System   12:31 Wednesday, October 24, 2018     

      cpu time  : 0.002


3511      proc sql;
3512      create table trash518_7 as select distinct
3513      	enrolid,
3514      	1 as flag_Miscellaneous
3515      from
3516      	temp.SampleInp1 		as a
3517      inner join
3518      	temp.SurvMiscellaneous	as b
3519      on
3520      	a.DRG=b.Code and
3521      	b.CodeType='DRG' and
3522      	a.admdate > &StartDate. - 90
3523      order by
3524      	enrolid;
NOTE: Data set "WORK.trash518_7" has 1 observation(s) and 2 variable(s)
3525      
3526      *** PROC CONTENTS DATA=temp.SampleRx1;RUN;
NOTE: RUN has no effect in proc sql as all statements are executed immediately.
3527      
3528      *** PROC CONTENTS DATA=temp.SurvChemoActive;RUN;
NOTE: RUN has no effect in proc sql as all statements are executed immediately.
3529      
3530      *** Modified ;
3531      *** convert NDCNUM to character for table;
NOTE: Procedure sql step took :
      real time : 0.024
      cpu time  : 0.002


3532      data temp.SurvChemoActive(drop=ndc_old);
3533      set temp.SurvChemoActive(rename=(ndc=ndc_old));
3534      ndc=put(ndc_old,z11.);
3535      run;

NOTE: 308 observations were read from "TEMP.SurvChemoActive"
NOTE: Data set "TEMP.SurvChemoActive" has 308 observation(s) and 9 variable(s)
NOTE: The data step took :
      real time : 0.011
      cpu time  : 0.001


3536      
3537      *** Modified ;
3538      *** convert NDCNUM to character for table;
3539      data temp.SurvChemoChronic(drop=ndc_old);
3540      set temp.SurvChemoChronic(rename=(ndc=ndc_old));
3541      ndc=put(ndc_old,z11.);
3542      run;

NOTE: 546 observations were read from "TEMP.SurvChemoChronic"
108                                      The WPS System   12:31 Wednesday, October 24, 2018     

NOTE: Data set "TEMP.SurvChemoChronic" has 546 observation(s) and 9 variable(s)
NOTE: The data step took :
      real time : 0.012
      cpu time  : 0.001


3543      
3544      
3545      
3546      *** select from ChemoActive;
3547      proc sql;
3548      create table trash518_8 as select distinct
3549      	enrolid,
3550      	1 as flag_ChemoActive
3551      from
3552      	temp.SampleRx1 			as a
3553      inner join
3554      	temp.SurvChemoActive	as b
3555      on
3556      	a.ndcnum=b.ndc and
3557      	a.svcdate > &StartDate. - 90
3558      order by
3559      	enrolid;
NOTE: Data set "WORK.trash518_8" has 3 observation(s) and 2 variable(s)
3560      
3561      *** select from ChemoChronic;
NOTE: Procedure sql step took :
      real time : 0.040
      cpu time  : 0.007


3562      proc sql;
3563      create table trash518_9 as select distinct
3564      	enrolid
3565      from
3566      	temp.SampleRx1 			as a
3567      inner join
3568      	temp.SurvChemoChronic	as b
3569      on
3570      	a.ndcnum=b.ndc and
3571      	a.svcdate > &StartDate. - 90;
NOTE: Data set "WORK.trash518_9" has 3 observation(s) and 1 variable(s)
NOTE: Procedure sql step took :
      real time : 0.032
      cpu time  : 0.007


3572      proc sql;
3573      create table trash518_10 as select distinct
3574      	enrolid
3575      from
3576      	temp.SampleRx1 			as a
3577      inner join
109                                      The WPS System   12:31 Wednesday, October 24, 2018     

3578      	temp.SurvChemoChronic	as b
3579      on
3580      	a.ndcnum=b.ndc and
3581      	a.svcdate <= &StartDate. - 90;
NOTE: Data set "WORK.trash518_10" has 3 observation(s) and 1 variable(s)
NOTE: Procedure sql step took :
      real time : 0.048
      cpu time  : 0.007


3582      proc sql;
3583      create table trash518_11 as select distinct
3584      	a.enrolid,
3585      	1 as flag_ChemoChronic
3586      from
3587      	trash518_9 	as a
3588      left join
3589      	trash518_10	as b
3590      on
3591      	a.enrolid=b.enrolid
3592      where
3593      	a.enrolid ne b.enrolid
3594      order by
3595      	a.enrolid;
NOTE: Data set "WORK.trash518_11" has 1 observation(s) and 2 variable(s)
3596      
3597      *** put them all together for Surveillance													*************** <<<<<<<<-------
3597    ! --- Put all model+rules together;
NOTE: Procedure sql step took :
      real time : 0.033
      cpu time  : 0.002


3598      data temp.Surv;
3599      merge
3600      	trash518_3
3601      	trash518_6
3602      	trash518_7
3603      	trash518_8
3604      	trash518_11;
3605      by enrolid;
3606      FlagSurv=1;
3607      PopClass=9;
3608      run;

NOTE: 0 observations were read from "WORK.trash518_3"
NOTE: 0 observations were read from "WORK.trash518_6"
NOTE: 1 observations were read from "WORK.trash518_7"
NOTE: 3 observations were read from "WORK.trash518_8"
NOTE: 1 observations were read from "WORK.trash518_11"
NOTE: Data set "TEMP.Surv" has 5 observation(s) and 8 variable(s)
NOTE: The data step took :
      real time : 0.011
110                                      The WPS System   12:31 Wednesday, October 24, 2018     

      cpu time  : 0.002


3609      
3610      proc export
3611      	data=temp.Surv
3612      	outfile="&outpath./Surveillance&version..csv"
3613      	replace;
3614      run;
NOTE: Procedure export step took :
      real time : 0.000
      cpu time  : 0.000


3615      data _null_;
3616        file '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/Surveillanc
3616    ! e31DEC2015MarketScanSample.csv' delimiter=',' DSD DROPOVER LRECL=160;
3617        format enrolid BEST12.;
3618        format flag_GeneralActiveCancer BEST12.;
3619        format flag_SpecificActiveCancer BEST12.;
3620        format flag_Miscellaneous BEST12.;
3621        format flag_ChemoActive BEST12.;
3622        format flag_ChemoChronic BEST12.;
3623        format FlagSurv BEST12.;
3624        format PopClass BEST12.;
3625        if _n_=1 then do;
3626            put
3627               'enrolid'        ','
3628               'flag_GeneralActiveCancer'        ','
3629               'flag_SpecificActiveCancer'        ','
3630               'flag_Miscellaneous'        ','
3631               'flag_ChemoActive'        ','
3632               'flag_ChemoChronic'        ','
3633               'FlagSurv'        ','
3634               'PopClass';
3635          end;
3636        set temp.Surv;
3637        put enrolid @;
3638        put flag_GeneralActiveCancer @;
3639        put flag_SpecificActiveCancer @;
3640        put flag_Miscellaneous @;
3641        put flag_ChemoActive @;
3642        put flag_ChemoChronic @;
3643        put FlagSurv @;
3644        put PopClass;
3645      run;

NOTE: The file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/Surveillance31DEC2015M
      arketScanSample.csv' is:
      File
      Name=/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/Surveillance31DEC2
      015MarketScanSample.csv,
111                                      The WPS System   12:31 Wednesday, October 24, 2018     

      Access Permissions=-rw-rw-r--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=0, Last Modified=12:32:37 Oct 24 2018,
      Created=12:32:37 Oct 24 2018, Lrecl=160, Recfm=V

NOTE: 6 records were written to file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/Surveillance31DEC2015M
      arketScanSample.csv'
      The minimum record length was 18
      The maximum record length was 130
NOTE: 5 observations were read from "TEMP.Surv"
NOTE: The data step took :
      real time : 0.004
      cpu time  : 0.001


3646      FILENAME ##EXPOUT CLEAR;
3647      
3648      
3649      *** REBALANCE ***;
3650      
3651      *** transpose the Dxcat + Stage to have one per record, also apply the exclusion crite
3651    ! ria. Similar to 518_1 and 518_2 but save ICD9 too;
3652      data trash519_1(keep=enrolid svcdate svcscat Dx DxCat DxStage fac_prof proc1 rec_type)
3652    ! ;
3653      	set temp.SampleIPOPwDS1;
3654      	array d[4] dx1-dx4;
3655      	array c[4] dxcat1  -dxcat4;
3656      	array s[4] dxstage1-dxstage4;
3657      	do i=1 to 4;
3658      		if (rec_type='O' and (substr(svcscat,4,2) in (&SvcCatExclusionList.) or proc1 in (&P
3658    ! rocExclusionList.))) then do;
3659      			c[i]=' ';
3660      			d[i]=' ';
3661      		end;
3662      		if
3663      			(missing(c[i])=0 or missing(proc1)=0 or missing(d[i])=0)
3664      		then do;
3665      			DxCat=c[i];
3666      			DxStage=s[i];
3667      			Dx=d[i];
3668      			output;
3669      		end;
3670      	end;
3671      run;

NOTE: 34163 observations were read from "TEMP.SampleIPOPwDS1"
NOTE: Data set "WORK.trash519_1" has 129123 observation(s) and 9 variable(s)
NOTE: The data step took :
      real time : 0.180
      cpu time  : 0.097


112                                      The WPS System   12:31 Wednesday, October 24, 2018     

3672      
3673      *** join the IP+OP data with HCPCxWalkPROCGRP to bring the PROCGRP codes, same as 518_
3673    ! 2;
3674      proc sql;
3675      create table trash519_2 as select
3676      	a.enrolid,
3677      	a.svcdate,
3678      	a.dx,
3679      	a.dxcat,
3680      	a.dxstage,
3681      	a.proc1,
3682      	a.svcscat,
3683      	a.rec_type,
3684      	a.fac_prof,
3685      	b.ProcGRP
3686      from
3687      	trash519_1 as a
3688      left join
3689      	temp.HcpcXwalkGRP as b
3690      on
3691      	a.proc1=b.hcpc
3692      order by
3693      	a.enrolid;
NOTE: Data set "WORK.trash519_2" has 129123 observation(s) and 10 variable(s)
3694      quit;
NOTE: Procedure sql step took :
      real time : 1.102
      cpu time  : 0.369


3695      
3696      
3697      *** PROC CONTENTS DATA=trash519_2;RUN;
3698      
3699      *** PROC CONTENTS DATA=temp.SampleInp1;RUN;
3700      
3701      *** Rebalance based on a condition being present in the last 90 days regardless of pri
3701    ! or claims                                    <<<------ for REBALANCE final merge;
3702      proc sql;
3703      create table trash519_3 as select distinct *
3704      from
3705      /* based on PSY in ER or certain DxCats from both inp and otp */
3706      	(select distinct
3707      		enrolid,
3708      		1 as flag_NewCondNoHistCheck
3709      	from trash519_2
3710      	where
3711      		svcdate > &StartDate. - 90																		and			
3712      		(((DxCat in (&ConditionDxCat.) and DxStage >= &ConditionDxCatStage.) 						or
3713      		(substr(DxCat,1,3) in (&ConditionDxCatER.) and fac_prof='F' and	substr(svcscat,4,2)=
3713    ! "20")) 	 or
3714      		 procGRP in (&ConditionProcGRP.)))
3715      union
113                                      The WPS System   12:31 Wednesday, October 24, 2018     

3716      /* based on DRG and mental admissions from inpatient data */
3717      	(select distinct
3718      		enrolid,
3719      		1 as flag_Cond
3720      	from temp.SampleInp1
3721      	where
3722      		disdate >= &StartDate. - 90				and
3723      		(put(drg,z3.) in (&ConditionDRG.)		or
3724      		 admtyp in (&ConditionAdminType.)))
3725      
3726      order by
3727      	enrolid;
NOTE: View opening spill file for output observations.
NOTE: Data set "WORK.trash519_3" has 3 observation(s) and 2 variable(s)
3728      quit;
NOTE: Procedure sql step took :
      real time : 0.128
      cpu time  : 0.025


3729      
3730      
3731      *** Rebalance based on new DxCat in the past 30 days AND there were not present before
3731    ! ;
3732      proc sql;
3733      
3734      * identify all patients who match the list of new DxCat in the past 90 days, keep the 
3734    ! first day of the encounter for future use with the exclusion of the Rx drugs;
3735      create table trash519_4 as select
3736      	a.enrolid,
3737      	a.DxCat,
3738      	min(a.svcdate) as FirstDate format=date7.
3739      from
3740      	trash519_1 as a,
3741      	temp.RebalanceNewDxCat as b
3742      where
3743      	a.DxCat=b.DxCat 				and
3744      	a.DxStage>=b.Stage			and
3745      	a.svcdate > &StartDate. - 90
3746      group by
3747      	a.enrolid,
3748      	a.DxCat;
NOTE: Data set "WORK.trash519_4" has 0 observation(s) and 3 variable(s)
3749      * identify all patients who match the list of new DxCat in the past year, before 90 da
3749    ! ys, in order to exclude them when matching with the new ones;
3750      create table trash519_5 as select distinct
3751      	a.enrolid,
3752      	a.DxCat
3753      from
3754      	trash519_1 as a,
3755      	temp.RebalanceNewDxCat as b
3756      where
3757      	a.DxCat=b.DxCat 				and
114                                      The WPS System   12:31 Wednesday, October 24, 2018     

3758      	a.DxStage>=b.StageHistory		and
3759      	a.svcdate <= &StartDate. - 90
3760      order by
3761      	a.enrolid,
3762      	a.DxCat;
NOTE: Data set "WORK.trash519_5" has 181 observation(s) and 2 variable(s)
3763      * exclude the patients if they match on the the Rollup of the DxCat (first 3 character
3763    ! s) if they are in both recent 90 days and past 90 days;
3764      create table trash519_6 as select distinct
3765      	a.enrolid
3766      from
3767      	trash519_4 as a
3768      left join
3769      	trash519_5 as b
3770      on
3771      	a.enrolid=b.enrolid and
3772      	substr(a.DxCat,1,3)=substr(b.DxCat,1,3)
3773      where
3774      	substr(a.DxCat,1,3)^=substr(b.DxCat,1,3)
3775      order by
3776      	enrolid;
NOTE: Data set "WORK.trash519_6" has 0 observation(s) and 1 variable(s)
3777      
3778      * select all the claims mathcing the Rx by Therapeutic Class;
3779      create table trash519_7 as select distinct
3780      	a.enrolid,
3781      	a.svcdate format=date7.,
3782      	a.thercls,
3783      	b.DxCat
3784      from
3785      	temp.SampleRx1 as a,
3786      	temp.RebalanceNewDxCatwoRx as b
3787      where
3788      	a.thercls=b.thercls
3789      order by
3790      	a.enrolid,
3791      	a.svcdate;
NOTE: Data set "WORK.trash519_7" has 1672 observation(s) and 4 variable(s)
3792      * match the drug claims with the patients identified with the new DxCats based on the 
3792    ! Dxcat from the exlcusion Rx logic, if the drug is 90 days before the first encounter o
3792    ! f DxCAt then flag it;
3793      create table trash519_8 as select
3794      	a.*,
3795      	b.svcdate,
3796      	b.thercls,
3797      	case when a.FirstDate - b.svcdate > 90 then 1 else 0 end as flag_RxlogicExclude
3798      from
3799      	trash519_4 as a
3800      left join
3801      	trash519_7 as b
3802      on
3803      	a.enrolid=b.enrolid and
3804      	a.DxCat=b.DxCat
115                                      The WPS System   12:31 Wednesday, October 24, 2018     

3805      order by
3806      	a.enrolid,
3807      	a.DxCat,
3808      	b.SvcDate;
NOTE: Data set "WORK.trash519_8" has 0 observation(s) and 6 variable(s)
3809      * keep only the patients that need to be excluded, having at least a flag of 1;
3810      create table trash519_9 as select
3811      	enrolid
3812      from
3813      	trash519_8
3814      group by
3815      	enrolid
3816      having
3817      	max(flag_RxlogicExclude)=1;
NOTE: Data set "WORK.trash519_9" has 0 observation(s) and 1 variable(s)
3818      * exclude the patients with drugs in the past year                                   <
3818    ! <<------ for REBALANCE final merge;
3819      create table trash519_10 as select distinct
3820      	a.enrolid,
3821      	1 as flag_NewCondDxCat
3822      from
3823      	trash519_6 as a
3824      left join
3825      	trash519_9 as b
3826      on
3827      	a.enrolid=b.enrolid
3828      where
3829      	a.enrolid^=b.enrolid
3830      order by
3831      	enrolid;
NOTE: Data set "WORK.trash519_10" has 0 observation(s) and 2 variable(s)
3832      quit;
NOTE: Procedure sql step took :
      real time : 0.286
      cpu time  : 0.048


3833      
3834      *** Modified ;
3835      * Rebalance based on new DRG in the past 30 days and no prior history;
3836      proc sql;
3837      * select all members with matching of rebalance new DRG in the past 90 days;
3838      create table trash519_11 as select distinct
3839      	a.enrolid,
3840      	b.description
3841      from
3842      	temp.SampleInp1 as a
3843      inner join
3844      	temp.RebalanceNewDRG as b
3845      on
3846      	/* put(a.drg,z3.)=b.drg */
3847      	   a.drg = b.drg
3848      where
116                                      The WPS System   12:31 Wednesday, October 24, 2018     

3849      	a.disdate > &StartDate. - 90
3850      order by
3851      	a.enrolid;
NOTE: Data set "WORK.trash519_11" has 4 observation(s) and 2 variable(s)
3852      * select all members with prior history of rebalance new DRG;
3853      create table trash519_12 as select distinct
3854      	a.enrolid,
3855      	b.description
3856      from
3857      	temp.SampleInp1 as a
3858      inner join
3859      	temp.RebalanceNewDRG as b
3860      on
3861      	/*put(a.drg,z3.)=b.drg */
3862      	a.drg = b.drg
3863      where
3864      	a.disdate <= &StartDate. - 90
3865      order by
3866      	a.enrolid;
NOTE: Data set "WORK.trash519_12" has 2 observation(s) and 2 variable(s)
3867      * exclude the patients with DRG in the past                                   <<<-----
3867    ! - for REBALANCE final merge;
3868      create table trash519_13 as select distinct
3869      	a.enrolid,
3870      	1 as flag_NewCondDRG
3871      from
3872      	trash519_11 as a
3873      left join
3874      	trash519_12 as b
3875      on
3876      	a.enrolid=b.enrolid and
3877      	a.description=b.description
3878      where
3879      	a.enrolid^=b.enrolid
3880      order by
3881      	enrolid;
NOTE: Data set "WORK.trash519_13" has 4 observation(s) and 2 variable(s)
3882      quit;
NOTE: Procedure sql step took :
      real time : 0.200
      cpu time  : 0.023


3883      
3884      
3885      *** PROC CONTENTS DATA=trash519_1;RUN;
3886      *** PROC PRINT DATA=trash519_1(OBS=40);RUN;
3887      *** PROC CONTENTS DATA=temp.RebalanceNewDx;RUN;
3888      *** PROC PRINT DATA=temp.RebalanceNewDx(OBS=40);RUN;
3889      
3890      
3891      
3892      * Rebalance based on new Dx in the past 30 days and no prior history;
117                                      The WPS System   12:31 Wednesday, October 24, 2018     

3893      proc sql;
3894      * select all members with matching of rebalance new Dx in the past 90 days;
3895      create table trash519_14 as select distinct
3896      	a.enrolid,
3897      	b.description
3898      from
3899      	trash519_1 as a
3900      inner join
3901      	temp.RebalanceNewDx as b
3902      on
3903      	substr(a.dx,1,4)=b.icd
3904      where
3905      	a.svcdate > &StartDate. - 90
3906      order by
3907      	a.enrolid;
NOTE: Data set "WORK.trash519_14" has 0 observation(s) and 2 variable(s)
3908      * select all members with prior history of rebalance new Dx;
3909      create table trash519_15 as select distinct
3910      	a.enrolid,
3911      	b.description
3912      from
3913      	trash519_1 as a
3914      inner join
3915      	temp.RebalanceNewDx as b
3916      on
3917      	substr(a.dx,1,4)=b.icd
3918      where
3919      	a.svcdate <= &StartDate. - 90
3920      order by
3921      	a.enrolid;
NOTE: Data set "WORK.trash519_15" has 3 observation(s) and 2 variable(s)
3922      * exclude the patients with DRG in the past                                   <<<-----
3922    ! - for REBALANCE final merge;
3923      create table trash519_16 as select distinct
3924      	a.enrolid,
3925      	1 as flag_NewCondDx
3926      from
3927      	trash519_14 as a
3928      left join
3929      	trash519_15 as b
3930      on
3931      	a.enrolid=b.enrolid and
3932      	a.description=b.description
3933      where
3934      	a.enrolid^=b.enrolid
3935      order by
3936      	enrolid;
NOTE: Data set "WORK.trash519_16" has 0 observation(s) and 2 variable(s)
3937      
3938      *** put all REBALANCE pieces together													*************** <<<<<<<<---------- P
3938    ! ut all model+rules together;
NOTE: Procedure sql step took :
      real time : 0.175
118                                      The WPS System   12:31 Wednesday, October 24, 2018     

      cpu time  : 0.042


3939      data temp.Rebalance;
3940      merge
3941      	trash519_3
3942      	trash519_10
3943      	trash519_13
3944      	trash519_16;
3945      by enrolid;
3946      FlagRebalance=1;
3947      PopClass=8;
3948      run;

NOTE: 3 observations were read from "WORK.trash519_3"
NOTE: 0 observations were read from "WORK.trash519_10"
NOTE: 4 observations were read from "WORK.trash519_13"
NOTE: 0 observations were read from "WORK.trash519_16"
NOTE: Data set "TEMP.Rebalance" has 6 observation(s) and 7 variable(s)
NOTE: The data step took :
      real time : 0.013
      cpu time  : 0.002


3949      
3950      proc export
3951      	data=temp.Rebalance
3952      	outfile="&outpath./Rebalance&version..csv"
3953      	replace;
3954      run;
NOTE: Procedure export step took :
      real time : 0.000
      cpu time  : 0.000


3955      data _null_;
3956        file '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/Rebalance31
3956    ! DEC2015MarketScanSample.csv' delimiter=',' DSD DROPOVER LRECL=127;
3957        format enrolid BEST12.;
3958        format flag_NewCondNoHistCheck BEST12.;
3959        format flag_NewCondDxCat BEST12.;
3960        format flag_NewCondDRG BEST12.;
3961        format flag_NewCondDx BEST12.;
3962        format FlagRebalance BEST12.;
3963        format PopClass BEST12.;
3964        if _n_=1 then do;
3965            put
3966               'enrolid'        ','
3967               'flag_NewCondNoHistCheck'        ','
3968               'flag_NewCondDxCat'        ','
3969               'flag_NewCondDRG'        ','
3970               'flag_NewCondDx'        ','
3971               'FlagRebalance'        ','
119                                      The WPS System   12:31 Wednesday, October 24, 2018     

3972               'PopClass';
3973          end;
3974        set temp.Rebalance;
3975        put enrolid @;
3976        put flag_NewCondNoHistCheck @;
3977        put flag_NewCondDxCat @;
3978        put flag_NewCondDRG @;
3979        put flag_NewCondDx @;
3980        put FlagRebalance @;
3981        put PopClass;
3982      run;

NOTE: The file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/Rebalance31DEC2015Mark
      etScanSample.csv' is:
      File
      Name=/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/Rebalance31DEC2015
      MarketScanSample.csv,
      Access Permissions=-rw-rw-r--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=0, Last Modified=12:32:39 Oct 24 2018,
      Created=12:32:39 Oct 24 2018, Lrecl=127, Recfm=V

NOTE: 7 records were written to file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/Rebalance31DEC2015Mark
      etScanSample.csv'
      The minimum record length was 18
      The maximum record length was 103
NOTE: 6 observations were read from "TEMP.Rebalance"
NOTE: The data step took :
      real time : 0.005
      cpu time  : 0.001


3983      FILENAME ##EXPOUT CLEAR;
3984      
3985      
3986      *** Newborn in the past month by default in Engagement DRG 790 - 795;					************
3986    ! *** <<<<<<<<---------- Put all model+rules together;
3987      proc sql;
3988      * select all members with matching of rebalance new DRG in the past 90 days;
3989      create table temp.Neonates as select distinct
3990      	enrolid,
3991      	DRG,
3992      	1 as FlagNeoNate,
3993      	2 as PopCLass
3994      from
3995      	temp.SampleInp1 as a
3996      where
3997      	admdate > &StartDate. - 30 and
3998      	drg in (&NeonatesDRGList.)
3999      order by
4000      	enrolid;
120                                      The WPS System   12:31 Wednesday, October 24, 2018     

NOTE: Data set "TEMP.Neonates" has 1 observation(s) and 4 variable(s)
4001      
4002      *** Newborn in the past month by default in Engagement DRG 790 - 795;					************
4002    ! *** <<<<<<<<---------- Put all model+rules together;
NOTE: Procedure sql step took :
      real time : 0.050
      cpu time  : 0.003


4003      proc sql;
4004      * select all members with matching of rebalance new DRG in the past 90 days;
4005      create table temp.Neonates as select distinct
4006      	enrolid,
4007      	DRG,
4008      	1 as FlagNeoNate,
4009      	2 as PopCLass
4010      from
4011      	temp.SampleInp1 as a
4012      where
4013      	admdate > &StartDate. - 30 and
4014      	drg in (&NeonatesDRGList.)
4015      order by
4016      	enrolid;
NOTE: Data set "TEMP.Neonates" has 1 observation(s) and 4 variable(s)
NOTE: Procedure sql step took :
      real time : 0.038
      cpu time  : 0.002


4017      
4018      proc export
4019      	data=temp.NeoNates
4020      	outfile="&outpath./Neonates&version..csv"
4021      	replace;
4022      run;
NOTE: Procedure export step took :
      real time : 0.000
      cpu time  : 0.000


4023      data _null_;
4024        file '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/Neonates31D
4024    ! EC2015MarketScanSample.csv' delimiter=',' DSD DROPOVER LRECL=60;
4025        format ENROLID BEST12.;
4026        format DRG BEST12.;
4027        format FlagNeoNate BEST12.;
4028        format PopCLass BEST12.;
4029        if _n_=1 then do;
4030            put
4031               'ENROLID'        ','
4032               'DRG'        ','
4033               'FlagNeoNate'        ','
4034               'PopCLass';
121                                      The WPS System   12:31 Wednesday, October 24, 2018     

4035          end;
4036        set temp.NeoNates;
4037        put ENROLID @;
4038        put DRG @;
4039        put FlagNeoNate @;
4040        put PopCLass;
4041      run;

NOTE: The file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/Neonates31DEC2015Marke
      tScanSample.csv' is:
      File
      Name=/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/Neonates31DEC2015M
      arketScanSample.csv,
      Access Permissions=-rw-rw-r--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=0, Last Modified=12:32:39 Oct 24 2018,
      Created=12:32:39 Oct 24 2018, Lrecl=60, Recfm=V

NOTE: 2 records were written to file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/Neonates31DEC2015Marke
      tScanSample.csv'
      The minimum record length was 17
      The maximum record length was 32
NOTE: 1 observations were read from "TEMP.NeoNates"
NOTE: The data step took :
      real time : 0.010
      cpu time  : 0.001


4042      FILENAME ##EXPOUT CLEAR;
4043      
4044      
4045      
4046      /*********************/
4047      /*** FINAL OUTPUT ***/
4048      /*********************/
4049      *** MERGE All the RULES from SPSS Modela and Janet's logic rules together ***;
4050      proc sql;
4051      create table temp.AllRules as select
4052      	a.*,
4053      	put(a.PopClass,categories.) as PopClassDTModelDescription,
4054      	max(a.PopClass,b.PopClass) as PopClassFinal,
4055      	put(calculated PopClassFinal,categories.) as PopClassFinalDescription,
4056      	case when b.PopClass > a.PopCLass then 1 else 0 end as FlagOverwrite
4057      from
4058      	temp.DTModel as a
4059      left join
4060      	(select
4061      		enrolid,
4062      		max(PopClass) as PopClass
4063      	from
4064      		(select enrolid, PopClass from temp.TrNav union
122                                      The WPS System   12:31 Wednesday, October 24, 2018     

4065      		 select enrolid, PopClass from temp.Surv union
4066      		 select enrolid, PopClass from temp.Rebalance union
4067      		 select enrolid, PopClass from temp.Neonates)
4068      	group by enrolid) as b
4069      on
4070      	a.enrolid=b.enrolid
4071      order by enrolid;
NOTE: View opening spill file for output observations.
NOTE: View opening spill file for output observations.
NOTE: Data set "TEMP.AllRules" has 1798 observation(s) and 67 variable(s)
4072      quit;
NOTE: Procedure sql step took :
      real time : 0.831
      cpu time  : 0.060


4073      proc export
4074      	data=temp.AllRules
4075      	outfile="&outpath./AllRules&version..csv"
4076      	replace;
4077      run;
NOTE: Procedure export step took :
      real time : 0.001
      cpu time  : 0.000


4078      data _null_;
4079        file '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/AllRules31D
4079    ! EC2015MarketScanSample.csv' delimiter=',' DSD DROPOVER LRECL=1262;
4080        format ENROLID BEST12.;
4081        format Count3mOV BEST12.;
4082        format Count12mOV BEST12.;
4083        format Count3mOVChronic BEST12.;
4084        format Count6mOVChronic BEST12.;
4085        format Count3mOVChronicSpecialist BEST12.;
4086        format Count6mOVChronicSpecialist BEST12.;
4087        format Count3mOVSpecialties BEST12.;
4088        format Count3mOVChronicSpecialties BEST12.;
4089        format Count3mER BEST12.;
4090        format Count12mER BEST12.;
4091        format Count3mERChronic BEST12.;
4092        format Count6mERChronic BEST12.;
4093        format DaysER BEST12.;
4094        format DaysMajorER BEST12.;
4095        format DaysHH BEST12.;
4096        format DaysMajorSurg BEST12.;
4097        format DaysOxygen BEST12.;
4098        format Days3mLTC BEST12.;
4099        format flag3mLTC BEST12.;
4100        format CountAdm3mAll BEST12.;
4101        format CountAdm3mChronic BEST12.;
4102        format CountAdm6mAll BEST12.;
4103        format CountAdm6mChronic BEST12.;
123                                      The WPS System   12:31 Wednesday, October 24, 2018     

4104        format SumLOS3mAll BEST12.;
4105        format DaysAnyAdm BEST12.;
4106        format DaysChronicAdm BEST12.;
4107        format DaysSurgAdm BEST12.;
4108        format DaysMedicalAdm BEST12.;
4109        format DaysMtrntyAdm BEST12.;
4110        format DaysMHSAAdm BEST12.;
4111        format FlagChronicRx BEST12.;
4112        format FlagNewChronicRx BEST12.;
4113        format CountDaysSupp3m BEST12.;
4114        format CountDaysSupp6m BEST12.;
4115        format CountDaysSuppChronic3m BEST12.;
4116        format CountDaysSuppChronic6m BEST12.;
4117        format CountDaysSuppOpiates3m BEST12.;
4118        format CountDaysSuppOpiates6m BEST12.;
4119        format CountTherClass3m BEST12.;
4120        format CountTherClass6m BEST12.;
4121        format CountTherClassChronic3m BEST12.;
4122        format CountTherClassChronic6m BEST12.;
4123        format flag12mMHSA BEST12.;
4124        format flag3mGYN BEST12.;
4125        format Count3mAcuteStage3 BEST12.;
4126        format Count3mChronicStage3 BEST12.;
4127        format Count6mChronicStage3 BEST12.;
4128        format Count3mAcuteSign BEST12.;
4129        format Count3mChronicSign BEST12.;
4130        format Count6mChronicSign BEST12.;
4131        format Count12mChronicSign BEST12.;
4132        format Count3mAcute BEST12.;
4133        format Count6mAcute BEST12.;
4134        format Count3mChronic BEST12.;
4135        format Count12mChronic BEST12.;
4136        format Count3mBody BEST12.;
4137        format Count3mBodySign BEST12.;
4138        format flag3mNewChronicSign BEST12.;
4139        format Days3mStage3 BEST12.;
4140        format PopClass BEST12.;
4141        format Rule BEST12.;
4142        format RuleConfidence BEST12.;
4143        format PopClassDTModelDescription $20.;
4144        format PopClassFinal BEST12.;
4145        format PopClassFinalDescription $20.;
4146        format FlagOverwrite BEST12.;
4147        if _n_=1 then do;
4148            put
4149               'ENROLID'        ','
4150               'Count3mOV'        ','
4151               'Count12mOV'        ','
4152               'Count3mOVChronic'        ','
4153               'Count6mOVChronic'        ','
4154               'Count3mOVChronicSpecialist'        ','
4155               'Count6mOVChronicSpecialist'        ','
4156               'Count3mOVSpecialties'        ','
124                                      The WPS System   12:31 Wednesday, October 24, 2018     

4157               'Count3mOVChronicSpecialties'        ','
4158               'Count3mER'        ','
4159               'Count12mER'        ','
4160               'Count3mERChronic'        ','
4161               'Count6mERChronic'        ','
4162               'DaysER'        ','
4163               'DaysMajorER'        ','
4164               'DaysHH'        ','
4165               'DaysMajorSurg'        ','
4166               'DaysOxygen'        ','
4167               'Days3mLTC'        ','
4168               'flag3mLTC'        ','
4169               'CountAdm3mAll'        ','
4170               'CountAdm3mChronic'        ','
4171               'CountAdm6mAll'        ','
4172               'CountAdm6mChronic'        ','
4173               'SumLOS3mAll'        ','
4174               'DaysAnyAdm'        ','
4175               'DaysChronicAdm'        ','
4176               'DaysSurgAdm'        ','
4177               'DaysMedicalAdm'        ','
4178               'DaysMtrntyAdm'        ','
4179               'DaysMHSAAdm'        ','
4180               'FlagChronicRx'        ','
4181               'FlagNewChronicRx'        ','
4182               'CountDaysSupp3m'        ','
4183               'CountDaysSupp6m'        ','
4184               'CountDaysSuppChronic3m'        ','
4185               'CountDaysSuppChronic6m'        ','
4186               'CountDaysSuppOpiates3m'        ','
4187               'CountDaysSuppOpiates6m'        ','
4188               'CountTherClass3m'        ','
4189               'CountTherClass6m'        ','
4190               'CountTherClassChronic3m'        ','
4191               'CountTherClassChronic6m'        ','
4192               'flag12mMHSA'        ','
4193               'flag3mGYN'        ','
4194               'Count3mAcuteStage3'        ','
4195               'Count3mChronicStage3'        ','
4196               'Count6mChronicStage3'        ','
4197               'Count3mAcuteSign'        ','
4198               'Count3mChronicSign'        ','
4199               'Count6mChronicSign'        ','
4200               'Count12mChronicSign'        ','
4201               'Count3mAcute'        ','
4202               'Count6mAcute'        ','
4203               'Count3mChronic'        ','
4204               'Count12mChronic'        ','
4205               'Count3mBody'        ','
4206               'Count3mBodySign'        ','
4207               'flag3mNewChronicSign'        ','
4208               'Days3mStage3'        ','
4209               'PopClass'        ','
125                                      The WPS System   12:31 Wednesday, October 24, 2018     

4210               'Rule'        ','
4211               'RuleConfidence'        ','
4212               'PopClassDTModelDescription'        ','
4213               'PopClassFinal'        ','
4214               'PopClassFinalDescription'        ','
4215               'FlagOverwrite';
4216          end;
4217        set temp.AllRules;
4218        put ENROLID @;
4219        put Count3mOV @;
4220        put Count12mOV @;
4221        put Count3mOVChronic @;
4222        put Count6mOVChronic @;
4223        put Count3mOVChronicSpecialist @;
4224        put Count6mOVChronicSpecialist @;
4225        put Count3mOVSpecialties @;
4226        put Count3mOVChronicSpecialties @;
4227        put Count3mER @;
4228        put Count12mER @;
4229        put Count3mERChronic @;
4230        put Count6mERChronic @;
4231        put DaysER @;
4232        put DaysMajorER @;
4233        put DaysHH @;
4234        put DaysMajorSurg @;
4235        put DaysOxygen @;
4236        put Days3mLTC @;
4237        put flag3mLTC @;
4238        put CountAdm3mAll @;
4239        put CountAdm3mChronic @;
4240        put CountAdm6mAll @;
4241        put CountAdm6mChronic @;
4242        put SumLOS3mAll @;
4243        put DaysAnyAdm @;
4244        put DaysChronicAdm @;
4245        put DaysSurgAdm @;
4246        put DaysMedicalAdm @;
4247        put DaysMtrntyAdm @;
4248        put DaysMHSAAdm @;
4249        put FlagChronicRx @;
4250        put FlagNewChronicRx @;
4251        put CountDaysSupp3m @;
4252        put CountDaysSupp6m @;
4253        put CountDaysSuppChronic3m @;
4254        put CountDaysSuppChronic6m @;
4255        put CountDaysSuppOpiates3m @;
4256        put CountDaysSuppOpiates6m @;
4257        put CountTherClass3m @;
4258        put CountTherClass6m @;
4259        put CountTherClassChronic3m @;
4260        put CountTherClassChronic6m @;
4261        put flag12mMHSA @;
4262        put flag3mGYN @;
126                                      The WPS System   12:31 Wednesday, October 24, 2018     

4263        put Count3mAcuteStage3 @;
4264        put Count3mChronicStage3 @;
4265        put Count6mChronicStage3 @;
4266        put Count3mAcuteSign @;
4267        put Count3mChronicSign @;
4268        put Count6mChronicSign @;
4269        put Count12mChronicSign @;
4270        put Count3mAcute @;
4271        put Count6mAcute @;
4272        put Count3mChronic @;
4273        put Count12mChronic @;
4274        put Count3mBody @;
4275        put Count3mBodySign @;
4276        put flag3mNewChronicSign @;
4277        put Days3mStage3 @;
4278        put PopClass @;
4279        put Rule @;
4280        put RuleConfidence @;
4281        put PopClassDTModelDescription @;
4282        put PopClassFinal @;
4283        put PopClassFinalDescription @;
4284        put FlagOverwrite;
4285      run;

NOTE: The file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/AllRules31DEC2015Marke
      tScanSample.csv' is:
      File
      Name=/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/AllRules31DEC2015M
      arketScanSample.csv,
      Access Permissions=-rw-rw-r--, Number of Links=1,
      Owner Name=u071366, Group Name=users,
      File Size=0, Last Modified=12:32:40 Oct 24 2018,
      Created=12:32:40 Oct 24 2018, Lrecl=1262, Recfm=V

NOTE: 1799 records were written to file
      '/rpscan/u071366/POPSTRATIFICATION/output/31DEC2015MarketScanSample/AllRules31DEC2015Marke
      tScanSample.csv'
      The minimum record length was 178
      The maximum record length was 1069
NOTE: 1798 observations were read from "TEMP.AllRules"
NOTE: The data step took :
      real time : 0.090
      cpu time  : 0.028


4286      FILENAME ##EXPOUT CLEAR;
4287      
4288      
4289      
4290      
4291      
4292      
127                                      The WPS System   12:31 Wednesday, October 24, 2018     

4293      
4294      
ERROR: Errors printed on pages 6,13

NOTE: Submitted statements took :
      real time : 49.233
      cpu time  : 20.294
