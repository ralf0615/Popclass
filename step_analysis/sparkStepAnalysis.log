	2018-11-26 09:42:56 INFO  StepAnalysis - (spark df) input data with the specified columns of dxcatsmapped with category of acute/chronic and significance
2018-11-26 09:42:56 INFO  StepAnalysis - Dataset:
+----------+-----------------+--------+----------+-------+---------+---------+--------+--------+--------+-----+-----+----+----+------------+------------+------------+------------+---------+---------+---------+---------+------------+---------------------+-------------------------+
|patient_id|record_identifier|claim_id|svc_date  |svc_cat|proc_code|icd_proc1|rec_type|icd_flag|fac_prof|dx1  |dx2  |dx3 |dx4 |dx_category1|dx_category2|dx_category3|dx_category4|dx_stage1|dx_stage2|dx_stage3|dx_stage4|admission_id|dx_category1_category|dx_category1_significance|
+----------+-----------------+--------+----------+-------+---------+---------+--------+--------+--------+-----+-----+----+----+------------+------------+------------+------------+---------+---------+---------+---------+------------+---------------------+-------------------------+
|873637101 |8368             |32826   |2013-03-18|45168  |71020    |null     |O       |9       |F       |5110 |null |null|null|RES83       |null        |null        |null        |2.01     |null     |null     |null     |null        |Acute                |High                     |
|873637101 |8369             |191620  |2013-03-18|45168  |71020    |null     |O       |9       |P       |5110 |null |null|null|RES83       |null        |null        |null        |2.01     |null     |null     |null     |null        |Acute                |High                     |
|873637101 |8370             |191618  |2013-03-18|40151  |80050    |null     |O       |9       |P       |V700 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873637101 |8371             |191618  |2013-03-18|40151  |80061    |null     |O       |9       |P       |V700 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873637101 |8372             |191618  |2013-03-18|40151  |84153    |null     |O       |9       |P       |V700 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873637101 |8373             |191619  |2013-03-18|21224  |99386    |null     |O       |9       |P       |V700 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873637101 |8374             |191621  |2013-07-11|21125  |99244    |null     |O       |9       |P       |34670|null |null|null|NEU09       |null        |null        |null        |1.02     |null     |null     |null     |null        |Chronic              |null                     |
|873640702 |8375             |33067   |2013-01-28|45162  |77052    |null     |O       |9       |F       |V7612|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873640702 |8376             |193142  |2013-01-28|45162  |77052    |null     |O       |9       |P       |V7612|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873640702 |8377             |33067   |2013-01-28|45162  |77057    |null     |O       |9       |F       |V7612|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873640702 |8378             |193142  |2013-01-28|45162  |G0202    |null     |O       |9       |P       |V7612|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873640702 |8379             |193145  |2013-05-10|40154  |87491    |null     |O       |9       |P       |V7231|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873640702 |8380             |193145  |2013-05-10|40154  |87591    |null     |O       |9       |P       |V7231|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873640702 |8381             |193145  |2013-05-10|40154  |87621    |null     |O       |9       |P       |V7231|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873640702 |8382             |193145  |2013-05-10|40155  |88175    |null     |O       |9       |P       |V7231|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873640702 |8383             |193143  |2013-05-10|21224  |99396    |null     |O       |9       |P       |V7231|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873640702 |8384             |193144  |2013-06-27|21224  |99396    |null     |O       |9       |P       |24900|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |
|873640702 |8385             |193146  |2013-10-15|21225  |90471    |null     |O       |9       |P       |V0481|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873640702 |8386             |193146  |2013-10-15|21225  |90686    |null     |O       |9       |P       |V0481|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873640702 |8387             |193147  |2013-11-20|21225  |99202    |null     |O       |9       |P       |1330 |null |null|null|SKN12       |null        |null        |null        |1.01     |null     |null     |null     |null        |Acute                |null                     |
|873666103 |8388             |195405  |2013-08-21|22325  |99213    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |
|873666103 |8389             |195405  |2013-08-21|22324  |99395    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |
|873666103 |8390             |33469   |2013-08-21|40154  |87491    |null     |O       |9       |F       |V781 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873666103 |8391             |33469   |2013-08-21|40154  |87591    |null     |O       |9       |F       |V781 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873666103 |8392             |195406  |2013-11-05|21299  |11976    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |
|873666103 |8393             |195406  |2013-11-05|21299  |58300    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |
|873666103 |8394             |195406  |2013-11-05|40156  |81025    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |
|873666103 |8395             |195406  |2013-11-05|21225  |99213    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |
|873666103 |8396             |195406  |2013-11-05|22336  |J7302    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |
|873666103 |8397             |33470   |2013-11-05|40154  |87491    |null     |O       |9       |F       |V745 |null |null|null|INF84       |null        |null        |null        |0.00     |null     |null     |null     |null        |Acute                |null                     |
|873666103 |8398             |33470   |2013-11-05|40154  |87591    |null     |O       |9       |F       |V745 |null |null|null|INF84       |null        |null        |null        |0.00     |null     |null     |null     |null        |Acute                |null                     |
|873672301 |8399             |191535  |2013-01-03|21125  |99203    |null     |O       |9       |P       |7821 |null |null|null|OTH71       |null        |null        |null        |1.08     |null     |null     |null     |null        |Acute                |null                     |
|873672301 |8400             |191536  |2013-01-17|21125  |99213    |null     |O       |9       |P       |7821 |null |null|null|OTH71       |null        |null        |null        |1.08     |null     |null     |null     |null        |Acute                |null                     |
|873672301 |8401             |191539  |2013-02-12|22399  |36415    |null     |O       |9       |P       |4011 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873672301 |8402             |191539  |2013-02-12|40151  |80053    |null     |O       |9       |P       |4011 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873672301 |8403             |191539  |2013-02-12|40151  |80061    |null     |O       |9       |P       |4011 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873672301 |8404             |191539  |2013-02-12|40151  |83036    |null     |O       |9       |P       |4011 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873672301 |8405             |191537  |2013-02-12|21224  |99396    |null     |O       |9       |P       |V700 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873672301 |8406             |191538  |2013-02-12|45162  |77052    |null     |O       |9       |P       |V7612|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873672301 |8407             |191538  |2013-02-12|45162  |G0202    |null     |O       |9       |P       |V7612|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |
|873672301 |8408             |32796   |2013-02-12|45162  |77052    |null     |O       |9       |F       |V7612|V163 |null|null|OTH85       |OTH88       |null        |null        |0.00     |1.01     |null     |null     |null        |null                 |null                     |
|873672301 |8409             |32796   |2013-02-12|45162  |77057    |null     |O       |9       |F       |V7612|V163 |null|null|OTH85       |OTH88       |null        |null        |0.00     |1.01     |null     |null     |null        |null                 |null                     |
|873672301 |8410             |32797   |2013-04-23|45168  |71020    |null     |O       |9       |F       |7245 |7862 |null|null|MUS85       |RES24       |null        |null        |1.01     |1.03     |null     |null     |null        |Chronic              |null                     |
|873672301 |8411             |191540  |2013-04-23|45168  |71020    |null     |O       |9       |P       |7862 |null |null|null|RES24       |null        |null        |null        |1.03     |null     |null     |null     |null        |Acute                |null                     |
|873672301 |8412             |191541  |2013-04-23|21225  |99213    |null     |O       |9       |P       |7862 |null |null|null|RES24       |null        |null        |null        |1.03     |null     |null     |null     |null        |Acute                |null                     |
|873672301 |8413             |191542  |2013-06-09|21120  |71020    |null     |O       |9       |P       |78650|null |null|null|RES86       |null        |null        |null        |1.01     |null     |null     |null     |null        |Acute                |null                     |
|873672301 |8414             |32798   |2013-06-09|12220  |71020    |null     |O       |9       |F       |78659|485  |null|null|CVS84       |RES15       |null        |null        |1.01     |1.01     |null     |null     |null        |Acute                |null                     |
|873672301 |8415             |32798   |2013-06-09|12220  |99203    |null     |O       |9       |F       |78659|485  |null|null|CVS84       |RES15       |null        |null        |1.01     |1.01     |null     |null     |null        |Acute                |null                     |
|873672301 |8416             |191545  |2013-06-13|22399  |36415    |null     |O       |9       |P       |25000|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |
|873672301 |8417             |191545  |2013-06-13|40151  |80053    |null     |O       |9       |P       |25000|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |
|873672301 |8418             |191545  |2013-06-13|40156  |82043    |null     |O       |9       |P       |25000|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |
|873672301 |8419             |191545  |2013-06-13|40151  |82570    |null     |O       |9       |P       |25000|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |
|873672301 |8420             |191545  |2013-06-13|40151  |83036    |null     |O       |9       |P       |25000|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |
|873672301 |8421             |191544  |2013-06-13|21225  |99214    |null     |O       |9       |P       |25000|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |
|873672301 |8422             |191543  |2013-06-14|45169  |77080    |null     |O       |9       |P       |V4981|null |null|null|OTH88       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |
|873672301 |8423             |32799   |2013-06-14|45168  |77080    |null     |O       |9       |F       |V4981|73390|null|null|OTH88       |MUS83       |null        |null        |1.01     |1.01     |null     |null     |null        |null                 |null                     |
|873672301 |8424             |191547  |2013-10-14|21225  |99213    |null     |O       |9       |P       |4011 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873672301 |8425             |191548  |2013-10-29|45168  |73510    |null     |O       |9       |P       |71945|null |null|null|MUS83       |null        |null        |null        |1.01     |null     |null     |null     |null        |Acute                |null                     |
|873672301 |8426             |32800   |2013-10-29|45168  |72110    |null     |O       |9       |F       |71945|8479 |null|null|MUS83       |NEU23       |null        |null        |1.01     |1.01     |null     |null     |null        |Acute                |null                     |
|873672301 |8427             |32800   |2013-10-29|45168  |73510    |null     |O       |9       |F       |71945|8479 |null|null|MUS83       |NEU23       |null        |null        |1.01     |1.01     |null     |null     |null        |Acute                |null                     |
|873672301 |8428             |191548  |2013-10-29|45168  |72110    |null     |O       |9       |P       |7242 |null |null|null|MUS85       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873672301 |8429             |191549  |2013-10-29|21225  |99213    |null     |O       |9       |P       |8479 |null |null|null|NEU23       |null        |null        |null        |1.01     |null     |null     |null     |null        |Acute                |null                     |
|873672301 |8430             |191550  |2013-11-12|22332  |V5257    |null     |O       |9       |P       |38910|null |null|null|ENT81       |null        |null        |null        |1.01     |null     |null     |null     |null        |Acute                |null                     |
|873672301 |8431             |191550  |2013-11-12|22332  |V5257    |null     |O       |9       |P       |38910|null |null|null|ENT81       |null        |null        |null        |1.01     |null     |null     |null     |null        |Acute                |null                     |
|873697901 |8432             |221319  |2013-04-23|40151  |83036    |null     |O       |9       |P       |2777 |null |null|null|NUT81       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8433             |221317  |2013-04-23|21299  |36415    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8434             |221318  |2013-04-23|40151  |80050    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8435             |221318  |2013-04-23|40151  |80061    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8436             |221317  |2013-04-23|21225  |99213    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8437             |221320  |2013-10-21|21299  |36415    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8438             |221321  |2013-10-21|40151  |80050    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8439             |221321  |2013-10-21|40151  |80061    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8440             |221321  |2013-10-21|40151  |83036    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8441             |221320  |2013-10-21|21225  |90471    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8442             |221320  |2013-10-21|21225  |90658    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8443             |221320  |2013-10-21|21225  |99214    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8444             |221321  |2013-10-21|40151  |G0103    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8445             |221322  |2013-10-28|45168  |73565    |null     |O       |9       |P       |71590|null |null|null|MUS34       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8446             |221323  |2013-10-28|21125  |99214    |null     |O       |9       |P       |71590|null |null|null|MUS34       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8447             |221324  |2013-12-18|45168  |73565    |null     |O       |9       |P       |71596|null |null|null|MUS34       |null        |null        |null        |1.06     |null     |null     |null     |null        |Chronic              |null                     |
|873697901 |8448             |221325  |2013-12-18|21125  |99214    |null     |O       |9       |P       |71596|null |null|null|MUS34       |null        |null        |null        |1.06     |null     |null     |null     |null        |Chronic              |null                     |
+----------+-----------------+--------+----------+-------+---------+---------+--------+--------+--------+-----+-----+----+----+------------+------------+------------+------------+---------+---------+---------+---------+------------+---------------------+-------------------------+


2018-11-26 09:42:57 INFO  StepAnalysis - (spark df) input data with added flags for venipuncture procedure claims
2018-11-26 09:42:57 INFO  StepAnalysis - Dataset:
+----------+-----------------+--------+----------+-------+---------+---------+--------+--------+--------+-----+-----+----+----+------------+------------+------------+------------+---------+---------+---------+---------+------------+---------------------+-------------------------+-----------------+
|patient_id|record_identifier|claim_id|svc_date  |svc_cat|proc_code|icd_proc1|rec_type|icd_flag|fac_prof|dx1  |dx2  |dx3 |dx4 |dx_category1|dx_category2|dx_category3|dx_category4|dx_stage1|dx_stage2|dx_stage3|dx_stage4|admission_id|dx_category1_category|dx_category1_significance|flag_venipuncture|
+----------+-----------------+--------+----------+-------+---------+---------+--------+--------+--------+-----+-----+----+----+------------+------------+------------+------------+---------+---------+---------+---------+------------+---------------------+-------------------------+-----------------+
|873637101 |8368             |32826   |2013-03-18|45168  |71020    |null     |O       |9       |F       |5110 |null |null|null|RES83       |null        |null        |null        |2.01     |null     |null     |null     |null        |Acute                |High                     |0                |
|873637101 |8369             |191620  |2013-03-18|45168  |71020    |null     |O       |9       |P       |5110 |null |null|null|RES83       |null        |null        |null        |2.01     |null     |null     |null     |null        |Acute                |High                     |0                |
|873637101 |8370             |191618  |2013-03-18|40151  |80050    |null     |O       |9       |P       |V700 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873637101 |8371             |191618  |2013-03-18|40151  |80061    |null     |O       |9       |P       |V700 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873637101 |8372             |191618  |2013-03-18|40151  |84153    |null     |O       |9       |P       |V700 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873637101 |8373             |191619  |2013-03-18|21224  |99386    |null     |O       |9       |P       |V700 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873637101 |8374             |191621  |2013-07-11|21125  |99244    |null     |O       |9       |P       |34670|null |null|null|NEU09       |null        |null        |null        |1.02     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873640702 |8375             |33067   |2013-01-28|45162  |77052    |null     |O       |9       |F       |V7612|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873640702 |8376             |193142  |2013-01-28|45162  |77052    |null     |O       |9       |P       |V7612|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873640702 |8377             |33067   |2013-01-28|45162  |77057    |null     |O       |9       |F       |V7612|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873640702 |8378             |193142  |2013-01-28|45162  |G0202    |null     |O       |9       |P       |V7612|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873640702 |8379             |193145  |2013-05-10|40154  |87491    |null     |O       |9       |P       |V7231|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873640702 |8380             |193145  |2013-05-10|40154  |87591    |null     |O       |9       |P       |V7231|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873640702 |8381             |193145  |2013-05-10|40154  |87621    |null     |O       |9       |P       |V7231|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873640702 |8382             |193145  |2013-05-10|40155  |88175    |null     |O       |9       |P       |V7231|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873640702 |8383             |193143  |2013-05-10|21224  |99396    |null     |O       |9       |P       |V7231|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873640702 |8384             |193144  |2013-06-27|21224  |99396    |null     |O       |9       |P       |24900|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |0                |
|873640702 |8385             |193146  |2013-10-15|21225  |90471    |null     |O       |9       |P       |V0481|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873640702 |8386             |193146  |2013-10-15|21225  |90686    |null     |O       |9       |P       |V0481|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873640702 |8387             |193147  |2013-11-20|21225  |99202    |null     |O       |9       |P       |1330 |null |null|null|SKN12       |null        |null        |null        |1.01     |null     |null     |null     |null        |Acute                |null                     |0                |
|873666103 |8388             |195405  |2013-08-21|22325  |99213    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |0                |
|873666103 |8389             |195405  |2013-08-21|22324  |99395    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |0                |
|873666103 |8390             |33469   |2013-08-21|40154  |87491    |null     |O       |9       |F       |V781 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873666103 |8391             |33469   |2013-08-21|40154  |87591    |null     |O       |9       |F       |V781 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873666103 |8392             |195406  |2013-11-05|21299  |11976    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |0                |
|873666103 |8393             |195406  |2013-11-05|21299  |58300    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |0                |
|873666103 |8394             |195406  |2013-11-05|40156  |81025    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |0                |
|873666103 |8395             |195406  |2013-11-05|21225  |99213    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |0                |
|873666103 |8396             |195406  |2013-11-05|22336  |J7302    |null     |O       |9       |P       |V2509|null |null|null|OTH87       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |0                |
|873666103 |8397             |33470   |2013-11-05|40154  |87491    |null     |O       |9       |F       |V745 |null |null|null|INF84       |null        |null        |null        |0.00     |null     |null     |null     |null        |Acute                |null                     |0                |
|873666103 |8398             |33470   |2013-11-05|40154  |87591    |null     |O       |9       |F       |V745 |null |null|null|INF84       |null        |null        |null        |0.00     |null     |null     |null     |null        |Acute                |null                     |0                |
|873672301 |8399             |191535  |2013-01-03|21125  |99203    |null     |O       |9       |P       |7821 |null |null|null|OTH71       |null        |null        |null        |1.08     |null     |null     |null     |null        |Acute                |null                     |0                |
|873672301 |8400             |191536  |2013-01-17|21125  |99213    |null     |O       |9       |P       |7821 |null |null|null|OTH71       |null        |null        |null        |1.08     |null     |null     |null     |null        |Acute                |null                     |0                |
|873672301 |8401             |191539  |2013-02-12|22399  |36415    |null     |O       |9       |P       |4011 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |1                |
|873672301 |8402             |191539  |2013-02-12|40151  |80053    |null     |O       |9       |P       |4011 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873672301 |8403             |191539  |2013-02-12|40151  |80061    |null     |O       |9       |P       |4011 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873672301 |8404             |191539  |2013-02-12|40151  |83036    |null     |O       |9       |P       |4011 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873672301 |8405             |191537  |2013-02-12|21224  |99396    |null     |O       |9       |P       |V700 |null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873672301 |8406             |191538  |2013-02-12|45162  |77052    |null     |O       |9       |P       |V7612|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873672301 |8407             |191538  |2013-02-12|45162  |G0202    |null     |O       |9       |P       |V7612|null |null|null|OTH85       |null        |null        |null        |0.00     |null     |null     |null     |null        |null                 |null                     |0                |
|873672301 |8408             |32796   |2013-02-12|45162  |77052    |null     |O       |9       |F       |V7612|V163 |null|null|OTH85       |OTH88       |null        |null        |0.00     |1.01     |null     |null     |null        |null                 |null                     |0                |
|873672301 |8409             |32796   |2013-02-12|45162  |77057    |null     |O       |9       |F       |V7612|V163 |null|null|OTH85       |OTH88       |null        |null        |0.00     |1.01     |null     |null     |null        |null                 |null                     |0                |
|873672301 |8410             |32797   |2013-04-23|45168  |71020    |null     |O       |9       |F       |7245 |7862 |null|null|MUS85       |RES24       |null        |null        |1.01     |1.03     |null     |null     |null        |Chronic              |null                     |0                |
|873672301 |8411             |191540  |2013-04-23|45168  |71020    |null     |O       |9       |P       |7862 |null |null|null|RES24       |null        |null        |null        |1.03     |null     |null     |null     |null        |Acute                |null                     |0                |
|873672301 |8412             |191541  |2013-04-23|21225  |99213    |null     |O       |9       |P       |7862 |null |null|null|RES24       |null        |null        |null        |1.03     |null     |null     |null     |null        |Acute                |null                     |0                |
|873672301 |8413             |191542  |2013-06-09|21120  |71020    |null     |O       |9       |P       |78650|null |null|null|RES86       |null        |null        |null        |1.01     |null     |null     |null     |null        |Acute                |null                     |0                |
|873672301 |8414             |32798   |2013-06-09|12220  |71020    |null     |O       |9       |F       |78659|485  |null|null|CVS84       |RES15       |null        |null        |1.01     |1.01     |null     |null     |null        |Acute                |null                     |0                |
|873672301 |8415             |32798   |2013-06-09|12220  |99203    |null     |O       |9       |F       |78659|485  |null|null|CVS84       |RES15       |null        |null        |1.01     |1.01     |null     |null     |null        |Acute                |null                     |0                |
|873672301 |8416             |191545  |2013-06-13|22399  |36415    |null     |O       |9       |P       |25000|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |1                |
|873672301 |8417             |191545  |2013-06-13|40151  |80053    |null     |O       |9       |P       |25000|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |0                |
|873672301 |8418             |191545  |2013-06-13|40156  |82043    |null     |O       |9       |P       |25000|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |0                |
|873672301 |8419             |191545  |2013-06-13|40151  |82570    |null     |O       |9       |P       |25000|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |0                |
|873672301 |8420             |191545  |2013-06-13|40151  |83036    |null     |O       |9       |P       |25000|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |0                |
|873672301 |8421             |191544  |2013-06-13|21225  |99214    |null     |O       |9       |P       |25000|null |null|null|END05       |null        |null        |null        |1.03     |null     |null     |null     |null        |Chronic              |High                     |0                |
|873672301 |8422             |191543  |2013-06-14|45169  |77080    |null     |O       |9       |P       |V4981|null |null|null|OTH88       |null        |null        |null        |1.01     |null     |null     |null     |null        |null                 |null                     |0                |
|873672301 |8423             |32799   |2013-06-14|45168  |77080    |null     |O       |9       |F       |V4981|73390|null|null|OTH88       |MUS83       |null        |null        |1.01     |1.01     |null     |null     |null        |null                 |null                     |0                |
|873672301 |8424             |191547  |2013-10-14|21225  |99213    |null     |O       |9       |P       |4011 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873672301 |8425             |191548  |2013-10-29|45168  |73510    |null     |O       |9       |P       |71945|null |null|null|MUS83       |null        |null        |null        |1.01     |null     |null     |null     |null        |Acute                |null                     |0                |
|873672301 |8426             |32800   |2013-10-29|45168  |72110    |null     |O       |9       |F       |71945|8479 |null|null|MUS83       |NEU23       |null        |null        |1.01     |1.01     |null     |null     |null        |Acute                |null                     |0                |
|873672301 |8427             |32800   |2013-10-29|45168  |73510    |null     |O       |9       |F       |71945|8479 |null|null|MUS83       |NEU23       |null        |null        |1.01     |1.01     |null     |null     |null        |Acute                |null                     |0                |
|873672301 |8428             |191548  |2013-10-29|45168  |72110    |null     |O       |9       |P       |7242 |null |null|null|MUS85       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873672301 |8429             |191549  |2013-10-29|21225  |99213    |null     |O       |9       |P       |8479 |null |null|null|NEU23       |null        |null        |null        |1.01     |null     |null     |null     |null        |Acute                |null                     |0                |
|873672301 |8430             |191550  |2013-11-12|22332  |V5257    |null     |O       |9       |P       |38910|null |null|null|ENT81       |null        |null        |null        |1.01     |null     |null     |null     |null        |Acute                |null                     |0                |
|873672301 |8431             |191550  |2013-11-12|22332  |V5257    |null     |O       |9       |P       |38910|null |null|null|ENT81       |null        |null        |null        |1.01     |null     |null     |null     |null        |Acute                |null                     |0                |
|873697901 |8432             |221319  |2013-04-23|40151  |83036    |null     |O       |9       |P       |2777 |null |null|null|NUT81       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8433             |221317  |2013-04-23|21299  |36415    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |1                |
|873697901 |8434             |221318  |2013-04-23|40151  |80050    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8435             |221318  |2013-04-23|40151  |80061    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8436             |221317  |2013-04-23|21225  |99213    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8437             |221320  |2013-10-21|21299  |36415    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |1                |
|873697901 |8438             |221321  |2013-10-21|40151  |80050    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8439             |221321  |2013-10-21|40151  |80061    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8440             |221321  |2013-10-21|40151  |83036    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8441             |221320  |2013-10-21|21225  |90471    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8442             |221320  |2013-10-21|21225  |90658    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8443             |221320  |2013-10-21|21225  |99214    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8444             |221321  |2013-10-21|40151  |G0103    |null     |O       |9       |P       |4019 |null |null|null|CVS13       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8445             |221322  |2013-10-28|45168  |73565    |null     |O       |9       |P       |71590|null |null|null|MUS34       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8446             |221323  |2013-10-28|21125  |99214    |null     |O       |9       |P       |71590|null |null|null|MUS34       |null        |null        |null        |1.01     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8447             |221324  |2013-12-18|45168  |73565    |null     |O       |9       |P       |71596|null |null|null|MUS34       |null        |null        |null        |1.06     |null     |null     |null     |null        |Chronic              |null                     |0                |
|873697901 |8448             |221325  |2013-12-18|21125  |99214    |null     |O       |9       |P       |71596|null |null|null|MUS34       |null        |null        |null        |1.06     |null     |null     |null     |null        |Chronic              |null                     |0                |
+----------+-----------------+--------+----------+-------+---------+---------+--------+--------+--------+-----+-----+----+----+------------+------------+------------+------------+---------+---------+---------+---------+------------+---------------------+-------------------------+-----------------+


2018-11-26 09:42:58 INFO  StepAnalysis - (spark df), the function returns a spark data frame with columns person_id and calculated ER variables Count6mERChronic, DaysMajorER and Count12mOV
2018-11-26 09:43:00 INFO  StepAnalysis - Dataset:
+----------+----------------+-----------+----------+
|patient_id|Count6mERChronic|DaysMajorER|Count12mOV|
+----------+----------------+-----------+----------+
|873697901 |0               |null       |4         |
|873637101 |0               |null       |2         |
|873672301 |0               |null       |7         |
|873666103 |0               |null       |2         |
|873640702 |0               |null       |4         |
+----------+----------------+-----------+----------+


2018-11-26 09:43:01 INFO  StepAnalysis - (spark df)  with calculated OP variables for ALL patient_ids including ones without OP claims during the last 365 days from cut off date
2018-11-26 09:43:01 INFO  StepAnalysis - Dataset:
+----------+----------------+-----------+----------+
|patient_id|Count6mERChronic|DaysMajorER|Count12mOV|
+----------+----------------+-----------+----------+
|873697901 |0               |365        |4         |
|873637101 |0               |365        |2         |
|873672301 |0               |365        |7         |
|873666103 |0               |365        |2         |
|873640702 |0               |365        |4         |
+----------+----------------+-----------+----------+


2018-11-26 09:43:01 INFO  StepAnalysis - outpatient_variables
2018-11-26 09:43:02 INFO  StepAnalysis - Dataset:
+----------+----------------+-----------+----------+
|patient_id|Count6mERChronic|DaysMajorER|Count12mOV|
+----------+----------------+-----------+----------+
|873697901 |0               |365        |4         |
|873637101 |0               |365        |2         |
|873672301 |0               |365        |7         |
|873666103 |0               |365        |2         |
|873640702 |0               |365        |4         |
+----------+----------------+-----------+----------+


2018-11-26 09:44:03 INFO  StepAnalysis - Scoring Data Output
2018-11-26 09:44:34 INFO  StepAnalysis - Dataset:
+----------+----------+----------------+-----------+-------------+----------+---------------+----------------------+-----------------------+--------------------+-------------------+-----------+----+--------------+--------------+------------------+---------------------+-----------------+--------------+--------------+
|patient_id|Count12mOV|Count6mERChronic|DaysMajorER|CountAdm3mAll|DaysAnyAdm|CountDaysSupp3m|CountDaysSuppOpiates3m|CountTherClassChronic6m|Count6mChronicStage3|Count12mChronicSign|PopClass_DT|Rule|RuleConfidence|PopClass_TrNav|PopClass_Rebalance|PopClass_Surveillance|PopClass_Neonates|PopClass_Final|Flag_overwrite|
+----------+----------+----------------+-----------+-------------+----------+---------------+----------------------+-----------------------+--------------------+-------------------+-----------+----+--------------+--------------+------------------+---------------------+-----------------+--------------+--------------+
|873697901 |4         |0               |365        |0            |365       |180            |0                     |3                      |0                   |0                  |2          |null|null          |4             |null              |null                 |null             |4             |1             |
|873637101 |2         |0               |365        |0            |365       |120            |0                     |1                      |0                   |0                  |2          |4   |0.865         |null          |null              |null                 |null             |2             |0             |
|873672301 |7         |0               |365        |0            |365       |323            |10                    |2                      |0                   |1                  |3          |7   |0.851         |null          |null              |null                 |null             |3             |0             |
|873666103 |2         |0               |365        |0            |365       |5              |0                     |0                      |0                   |0                  |2          |4   |0.865         |null          |null              |null                 |null             |2             |0             |
|873640702 |4         |0               |365        |0            |365       |31             |0                     |2                      |0                   |1                  |3          |7   |0.851         |null          |null              |null                 |null             |3             |0             |
+----------+----------+----------------+-----------+-------------+----------+---------------+----------------------+-----------------------+--------------------+-------------------+-----------+----+--------------+--------------+------------------+---------------------+-----------------+--------------+--------------+


